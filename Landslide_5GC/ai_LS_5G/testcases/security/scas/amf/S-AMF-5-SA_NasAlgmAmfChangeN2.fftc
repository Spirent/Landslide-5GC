<?xml version="1.0"?>
<testCase version="9.3.0.202302120019">
    <general>
        <documentation>S-AMF-5-SA: NAS Algorithm selection in AMF change (N2 Handover) - Security Testing</documentation>
        <tags>S-AMF-5-SA</tags>
        <notes masked="true">/b0yBLds2XcJXOYff5ARpXueN6Aaj3l1qnP3FQ3iMqVoa4ZLhMUC8Lgh37BxQybHJuoHc5kyJiDFF9hVVHc2G9HYLEFME4iHrli5jmd8yHcvdIvnLiwZA1Qo0sNUo/dqt9rSv+dhMgGYUnYN/YD7S987Rp/Bl9o6jyxZfSfm8FvVfATy4HS8AQTbblY0qQ5Nt9rSv+dhMgGVmgjnj0Epky8x53DIYJBru8B6WB4JoTDHi870nqzz7LuFMfGsYN8h0q2d7aN7sOs8IOViRJChhYyW6w2ZkeKJGY5fHZsThpMnch47A1zov9ElSiG/yT4WcHxgSNQwuLSQv9+Dc/bGRosZKZ4HiYvz+UVlxvnOFC4s1aV0gU4n0Jd/5Bq4l2MKwOaJSbEGJ0ZgW80bQZbyu9mwV1lEV9ixmbQBuUuznG+oH8TFqAVdls5aiwasT8v/F4Uvt/AoUyvIw2wAdf72ZnAvblS2rZSAW6LBhAJd28hewx6XP8vjpxJ51X/Ifzg8TH77FtboDJnIus6F3nMk3xkklHu1zwdpQWD839oJVlotTjEbo2/RjqeF+K4jNY+SnKF9hFvN0IlssRvW2cDY4wXPOTqkrGHOUhybwTMl4wTWKiLZFJ42bOnytgOVF0f2+n/+m24+0JoZg9NKUGIZtqJ3eXAu6tTJB85jkMlFXK6KKBT8z4Ddt104TuIOetnzp5+YnKH3/ALIN0VHQD4qMJAGyBEFRwF/8DfQOAE6e3dZoiUz8Rh9PL88Yf60sQO5lbi8juKALhYtUKS3ZeOY3DEes5zuoj6oKFL92qcmnjNiVD/Z9LgeywttQNxYx/jXjB6P115m85TI0+gMdHzr87qZ3SW50ieEw3G9+cEDM6VL/+hYkBNdXWi+ZlNirXaijJbrDZmR4olEHtOD9xNO3KKDUuKles+SdNDxYKzKcEwcqn+Ufj9t0Ua7xu0ZHrRf9JfkMwXPRWwgrPh6lPpx8nL8jDRG4/+0egvzxGIlnT0euP6EJHTLQttFSUIRw2GFS17B9zQJMKtu60aaIIHGi9UWMn1jxMAdsH3dsR73VmgCERTMY6j0hBq1SASKkL101ys2umvPlxX0kSD6xz8a8HB8YEjUMLi0idm8rm73GR4KZnQsf45ulWSU/U0Kz3r9i6rPuRyx0btBJWS4R6spp+5sYNKdFGXobktot4E4VcaCUCmL7I/VFfPJs/5OfJ0pV9AMKghnnlXQeh9waljacEYe7UdC879Bnz8Xk55w8/IzK7Aj4DZ4Ure5vQUrNlIPqdQY5rtRHyAatUgEipC9dGmEILSCFSue6R+IWUD7QL5FWE1n1kW4XLuuXS7IElM5Sp34ebizR6owxN/9PjPz3dlZVs4jiYv9mRzEgc4COlH7x2Lew27Q1fIukoYMXA8ZJBqLdOJ4K8qoob8bhcsJ3WiZGzN6jQKK7QLTFRrlj6Odu+GRotot4QLCnUI8UWneqvkcf+N+aVtntAxI45aKJgdNgqCs8fLM2+T2vCTJhM1ogjqoyzH52o0JJGXhjWZF/gZcLnPNiV0=</notes>
        <owner>Spirent</owner>
        <language>Python</language>
    </general>
    <procedures>
        <item name="main">
            <steps>
                <item guid="10efe034-1592-4882-a38a-cdd9a719a076" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Configure variables for each iTest test case</body>
                    </command>
                    <nestedSteps>
                        <item guid="c8aa2697-e6a9-419e-b84e-dd1d7f43fe34" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>General settings</body>
                            </command>
                            <nestedSteps>
                                <item guid="7600c7c5-025e-4c76-bae4-abf0cfaec7a4" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Time out to wait running test get expected state </body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="d4b9ae6b-c239-46e3-bbdd-d9c566848f04" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>test_waiting_timeout = 180</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b7fb61f8-b37f-49d6-9abb-f6fd9b3e7296" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Number of Test Server need to run this test</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="474f0d1e-7789-4b70-81bb-62297a1c5f58" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>ts_groups_required = 1</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="db23a068-a06d-40bb-b5fc-3dc23883d941" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Delete all running test sessions after complete</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="6ec61b53-48ee-4780-aaa1-64a838b927fb" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>clean_up = &quot;true&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="16831192-d085-4b05-aabd-cb19989821f6" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Node and Nodal Test settings - Do not change. Some variables can setting in parameter file</body>
                            </command>
                            <nestedSteps>
                                <item guid="911a802c-4c66-4d37-b704-4f69695a6abd" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Variables for Node test</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="4bb17916-d4bc-4dde-bbb8-6d563debfd95" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>node_test_session = &quot;S-AMF-5-SA_NasAlgmAmfChangeN2_SUT&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e1645a52-fedd-4656-b1b2-b19eefa7543b" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Specify abstract TS resource name uses to perform node test session</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="c5dbaf72-c716-4948-9e36-8f1f6e69bb4f" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>ts_node_name = &quot;EmulatedSUT&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="dac30fc3-163d-4f42-983f-eadee36439c9" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Variables for Nodal test</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="669a483d-f4e1-44b9-9af1-66939d35ab4c" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>nodal_test_session = &quot;S-AMF-5-SA_NasAlgmAmfChangeN2&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b68da681-1330-4146-b5d5-65284139ba46" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Specify abstract TS resource name uses to perform node test session, can setting in parameter file</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="4b399bb3-047f-43fb-9376-4ae6f7359b19" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>ts_nodal_name = &quot;TS1&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ab86259c-1204-4d54-978b-9d0eae48c947" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>testserver_number = 1</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="a27f301c-518f-496a-914e-288f5c458142" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Specify generate a TAC Report at the end of the test </body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="7ffb1e25-0e9d-4efc-bc3f-7a9f98e2d94e" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>enable_tac_report = &quot;&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="2c33e33d-5d81-42fd-9ab5-aceefa33f444" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Specify report format</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="f957e3f9-13da-4893-87e4-2c49086072ae" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>report_format = &quot;csv&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="52cf1fb0-c715-44e1-a5bb-eea77bb24eb3" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Get parameter values and update variables</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="99a8168d-f737-4341-9cff-ba95d5aa94b9" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>enable_tac_report = param(&apos;TC_parameters/Enable_TAC_Report&apos;, enable_tac_report)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="bb6b3dd0-0e14-4bb5-8a45-7a741ef2a4a1" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>params = &quot;TC_parameters/Expected_CPU_Threshold:(0):true;TC_parameters/Expected_Memory_Threshold:(0):true&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="76561215-7419-4868-add1-7e8650a6cb3d" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>ipa_path = &quot;TC_parameters/Integrity_Protection_Algorithm_Priority_Order&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="7a673a61-007a-4f3d-8299-0e7adaaa45a0" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>params += &quot;;{0}/NIA0:[0,1,2,3,4]:false;{0}/NIA1:[0,1,2,3,4]:false;{0}/NIA2:[0,1,2,3,4]:false;{0}/NIA3:[0,1,2,3,4]:false&quot;.format(ipa_path)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="0416d906-7dd1-4bb7-989c-14d231cfd385" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>params += &quot;;LS_Nodal_favorite_params/TS1/ts0/tc2/AmfNas5gMmIntegrityAlgorithm:[0,1,2,3]:false&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="96541c74-b12f-4043-b70a-78b6392388b4" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#validate_params(params=params)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="1d6a4c90-82fd-41b7-80d2-6e79cea7c741" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>validate_order_in_ipa_param(prefix_path=ipa_path)</body>
                                            </command>
                                            <postProcessing>
                                                <storeResponseAt>highest_priority_nia</storeResponseAt>
                                                <storeResponseText>true</storeResponseText>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="926d6efc-6f4a-4bcb-b63e-7188bbd0249c" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>KPIs settings</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="f3e0622e-7bf4-4ba2-93fb-a667d4df0b17" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Get information in Topology and detect test type</body>
                    </command>
                    <nestedSteps>
                        <item guid="df16c248-1c01-49ec-8786-16009c2240a5" action="call" useFieldsInCommand="false">
                            <command>
                                <body>project://ai_LS_5G/utility_library/topology.fftc#get_topology_resource_info()</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>isEmpty()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == &quot;true&quot;</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Cannot get resource information</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="AbortExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>mapped/Json/tas/ipAddress</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>tas_ipaddress</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>mapped/Json/tas/Hostname</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>tas_hostname</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>testservers()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>ts_groups</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(mapped/Json/testservers/item)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>tsgroup_count</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>isB2B()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>is_b2b</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>devices()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>devices</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>suts()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>user_suts</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>mapped/Json/tas/username</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>tas_username</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>mapped/Json/tas/password</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>tas_password</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(mapped/Json/testservers/item[starts-with(ts_param_name, &apos;TS&apos;)])</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt;= ts_groups_required</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>ts_number = value</statement>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>There is not enough #Test Server to run this script: requires &quot;[ts_groups_required]&quot;, actual &quot;{value}&quot;</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="AbortExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query sub="true">count(mapped/Json/testservers/item\\[ts_param_name = &apos;[ts_node_name]&apos;])</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt; 0</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>sut_model = &quot;&quot;</statement>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>sut_make = &quot;&quot;</statement>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query sub="true">mapped/Json/testservers/item\\[ts_param_name = &apos;[ts_node_name]&apos;]/Make</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>sut_make</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query sub="true">mapped/Json/testservers/item\\[ts_param_name = &apos;[ts_node_name]&apos;]/Model</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>sut_model</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                                <storeResponseAt>resource_info</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="31ab3659-e69c-4488-a29e-02223a028c80" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>tas_api_url = &quot;{0}:8080/api&quot;.format(tas_hostname if tas_hostname else tas_ipaddress)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="44638e80-db1c-438b-824e-edbf6d5b1f08" action="if" useFieldsInCommand="false">
                            <command>
                                <body>not tas_api_url.startswith(&quot;http&quot;):</body>
                            </command>
                            <nestedSteps>
                                <item guid="eb353ce4-997e-4cde-80f7-e066870ffc11" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>tas_api_url = &quot;http://{0}&quot;.format(tas_api_url)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="16b01154-a212-4cbc-a313-efb21d20bbad" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>tas_username = param(&apos;Topology_parameters/TAS/Username&apos;, tas_username)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7df86e3e-2100-4a7a-ad7f-839371b9fc24" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>tas_password = param(&apos;Topology_parameters/TAS/Password&apos;, tas_password)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="92eb125d-8454-40e8-a22e-eb949d46924d" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Start iTest Landslide Session and verify TAS information from Topology</body>
                    </command>
                    <nestedSteps>
                        <item guid="bed1d3c4-76c4-4afa-bbd8-2a4d0ffc71d4" action="open" session="s1">
                            <command>
                                <body>project://di_Landslide/session_profiles/landslide_rest.ffsp</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="contains">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                <searchString>Error</searchString>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == 1</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>Cannot start Landslide Session at: [tas_api_url]</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="AbortExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>success()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>Start Landslide Session at: [tas_api_url]</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                <stepProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionProperties type="com.fnfr.svt.adapter.automation.tools.common.documents.TransferableDocumentObject" transferableToolId="com.spirent.itest.applications.landsliderest" transferableType="com.spirent.itest.applications.landsliderest.properties.LandslideRestSessionProperties" returnRawResponseText="true" returnRawResponseText.inherit="false"/>
                                <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="9a8efd39-7e9e-4633-a335-c4c17d34b062" action="comment" useFieldsInCommand="false" skippReporting="false">
                    <command>
                        <body>Get Library Id</body>
                    </command>
                    <nestedSteps>
                        <item guid="8b0e3d8f-6e79-4a00-aae3-b3d58668960c" action="get_library_id" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>()</body>
                            </command>
                            <postProcessing>
                                <storeResponseAt>library_id</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="1531808a-c149-4ea6-bd6d-9a517ea2051a" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Check Node/Nodal test session exists on TAS or not.</body>
                    </command>
                    <nestedSteps>
                        <item guid="9909906d-e1b6-4e66-8f8c-a163be8a2bee" action="is_test_session_exists" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>(test_session_name=nodal_test_session, library_id=library_id)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == &quot;True&quot;</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5df6358c-9412-40ca-93ad-37746ba1fcc8" action="if" useFieldsInCommand="false">
                            <command>
                                <body>is_b2b == &quot;true&quot;:</body>
                            </command>
                            <nestedSteps>
                                <item guid="101ba0d3-ab83-48c8-8e62-a68840fc0ece" action="is_test_session_exists" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(test_session_name=node_test_session, library_id=library_id)</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>responseLine()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>value == &quot;True&quot;</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="ExitExecution">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="7a90489e-54a1-4519-bda4-a2c8e756eff4" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Verify test servers: status, license, process, ... map test session requirement</body>
                    </command>
                    <nestedSteps>
                        <item guid="0f90c98b-951a-4008-bacf-90df99b4a637" action="verify_test_servers" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>(ts_groups=ts_groups)</body>
                            </command>
                            <postProcessing>
                                <storeResponseAt>ts_groups</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="57207017-bd96-4dc8-a8e0-755ae81477f3" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Start SUT Test Session for B2B testing or return SUTs information for E2E testing</body>
                    </command>
                    <nestedSteps>
                        <item guid="bdca1d74-ea1d-44c6-b374-02618e8e97ba" action="if" useFieldsInCommand="false">
                            <command>
                                <body>is_b2b == &quot;true&quot;:</body>
                            </command>
                            <nestedSteps>
                                <item guid="24cf01dd-6c72-4f57-8e8f-3c23b3a232d9" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:Start B2B Testing</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">Start B2B Testing</message>
                                    </applicationProperties>
                                </item>
                                <item guid="fe5360f9-1a69-4203-90b9-0d4d3598aa5c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>automation_steps = &quot;-4:-4::-1:-1::0;0:0:Init:-1:-1::0;0:0:Start:-1:-1::0&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="09a84f6f-4d99-4006-9c9e-7ea75d727554" action="run_test_session" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(test_session_name=node_test_session, library_id=library_id, ts_groups=ts_groups, ts_node_name=ts_node_name, return_run_data=&apos;false&apos;, check_exist=&apos;false&apos;, steps=automation_steps, expected_state=&apos;1_Waiting&apos;)</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>count(mapped/Json/runId)</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) &gt; 0</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>error = False</statement>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>error = True</statement>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>runId()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>running_node_id</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>ts_id()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>reserved_ts_ids</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                        <storeResponseAt>running_node_info</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b5a50549-10a7-47be-bced-09a6d5cf8394" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>error:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="562b6277-aadc-42fa-b08d-784b8421fc0f" action="show_error_and_cleanup" session="s1" useFieldsInCommand="false">
                                            <command>
                                                <body>(message=running_node_info)</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="none">
                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>False</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="da073648-d2c4-4384-9220-74800713daf0" action="exit" useFieldsInCommand="false">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5e9d9269-8621-4069-acc8-6c3df932dceb" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Set flag &quot;is reserve&quot; of reserved TS = true </body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="b6ad6cc1-c156-4f94-8101-4aeb51d47f23" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>reserved_ts_id_list = reserved_ts_ids.split(&quot; &quot;)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e9f8ac59-2bb1-4728-8c4a-4f32dfa596a6" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>reserved_ts_id in reserved_ts_id_list:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="dc7fc7d0-751c-49c0-8240-52164531d872" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>print(ts_groups)</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">count(mapped/Json/item\\[TS_ID = [reserved_ts_id]]/preceding-sibling::*)</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>ts_used_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="5cba5191-f42d-45b8-8e2b-d5764bf5d5d2" action="json" useFieldsInCommand="false">
                                                    <command>
                                                        <body>action=&apos;setJsonValue&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;ts_groups&apos;, pathValue=&apos;{&quot;\\\\[[ts_used_index]]/is_reserve&quot;:true}&apos;</body>
                                                    </command>
                                                    <postProcessing>
                                                        <storeResponseAt>ts_groups</storeResponseAt>
                                                        <storeResponseText>true</storeResponseText>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                                        <action inherit="false">setJsonValue</action>
                                                        <pathValue inherit="false" sub="true">{&quot;\\[[ts_used_index]]/is_reserve&quot;:true}</pathValue>
                                                        <documentName inherit="false">ts_groups</documentName>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="069491a7-a237-44f5-b224-b9fe87ddf510" action="else" useFieldsInCommand="false">
                            <nestedSteps>
                                <item guid="730d4bf1-2aa2-4a04-bc40-82f8bab92e89" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:Start E2E Testing</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">Start E2E Testing</message>
                                    </applicationProperties>
                                </item>
                                <item guid="21796285-cabe-4f0d-be7d-6d5a41941dad" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>running_node_id = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="fb9c45a3-405b-468a-ad79-7eeb31b99952" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>node_run_data = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="605ed2cd-3b11-4a80-9c0b-ede33a9c5a5c" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Repair run data for Nodal Test Session</body>
                    </command>
                    <nestedSteps>
                        <item guid="1b0c9e79-0a93-43f8-b773-390fcda6d2e5" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get run data</body>
                            </command>
                            <nestedSteps>
                                <item guid="7c1bdd1a-aad4-4808-bbeb-69da2a9d38ac" action="get_test_session_data" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(test_session_name=nodal_test_session, library_id=library_id)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>testsession_data</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d1fadc82-c8ef-4515-9b6e-d0e7ee27188c" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Configure Reports Options</body>
                            </command>
                            <nestedSteps>
                                <item guid="81f1cc07-c33d-470d-9cec-48e0493b7a4c" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Configure TAC Report Option</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="30563ecb-89a0-44d2-81d4-7b7412d8778a" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>enable_tac_report:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="9103f259-64cd-43dd-acd7-8a0500cde52d" action="json" useFieldsInCommand="false">
                                                    <command>
                                                        <body>action=&apos;setJsonValue&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;testsession_data&apos;, pathValue=&apos;{&quot;reportOptions/generateTac&quot;:true}&apos;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                                        <action inherit="false">setJsonValue</action>
                                                        <pathValue inherit="false" sub="true">{&quot;reportOptions/generateTac&quot;:true}</pathValue>
                                                        <documentName inherit="false">testsession_data</documentName>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="5565d4ae-2800-447e-a0d9-3d4e075d8c3c" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="0bed56b8-098d-40b2-8960-ff0d06fb1029" action="json" useFieldsInCommand="false">
                                                    <command>
                                                        <body>action=&apos;setJsonValue&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;testsession_data&apos;, pathValue=&apos;{&quot;reportOptions/generateTac&quot;:false}&apos;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                                        <action inherit="false">setJsonValue</action>
                                                        <pathValue inherit="false" sub="true">{&quot;reportOptions/generateTac&quot;:false}</pathValue>
                                                        <documentName inherit="false">testsession_data</documentName>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0de0027d-8940-44ef-a6ed-132a38442050" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Configure report format</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="2f97c359-a72a-4653-9bae-33a0d8dca048" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>report_format == &quot;csv&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="5897a856-73fe-4f31-9a29-ebf995463bde" action="json" useFieldsInCommand="false">
                                                    <command>
                                                        <body>action=&apos;setJsonValue&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;testsession_data&apos;, pathValue=&apos;{&quot;reportOptions/format&quot;:1}&apos;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                                        <action inherit="false">setJsonValue</action>
                                                        <pathValue inherit="false" sub="true">{&quot;reportOptions/format&quot;:1}</pathValue>
                                                        <documentName inherit="false">testsession_data</documentName>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="06181a85-0f6a-4bd8-b980-b70e530d4095" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>report_format == &quot;xls&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="8d614ae1-66db-48f4-bbb7-d2cb9529de2a" action="json" useFieldsInCommand="false">
                                                    <command>
                                                        <body>action=&apos;setJsonValue&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;testsession_data&apos;, pathValue=&apos;{&quot;reportOptions/format&quot;:0}&apos;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                                        <action inherit="false">setJsonValue</action>
                                                        <pathValue inherit="false" sub="true">{&quot;reportOptions/format&quot;:0}</pathValue>
                                                        <documentName inherit="false">testsession_data</documentName>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="3a2ae8ff-bbd1-4c12-b142-8e694a4f8656" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Update automation control</body>
                            </command>
                            <nestedSteps>
                                <item guid="5f83f2b0-82c5-4165-88cc-325d218d1bc9" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>automation_steps = &quot;-4:-4::-1:-1::0;0:0:Init:-1:-1::0;0:0:Start:-1:-1::0;0:2:Init:-1:-1::0;0:2:Start:-1:-1::0;0:1:Init:0:2:RUNNING:0;0:1:Start:-1:-1::0;0:1:Stop:0:1:RUNNING:30;0:2:Stop:0:1:STOPPED:0;0:0:Stop:0:2:STOPPED:0&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="92848ca5-06c9-4274-85c9-2e60fe5584ad" action="update_automation_control_step" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(run_data=testsession_data, steps=automation_steps)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>testsession_data</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="9af3435b-6bab-48a9-b535-fe3b4c2ec307" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Add SUT</body>
                            </command>
                            <nestedSteps>
                                <item guid="84140a3e-37dc-4aa1-8e8c-cfd03d00c15d" action="apply_SUT_parameter" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(sut_path=&apos;SUT/nodal&apos;, run_data=testsession_data)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>testsession_data</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="85ee1126-0fd6-4a84-ba4a-ae44c4ecc6df" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Configure parameters group</body>
                            </command>
                            <nestedSteps>
                                <item guid="53020208-c203-4708-96e4-0eb4ffb0ac99" action="configure_tc_parameters_from_LS_params" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(run_data=testsession_data, param_group_names=&apos;LS_Nodal_favorite_params&apos;)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>testsession_data</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f3fb06f6-c454-4f08-bc81-c2233bdb48e5" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Get run data for each test instance</body>
                            </command>
                            <nestedSteps>
                                <item guid="e9be2dd4-66d8-4161-afe6-69aa1e340bfc" action="configure_test_session" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(run_data=testsession_data, ts_groups=ts_groups, ts_name=ts_nodal_name)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>run_data</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="402f83a1-20ec-4cdd-9e2d-7277cb2cd83e" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Perform Landslide Test Procedure</body>
                    </command>
                    <nestedSteps>
                        <item guid="b1b4f0c8-457a-462a-b679-df55dd33a265" action="call" useFieldsInCommand="false">
                            <command>
                                <body>execute_landslide_procedure(run_data=run_data, is_b2b=is_b2b, running_node_id=running_node_id, timeout=test_waiting_timeout, clean_up=clean_up)</body>
                            </command>
                            <postProcessing>
                                <storeResponseAt>running_nodal_id</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="09e6e826-3edf-4e58-998c-b9b685e90282" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Show general info</body>
                    </command>
                    <nestedSteps>
                        <item guid="fede8736-a1fc-4821-b14c-c3da5476de88" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Add &quot;---&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="ba100480-468a-44c7-b1bb-29f7b691ccbb" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;135&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="87a7a2a5-4c95-4aa2-8926-00b8c7f697a7" action="if" useFieldsInCommand="false">
                            <command>
                                <body>sut_make:</body>
                            </command>
                            <nestedSteps>
                                <item guid="ca6ec107-f4d9-4756-abe0-48f189227de4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(sut_make)</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>responseLine()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="message">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                        <message>Make: {value}</message>
                                                        <extractData>true</extractData>
                                                        <tag sub="false">Make</tag>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="4ad7b02c-e63f-4ff7-b65f-ab543d97f568" action="if" useFieldsInCommand="false">
                            <command>
                                <body>sut_model:</body>
                            </command>
                            <nestedSteps>
                                <item guid="ed00f80c-8c09-4d40-a259-c3e68416bbac" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(sut_model)</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>responseLine()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="message">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                        <message>Model: {value}</message>
                                                        <extractData>true</extractData>
                                                        <tag sub="false">Model</tag>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="72b3a0df-202f-409a-8269-055b350f3527" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>print(info(&apos;testCaseName&apos;, &apos;main&apos;))</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>Test Case Name: {value}</message>
                                                <extractData>true</extractData>
                                                <tag sub="false">Test Case Name</tag>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="6f06cbeb-489f-4150-9efc-10ae74ff30ef" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Extract KPIs from Landslide Measurement and pcap file</body>
                    </command>
                    <nestedSteps>
                        <item guid="bffff757-ab20-4166-9e6a-55c165252495" action="comment" useFieldsInCommand="false" skippReporting="false">
                            <command>
                                <body>Add &quot;---&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="53157350-d96b-482c-8fa1-d27f025b147c" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;135&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c1b288a9-1ff5-4de7-a73c-db3b5f2b61f1" action="Custom" session="s1">
                            <command>
                                <body>-requestMethod GET -dataType json -rawResponse true -url runningTests/[running_nodal_id]</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>resultFilesList()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>result_files</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>criteriaStatus()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>criterial_status</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                                <storeResponseAt>running_test_info</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.itest.platform2.shared.documents.ntaf.NtafTransferableDocumentObject" action="Custom" subharness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harnessName="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" rawResponse="true" rawResponse.inherit="false" url="runningTests/[running_nodal_id]" url.inherit="false"/>
                        </item>
                        <item guid="bf4c6bdd-19b5-4906-9c59-9b11b08f6377" action="Custom" session="s1">
                            <command>
                                <body>-requestMethod GET -dataType json -rawResponse true -url runningTests/[running_nodal_id]/measurements/favorites</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>success()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="message">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                <message>Grabbing favorites measurements from running test ID: [running_nodal_id]</message>
                                                <tag sub="false" defaultValue=""/>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                                <storeResponseAt>measurement_favorites</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.itest.platform2.shared.documents.ntaf.NtafTransferableDocumentObject" action="Custom" subharness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harnessName="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" rawResponse="true" rawResponse.inherit="false" url="runningTests/[running_nodal_id]/measurements/favorites" url.inherit="false"/>
                        </item>
                        <item guid="6d2c4b32-cbe0-4fac-a61c-2618c9931661" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>is_valid = False</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="b6416590-1a0c-4521-bb4a-b31e4658b4be" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Validate KPIs</body>
                            </command>
                            <nestedSteps>
                                <item guid="6cba64c9-f8b3-4214-9ed9-0e4da567dd43" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>validate_KPIs(measurement_favorites=measurement_favorites, is_b2b=is_b2b, running_id=running_nodal_id)</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>result()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>value == &quot;PASS&quot;</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>is_valid = True</statement>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>is_valid = False</statement>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>KPIs()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>instance_kpis</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>favorites_measurements()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>instance_favs</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="c4619545-1ce5-49fd-9e34-8b9b158133d5" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Validate PCAP files/IE log</body>
                    </command>
                    <nestedSteps>
                        <item guid="e9e98f50-c5f9-457e-938a-be4228ab7ea2" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>validate PCAP</body>
                            </command>
                            <nestedSteps>
                                <item guid="4485cae5-9234-402c-83ee-ecdbd392e6db" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>is_valid:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="333a25b6-5a91-4b82-91f1-05e665c8972f" action="comment" useFieldsInCommand="false" skippReporting="false">
                                            <command>
                                                <body>Add &quot;---&quot;</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="9c3c3117-3b00-4fda-b111-34770858b2f3" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;135&apos;)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e5c90e9d-2f2d-4745-ace0-1c01ad6892cd" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Download result files</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="7ef066c5-655b-423a-b7b1-95191c53b21c" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Show result files and get pcap files from Nodal</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="543d953c-6cb2-4c39-8204-13baf40a76e2" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Show result files and get pcap files from result list</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="6b35cfa6-8ede-47d5-b91a-28d49eca48fa" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>print(result_files)</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>count(mapped/Json/item)</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="store">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                        <storageLocation>file_count</storageLocation>
                                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="cb5eb3a1-c6f7-4da6-9c7b-9c84f137668f" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>pcap_files = []</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="c9cd42c0-af04-49d6-bfd1-28da36ed48cd" action="for" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>i in range(0, int(file_count)):</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="86bc7032-c78e-46f2-9525-0204f3d7e94f" action="json" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>action=&apos;getJsonNode&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;result_files&apos;, pathValue=&apos;{&quot;\\\\[[i]]&quot;}&apos;</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <analysisRules>
                                                                                    <item>
                                                                                        <extractorInfo extractorType="query">
                                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                                <query>group1()</query>
                                                                                            </extractorProperties>
                                                                                        </extractorInfo>
                                                                                        <processorInfo ruleType="store">
                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                                <storageLocation>file_url</storageLocation>
                                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                                            </ruleProperties>
                                                                                        </processorInfo>
                                                                                    </item>
                                                                                </analysisRules>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                                                                <action inherit="false">getJsonNode</action>
                                                                                <pathValue inherit="false" sub="true">{&quot;\\[[i]]&quot;}</pathValue>
                                                                                <documentName inherit="false">result_files</documentName>
                                                                            </applicationProperties>
                                                                        </item>
                                                                        <item guid="a4caffc6-81dc-4831-a420-386d062e4ebc" action="if" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>file_url.endswith(&quot;pcap&quot;):</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="90899831-edb4-46e6-ba9b-d5eb126752ab" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>file_name = file_url[(file_url.rindex(&quot;/&quot;) + 1):len(file_url)]</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="dc8ba373-0e48-487c-8901-b31039a5a3e2" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>pcap_files.append(file_name)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="0e0f3e65-799a-4e1f-826b-d3374c88473e" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Download and save pcap files to local</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="a74d73f3-a80c-43c1-bbbe-f3d75d14d64f" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>local_files = []</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="f96047c4-7ecb-4987-ad08-8e0240fe7e79" action="for" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>file in pcap_files:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="babb2883-ef02-4c4a-92c6-2c0167636569" action="SaveResult" session="s1">
                                                                            <command>
                                                                                <body>-runningTestId [running_nodal_id] -location &quot;[info(&apos;tempDir&apos;, &apos;uri&apos;)]/[file]&quot; -filepattern [file]</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <analysisRules>
                                                                                    <item>
                                                                                        <extractorInfo extractorType="query">
                                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                                <query>file_0()</query>
                                                                                            </extractorProperties>
                                                                                        </extractorInfo>
                                                                                        <processorInfo ruleType="store">
                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                                <storageLocation>pcap_file</storageLocation>
                                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                                            </ruleProperties>
                                                                                        </processorInfo>
                                                                                    </item>
                                                                                </analysisRules>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.itest.platform2.shared.documents.ntaf.NtafTransferableDocumentObject" action="SaveResult" subharness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harnessName="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" runningTestId="[running_nodal_id]" runningTestId.inherit="false" location="[info(&apos;tempDir&apos;, &apos;uri&apos;)]/[file]" location.inherit="false" filepattern="[file]" filepattern.inherit="false"/>
                                                                        </item>
                                                                        <item guid="685ed8d8-8959-41a2-abdf-030deef620cd" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>local_files.append(pcap_file)</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="6e33d44f-ad2e-431c-ab7f-024c131c2f4f" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>sut_pcap_files = []</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="70371e27-0db8-4618-9ea9-1d5126b0d392" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>node_local_files = []</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="dc0174fb-1139-435d-aeb0-b35cec3a86ca" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Validate PCAP files</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="8e77822f-fc95-41d9-9a9e-168dc6e40188" action="open" session="s4">
                                                    <command>
                                                        <body>application:com.fnfr.svt.applications.wireshark</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                                                        <stepProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        <sessionProperties type="com.fnfr.svt.applications.wireshark.WiresharkSessionProperties">
                                                            <advancedDisplayOptions inherit="false">-o nas-5gs.null_decipher:TRUE</advancedDisplayOptions>
                                                            <sessionbuilderInitializeAction type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </sessionProperties>
                                                        <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="8e1d2e56-6161-4abf-bca1-6b55e8de8c2a" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Generate, read and return KPIs from pcap file</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="0e3b0639-5829-4b2c-9b93-54af41dc2c92" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>extract_pcap(nodal_pcaps=local_files, sut_pcaps=node_local_files, nodal_file_names=pcap_files, sut_file_names=sut_pcap_files, is_b2b=is_b2b, ipa_prefix_param_path=ipa_path, highest_priority_nia=highest_priority_nia)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="f6f5d79e-5f86-4a92-a67a-6e31425825c4" action="close" session="s4">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2711d626-28d5-40fb-803c-9ed402b9a8ed" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Show KPIs and favorites</body>
                    </command>
                    <nestedSteps>
                        <item guid="a98c1f19-b1ae-4440-9836-fe7d3d709bf3" action="if" useFieldsInCommand="false">
                            <command>
                                <body>is_valid:</body>
                            </command>
                            <nestedSteps>
                                <item guid="7f97eadf-01e8-4bfa-8794-699739a43997" action="comment" useFieldsInCommand="false" skippReporting="false">
                                    <command>
                                        <body>Add &quot;---&quot;</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="e80e49ce-95dc-4978-8907-3ae3d581d9e4" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;135&apos;)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b16fe0bb-1a9e-4e6b-9232-5c4b2072fbf0" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Print KPIs</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="036fc08c-1424-4a1d-a931-1a633b778dbd" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:KPI:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">KPI:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="8d5f6efe-622d-4f3e-a3d7-8089ff782941" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#print_extracted_data(data=instance_kpis)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="694420b3-4c3b-418b-8b69-9f586261267b" action="comment" useFieldsInCommand="false" skippReporting="false">
                                    <command>
                                        <body>Add &quot;---&quot;</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="cfbc2cf5-41dd-46b8-b057-632ca8d03ec7" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;135&apos;)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c85ccea9-9fdd-4c43-b204-5ced6a430cac" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Print favorites measurements</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="960fc0c0-bde6-44e0-9f19-f98a83a0b146" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:Favorites Measurements:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">Favorites Measurements:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="32310143-edba-4d4b-9549-3625380652d7" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#print_extracted_data(data=instance_favs)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="f0b63daa-93ad-461d-8c6e-9fe4bc8e2b55" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Check success</body>
                    </command>
                    <nestedSteps>
                        <item guid="fa228990-804f-413d-be31-59f845132bcf" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>print(is_valid)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>responseLine</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == &quot;True&quot;</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="90e6f0f1-6132-42c9-ad1e-b6739ec92751" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Add artifact links</body>
                    </command>
                    <nestedSteps>
                        <item guid="89a2c39a-94af-4361-a17a-3affefc7646e" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Artifact link to Landslide Topology</body>
                            </command>
                            <nestedSteps>
                                <item guid="4448d455-7d34-4db5-9de3-a5b54551ce1c" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#add_topology_artifactLink()</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d837e236-531c-489f-a078-9c41438c18cb" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Add artifactLink to running id</body>
                            </command>
                            <nestedSteps>
                                <item guid="a94df78a-4a1f-47ed-967d-ec8f4cd990ba" action="add_result_artifactLink_of_running_ids" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(tas_hostname=tas_hostname, tas_ipaddress=tas_ipaddress, tas_username=tas_username, running_id=running_nodal_id, result_files=result_files, file_extension=&apos;.pcap;tac.zip;tcdiagrams.zip;iev.log&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="43781e82-6dce-4051-8224-34743c1c0e4d" action="comment" useFieldsInCommand="false" skippReporting="false">
                    <command>
                        <body>Show RIDs and clean up nodal running tests</body>
                    </command>
                    <nestedSteps>
                        <item guid="af8b0803-84f6-4a23-b315-dfde6bf71a6d" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Add &quot;---&quot;</body>
                            </command>
                            <nestedSteps>
                                <item guid="4a2c3268-eb1c-4ccc-982f-c9bc4018ad6f" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;135&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c1888021-029b-41f5-9a8d-2a6b76dc3203" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>message = &apos;Landslide Running IDs: {0}&apos;.format(running_nodal_id)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="3aec8cf7-d373-40b8-82a3-afb09413d63f" action="message" useFieldsInCommand="false">
                            <command>
                                <body>Information:[message]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                <message inherit="false">[message]</message>
                            </applicationProperties>
                        </item>
                        <item guid="4388c4e3-9903-4c92-a31b-100e177d2b05" action="if" useFieldsInCommand="false">
                            <command>
                                <body>clean_up == &quot;true&quot;:</body>
                            </command>
                            <nestedSteps>
                                <item guid="b72e229e-44ac-4d2a-a19a-1fd6c7806139" action="delete_running_tests" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(running_id_list=running_nodal_id)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="8785fddf-53f0-48f3-97c1-282e18248300" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Close LS Session</body>
                    </command>
                    <nestedSteps>
                        <item guid="fead448e-9ae9-404d-acb6-90e0844d5688" action="close" session="s1">
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <response>{}</response>
        </item>
        <item name="execute_landslide_procedure" isPublic="true">
            <steps>
                <item guid="ad7f3a1b-ceee-4955-8bc9-bae6acb62113" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Run test instance</body>
                    </command>
                    <nestedSteps>
                        <item guid="521e3c01-77f6-461c-9bf6-5ccef111b9f6" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>running_nodal_id=&quot;&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="9c92e558-70b4-403b-92f0-9517643a82db" action="call" useFieldsInCommand="false">
                            <command>
                                <body>execute_nodal_tests(run_data=run_data, is_b2b=is_b2b, timeout=timeout, running_node_id=running_node_id)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(mapped/Json/reason)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt; 0</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>error = True</statement>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>error = False</statement>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(//running_nodal_id)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == 1</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>running_nodal_id()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>running_nodal_id</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                                <storeResponseAt>response</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e440ed28-d6cb-446b-9acc-3aee0ab3d041" action="if" useFieldsInCommand="false">
                            <command>
                                <body>error:</body>
                            </command>
                            <nestedSteps>
                                <item guid="355aa0fd-a823-4526-a781-213322fe2ae1" action="show_error_and_cleanup" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(message=response, running_node_id=running_node_id, clean_up=clean_up, timeout=timeout)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b23464ef-4597-4cfb-b5db-e70b1413f6e5" action="exit" useFieldsInCommand="false">
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="61ae3e41-c349-48f2-aff7-49310004e9f1" action="comment" useFieldsInCommand="false" skippReporting="false">
                    <command>
                        <body>Stop Emulated SUT if need</body>
                    </command>
                    <nestedSteps>
                        <item guid="a68426ed-14f2-4b3c-8116-3bedd626edb5" action="if" useFieldsInCommand="false">
                            <command>
                                <body>is_b2b == &quot;true&quot;:</body>
                            </command>
                            <nestedSteps>
                                <item guid="e7214e4b-9e16-49aa-bf5a-ce3d666a8c6c" action="stop_or_abort_test" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(running_id=running_node_id, abort=&apos;false&apos;, clean_up=clean_up, timeout=timeout)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="e6e641a8-1d6c-4e5b-bd25-12c362fe9885" action="return">
                    <command>
                        <body>[running_nodal_id]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="run_data">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="is_b2b">
                    <defaultValue>true</defaultValue>
                </item>
                <item name="running_node_id"/>
                <item name="timeout">
                    <defaultValue>180</defaultValue>
                </item>
                <item name="clean_up"/>
            </arguments>
            <response>{}</response>
        </item>
        <item name="execute_nodal_tests" isPublic="true">
            <steps>
                <item guid="8484f1fe-af26-45b8-b743-4a9a09975c8a" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Run test</body>
                    </command>
                    <nestedSteps>
                        <item guid="08bf48eb-5b14-4ae1-8935-9bd0be908ab3" action="comment" useFieldsInCommand="false" skippReporting="false">
                            <command>
                                <body>Enable port capture</body>
                            </command>
                            <nestedSteps>
                                <item guid="a40c88cb-d664-43a6-a5a5-3a18a9c9e924" action="enable_port_capture" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(run_data=run_data)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>run_data</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6a219d2a-01b7-4d97-af8f-d20f8fddb7f3" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>print(run_data)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>name()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>test_name</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d009624b-25b8-4f47-a540-912ab84b7f83" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>message = &apos;Run Test Session: &quot;{0}&quot;&apos;.format(test_name)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="2982acac-9b2a-4ac4-b999-7ef3a1535457" action="message" useFieldsInCommand="false">
                            <command>
                                <body>Information:[message]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                <message inherit="false">[message]</message>
                            </applicationProperties>
                        </item>
                        <item guid="a28ef384-33b9-4069-925c-40e7f7c7a6c5" action="run_test_using_run_data" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>(run_data=run_data)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(mapped/Json/runId)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt; 0</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>error = False</statement>
                                                        </actionProperties>
                                                    </item>
                                                </actionsWhenTrue>
                                                <actionsWhenFalse>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>error = True</statement>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>runId()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>running_id</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                                <storeResponseAt>response</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="8f065338-5da9-4c72-8722-68e580b137ba" action="if" useFieldsInCommand="false">
                            <command>
                                <body>error or not running_id:</body>
                            </command>
                            <nestedSteps>
                                <item guid="49b9fcb4-a644-4738-8a5a-23d797604697" action="return">
                                    <command>
                                        <body>[response]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="628ee3df-a90d-4d3a-8ffc-182890c3a4a7" action="else" useFieldsInCommand="false">
                            <nestedSteps>
                                <item guid="a10cfef1-347c-4122-b62f-3ea0f4181189" action="json" useFieldsInCommand="false">
                                    <command>
                                        <body>action=&apos;createJson&apos;, documentName=&apos;response&apos;, fromFile=&apos;false&apos;, jsonString=&apos;{&quot;running_nodal_id&quot;: &quot;[running_id]&quot;}&apos;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                        <action inherit="false">createJson</action>
                                        <jsonString inherit="false" sub="true">{&quot;running_nodal_id&quot;: &quot;[running_id]&quot;}</jsonString>
                                        <documentName inherit="false">response</documentName>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="5818af0f-ee25-4c3b-b70b-7476333dd0ca" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Waiting test for ready</body>
                    </command>
                    <nestedSteps>
                        <item guid="15fcb2f7-530c-4a79-8785-51cda61d4215" action="waiting_for_test_get_expected_state" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>(unexpected_states=&apos;ERROR;COMPLETE_ERROR&apos;, time_out=&apos;180&apos;, running_test_id=running_id, expected_state=&apos;1_Waiting&apos;)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="d8c3587a-80c8-471c-8311-6392494137f3" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Continue Emulated SUT</body>
                    </command>
                    <nestedSteps>
                        <item guid="56eb72ae-2835-4125-bba5-55ec5f98d935" action="if" useFieldsInCommand="false">
                            <command>
                                <body>is_b2b == &quot;true&quot;:</body>
                            </command>
                            <nestedSteps>
                                <item guid="2b203f22-c8a1-412c-9490-fc85d7cf6e1a" action="perform_next_action" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(running_test_id=running_node_id, delay=&apos;0&apos;, time_out=&apos;180&apos;, expected_state=&apos;1_Waiting&apos;, next_action=&apos;continue&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2c179d0b-838c-4d1d-a26f-3e1bad909620" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Continue Nodal Test</body>
                    </command>
                    <nestedSteps>
                        <item guid="1dea657b-90ad-458f-bb5b-70618120ec8b" action="perform_next_action" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>(running_test_id=running_id, delay=&apos;10&apos;, time_out=&apos;180&apos;, expected_state=&apos;1_Waiting&apos;, next_action=&apos;continue&apos;)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="30013841-504e-40ef-922f-ac240884648e" action="comment" useFieldsInCommand="false" skippReporting="false">
                    <command>
                        <body>Sleep 60 seconds</body>
                    </command>
                    <nestedSteps>
                        <item guid="39dd47a1-e53e-4fd2-8fa9-4f971b23bb90" action="sleep">
                            <command>
                                <body>60</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="49c41022-a634-4645-a3bf-03a1de8698d1" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Waiting for nodal test stop</body>
                    </command>
                    <nestedSteps>
                        <item guid="f4e8391f-0416-4d68-b3b4-246ec77ba0aa" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Expected test session states</body>
                            </command>
                            <nestedSteps>
                                <item guid="f4b581db-66dc-49a8-b8b8-174dca11c67e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>testcase_expected_states = [&quot;RUNNING&quot;, &quot;8_DELAY&quot;, &quot;9&quot;, &quot;10&quot;, &quot;STOPPING&quot;, &quot;CLEANUP&quot;, &quot;WAIT_FOR_TRANSFERS&quot;, &quot;FINAL&quot;, &quot;COMPLETE&quot;]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6e9b7c16-57f8-48ba-aa88-9bf202b79ed3" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Unexpected test session states</body>
                            </command>
                            <nestedSteps>
                                <item guid="7c26c0e0-a00f-4aa9-9734-991aedfd0009" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unexpected_states = [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="b8a6eb66-32dd-4816-bcd7-1f7f36dc5ce7" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Crashed test session states</body>
                            </command>
                            <nestedSteps>
                                <item guid="5b5906ca-d9b9-4fee-994b-8b6dcbae11b0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>crashed_states = []</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="60e22625-b0a0-44e3-8a08-d1bd97d53785" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Error test session states</body>
                            </command>
                            <nestedSteps>
                                <item guid="7dcfcdb2-4a80-4036-b589-2292eb33c498" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>error_states = [&quot;COMPLETE_ERROR&quot;, &quot;ERROR&quot;]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="769c4947-4f6c-402d-97d1-a60eac8fe81b" action="Custom" session="s1">
                            <command>
                                <body>-requestMethod GET -dataType json -rawResponse true -url runningTests/[running_id]</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query sub="true">testStateOrStep()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>testsession_state</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.itest.platform2.shared.documents.ntaf.NtafTransferableDocumentObject" action="Custom" subharness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harnessName="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" rawResponse="true" rawResponse.inherit="false" url="runningTests/[running_id]" url.inherit="false"/>
                        </item>
                        <item guid="8395658f-ef98-4032-ae28-378db9332a61" action="if" useFieldsInCommand="false">
                            <command>
                                <body>testsession_state in testcase_expected_states:</body>
                            </command>
                            <nestedSteps>
                                <item guid="3068656e-463f-4f85-9a43-c6cd5c3eb6b0" action="waiting_for_test_get_expected_state" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(running_test_id=running_id, expected_state=&apos;COMPLETE&apos;, unexpected_states=&apos;ERROR;COMPLETE_ERROR&apos;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6d1aa379-bacd-44c8-a6e5-0e508f158aaa" action="else" useFieldsInCommand="false">
                            <nestedSteps>
                                <item guid="45056a0b-704a-4ede-8509-a2cda0eeda37" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>testsession_state in unexpected_states:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="32c9bd19-941d-45ca-9139-8420e3a537e7" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>reason = &apos;Running test: {0} was stuck at overall state: {1}. This is caused by test configuration, please check parameter file or topology.&apos;.format(running_id, testsession_state)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="45af0c4e-2525-44d5-b679-0c7f020a6272" action="stop_or_abort_test" session="s1" async="true" threadName="abort_test" useFieldsInCommand="false">
                                            <command>
                                                <body>(abort=&apos;true&apos;, timeout=&apos;180&apos;, running_id=running_id)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="078cacac-b83f-4ed3-93fa-525972d34eb0" action="elif" useFieldsInCommand="false">
                                    <command>
                                        <body>testsession_state in crashed_states:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="ff06fbe5-b95f-4ae2-be1f-00d4b19f3a5f" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>reason = &apos;Nodal test crashed.&apos;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="cda0ad7a-cc48-469b-8d39-5073b237b8a7" action="waiting_for_test_get_expected_state" session="s1" async="true" threadName="waiting_crash" useFieldsInCommand="false">
                                            <command>
                                                <body>(running_test_id=running_id, expected_state=&apos;COMPLETE&apos;, unexpected_states=&apos;ERROR;COMPLETE_ERROR&apos;)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0e5352a8-5b7a-46e5-98e8-0750e67b119b" action="elif" useFieldsInCommand="false">
                                    <command>
                                        <body>testsession_state in error_states:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="9e534d02-f7e6-4106-a149-e1675992bbda" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>reason = &apos;Test session error. Test Running {0} state: {1}&apos;.format(running_id, testsession_state)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d4a8455b-50fa-4bd1-82b2-0da6f50a569f" action="else" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="b9170c34-9a2e-49c7-9775-04634df1028b" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>reason = &quot;Unknown error. Nodal test state: {0}&quot;.format(testsession_state)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0b081e72-43d8-48cb-adad-72eab1b1e95a" action="json" useFieldsInCommand="false">
                                    <command>
                                        <body>action=&apos;addJsonNode&apos;, editResponseStructure=&apos;false&apos;, documentName=&apos;response&apos;, pathValue=&apos;{&quot;/&quot;:{&quot;reason&quot;:&quot;[reason]&quot;}}&apos;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                        <action inherit="false">addJsonNode</action>
                                        <pathValue inherit="false" sub="true">{&quot;/&quot;:{&quot;reason&quot;:&quot;[reason]&quot;}}</pathValue>
                                        <documentName inherit="false">response</documentName>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="fd4bd099-ae4e-4b2f-8792-ab2c5729fa22" action="waitthread">
                            <command>
                                <body>.*</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.kernel.WaitThreadPropertyGroup">
                                <matchType>Regex</matchType>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="6eac364d-ca54-49f4-a615-8c4a7d6a00cd" action="comment" useFieldsInCommand="false" skippReporting="false">
                    <command>
                        <body>Stop or abort tests</body>
                    </command>
                    <nestedSteps>
                        <item guid="a7dbffbe-24e0-4e08-b87b-1fe93c728840" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>complete_states = [&quot;COMPLETE&quot;, &quot;COMPLETE_ERROR&quot;, &quot;ERROR&quot;]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="a8af6377-c7d9-4b97-ae9f-ba19489fbebc" action="Custom" session="s1">
                            <command>
                                <body>-requestMethod GET -dataType json -rawResponse true -url runningTests/[running_id]</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query sub="true">testStateOrStep()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>testsession_state</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.itest.platform2.shared.documents.ntaf.NtafTransferableDocumentObject" action="Custom" subharness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harness="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" harnessName="http://spirent.com/NTAF/harness/iTest/LandslideRest/Main" rawResponse="true" rawResponse.inherit="false" url="runningTests/[running_id]" url.inherit="false"/>
                        </item>
                        <item guid="baf68bf0-6ff3-4a5b-a8bf-090d3e3acde0" action="if" useFieldsInCommand="false">
                            <command>
                                <body>testsession_state not in complete_states:</body>
                            </command>
                            <nestedSteps>
                                <item guid="ff54a848-a49d-4e23-b470-92d4e922e45d" action="stop_or_abort_test" session="s1" useFieldsInCommand="false">
                                    <command>
                                        <body>(abort=&apos;true&apos;, timeout=&apos;180&apos;, running_id=running_id)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="e468b430-3a99-49a9-a7fe-4f5eb28a65d1" action="return">
                    <command>
                        <body>[response]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="run_data">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="running_node_id"/>
                <item name="is_b2b">
                    <defaultValue>true</defaultValue>
                    <isMandatory>true</isMandatory>
                </item>
                <item name="timeout">
                    <defaultValue>180</defaultValue>
                </item>
            </arguments>
            <response>{}</response>
        </item>
        <item name="validate_KPIs" isPublic="true">
            <steps>
                <item guid="11674f2b-9c37-43f3-abf7-e6c0de1c3d9c" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Get KPIs</body>
                    </command>
                    <nestedSteps>
                        <item guid="d8156372-ee16-4645-b556-8771f35ad8fc" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>print(measurement_favorites)</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(mapped/Json/favorites/item)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) &gt; 0</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="Eval">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                            <statement>handover_required = handover_command = handover_requests = handover_request_acknowledges = nf_register_requests = nf_register_successes = nf_register_failures = nf_discover_requests = nf_discover_successes = nf_discover_failures= &quot;&quot;</statement>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NGAP__Handover_Required</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>handover_required</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NGAP__Handover_Command</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>handover_command</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NGAP__Handover_Requests</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>handover_requests</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NGAP__Handover_Request_Acknowledges</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>handover_request_acknowledges</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NRF_Producer__NF_Register_Requests</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>nf_register_requests</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NRF_Producer__NF_Register_Successes</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>nf_register_successes</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NRF_Producer__NF_Register_Failures</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>nf_register_failures</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NRF_Producer__NF_Discover_Requests</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>nf_discover_requests</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NRF_Producer__NF_Discover_Successes</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>nf_discover_successes</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                <query>//NRF_Producer__NF_Discover_Failures</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>nf_discover_failures</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                                <storeResponseAt>measurement_xml</storeResponseAt>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2713fce3-1548-4293-b30b-b21d15fbdd93" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Create KPIs response</body>
                    </command>
                    <nestedSteps>
                        <item guid="1eacf24d-449a-4640-ba4d-ba65619799f8" action="json" useFieldsInCommand="false">
                            <command>
                                <body>action=&apos;createJson&apos;, documentName=&apos;response&apos;, fromFile=&apos;false&apos;, jsonString=&apos;{&quot;result&quot;:&quot;PASS&quot;,&quot;KPIs&quot;:[]}&apos;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.json.JsonPropertiesGroup">
                                <action inherit="false">createJson</action>
                                <jsonString inherit="false">{&quot;result&quot;:&quot;PASS&quot;,&quot;KPIs&quot;:[]}</jsonString>
                                <documentName inherit="false">response</documentName>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="eccbe5b6-d3b5-4b5d-a60b-8a47720a0ad5" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Check acceptance</body>
                    </command>
                    <nestedSteps>
                        <item guid="09f64dc7-b515-4f5d-b80e-8f0c44a8eb97" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Handover Required</body>
                            </command>
                            <nestedSteps>
                                <item guid="eb1c1ec8-9773-4fa6-bbf4-7aa0b1583978" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;Handover Required&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9dd1173e-bc50-4d91-9a70-57f30b618bac" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="94c24af3-fe10-4dab-a6ef-ca437f2600d9" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 2</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4bbc7b8e-e7bf-454f-b1e8-94e2027dbc02" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="dcab815c-7973-4186-92c1-9a03f7d634a6" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = handover_required</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cb2724f8-dc32-4d4b-997f-a19466652f24" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b0a2b70c-b6b9-4916-a287-c530fd5c9798" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="6dc5f45b-c92e-4de3-a65e-11e7f59d0bfa" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5499607a-e581-4e5c-80e8-9aaf4558a70a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="00279d31-d59e-4909-bb58-e1c39985a867" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ac10829e-9ffa-465c-9aeb-3bd0610c044b" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Handover Command</body>
                            </command>
                            <nestedSteps>
                                <item guid="5a65208e-4fda-40a4-b78a-894d9bfb3411" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;Handover Command&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="df700fb4-f609-4bf5-b4b2-be52852ac554" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="86fa45aa-e60d-4601-99fd-fc7e27703baf" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 2</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="75d68657-ac96-47fb-bca3-052f480a1368" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cc43e11e-df83-4123-85c6-f94501e0e36e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = handover_command</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="aca9f6cc-08dd-49fa-b184-76f165b4e442" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a47dea62-720e-43d8-b16d-5e5dc43406ee" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="54365fb5-ba34-4343-b500-17f763334f8e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="58884e6c-03e9-44f3-bf0d-9bfcf4d8564d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="498ad4e9-ba0e-414e-9872-6f0671a8ebb5" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c7f5fff7-749d-43c5-8e7b-8078e4ffdd11" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Handover Requests</body>
                            </command>
                            <nestedSteps>
                                <item guid="67594d1f-3b16-4360-8bfa-63bf7ad93dc0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;Handover Requests&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0df08060-83a2-4ebf-9467-a92f0bfd82b0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3243c354-aec9-44a9-b668-aafacb14bc06" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 1</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5d66fa08-d2b4-4618-ad41-d95c03519cf3" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a2df9103-f093-40b6-93a1-58ce6ff82226" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = handover_requests</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cec3467f-187f-45c5-bfb2-128e3a827621" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c5192abe-f30d-46ee-8ef4-df4d9f792335" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1fe71ee8-0155-43e6-bd6d-dd0f008be46a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="674120ea-549d-4dfb-920b-37eedd04d02f" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c190ab91-ef39-4965-bb9c-714aecc601b7" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="b2a1d6e9-12da-40d5-a90b-914215a9247f" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Handover Request Acknowledges</body>
                            </command>
                            <nestedSteps>
                                <item guid="81e0bb44-8ae0-4fbe-9cba-e955f25af4de" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;Handover Request Acknowledges&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f1e3bbae-b001-47b0-bccd-689242ed07b9" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="82421913-7d42-4d4c-90e4-56693ccc745a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 1</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="69f0e055-3019-4615-8e16-aa06034f8f4d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="141c353c-451f-43b5-b1d2-7da20e282602" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = handover_request_acknowledges</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d85c97dc-13e8-4f0c-9150-d576722b84da" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cd01e9c9-3b25-4c2e-a7f2-3209817158b7" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="00f3be70-ffd6-4e35-8510-44318adbf948" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="8062e1cf-a20e-4e34-941b-a8229414fd91" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0be21211-12bd-4f99-8529-2291317c12bd" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ef0b5107-cc7e-4a54-9034-0d9fc1f010f9" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>NF Register Requests</body>
                            </command>
                            <nestedSteps>
                                <item guid="de2bf22b-ab5b-4caa-80f9-fdc5615e200c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;NF Register Requests&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a16a449f-c54e-4a94-b58c-a647c397941b" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f73be3bc-910f-4ba2-896c-d1e1c290d1dd" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 5</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="95c1ff61-7318-4e6d-a6a7-e7e6749c9862" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a4a33414-dfca-488d-85ef-5bcb7aec14f3" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = nf_register_requests</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="845a34e8-fbfd-4d99-8cdd-56d7505992f3" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b1fc2122-a891-4894-9d51-1afcc4b56f30" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c78aae07-1c35-466a-bfec-8182c8dc45bd" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f0d95871-e491-45d3-8607-c0bcb7c07907" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="71ef1f97-e90f-4d98-b685-8d06a2622b07" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="b5c6f9ef-997e-4ef1-ac0c-b785db529f66" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>NF Register Successes</body>
                            </command>
                            <nestedSteps>
                                <item guid="738f36fc-44d1-4800-ad63-c94c960d8b90" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;NF Register Successes&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="7f627794-a165-40a3-8b5d-8b6266c99ca0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3c4bbaad-b0d2-4004-8ac1-f7e1c08c46fb" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 5</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3535d9d5-863f-4d0c-950d-4ef3b325403e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="dfa9308b-fa10-47df-9f43-f0aa02129f08" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = nf_register_successes</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="118b0e75-f725-43b1-a0e1-93f6e5cefaca" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="197da142-f282-43e8-9f00-55d3cfeed92d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e84070ee-eec8-4197-ac29-7823b67a7c05" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="ab7da6c1-f4bb-4d29-bd34-f4aa86f54bf7" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="831ddb76-9557-44e7-aef1-fee2bf67a7ca" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="445e440c-7240-408e-86b0-165a7b7cc64c" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>NF Register Failures</body>
                            </command>
                            <nestedSteps>
                                <item guid="ac4cc74b-707e-4ea2-9c79-1499c94c58cf" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;NF Register Failures&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c1053dbb-a492-4377-a2ff-8b4bb16b07cb" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a980f899-497a-4b93-b229-cc0434f70978" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 0</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5131e696-a15d-4da6-ba5d-111efa064bd6" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="de5bd2e4-2b50-4995-a9a9-1fc62ad72cee" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = nf_register_failures</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0ae2c6c8-c2de-4395-aa07-d9790ebc5e83" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9bb8251a-131a-41c2-b90d-e89ab8987b29" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="8852f0af-9615-4e90-b5ad-6b5bf23a4dad" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3d104297-d7dd-420e-a3a0-60707804ea10" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c6eab129-c0ef-461f-a915-d48a56577659" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="cc30a942-3aca-4080-bdc8-0f765d377652" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>NF Discover Requests</body>
                            </command>
                            <nestedSteps>
                                <item guid="b6ac311b-0a5b-4f1b-942e-449ca50c6bd8" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;NF Discover Requests&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="634eafe4-0a2a-4d1b-8c1c-7dcc69a06dff" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f542d5d7-9f0d-41e4-889d-2e3d765ce5a1" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 5</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b0cbcc1e-7d17-4b5c-a8fc-6f7ea3d3ba6c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9f4ca7b9-f40a-472f-86e5-dd53d9dfbf0a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = nf_discover_requests</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9521b122-6b49-43ed-a470-208b2b77d6dd" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="74801cdd-73c3-45ca-8a9b-12df77b87bbe" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3ec3bf9b-87ed-4f37-bb83-8ff4e08c0666" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4e794a66-24d4-4094-b4f7-6d821cda8a55" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="28f8c3b1-620a-4901-ad74-b57ccfa525f6" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="67b25a49-ce7a-429f-b763-26006124b983" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>NF Discover Successes</body>
                            </command>
                            <nestedSteps>
                                <item guid="24b1c866-0ee7-4678-9010-e98c136fe9f0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;NF Discover Successes&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="bcf9dd84-de09-4061-90f9-d9587982ffe8" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="47c70bdc-363a-4f46-8759-202214ca9155" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 5</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="67171f53-9834-4d86-91e5-5a9d114f36d5" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="40109bd1-a59e-4d85-8330-0db08ef02678" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = nf_discover_successes</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0c96bbfa-6786-4292-ad84-9736f6a00805" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f83f2c99-bc31-4fd5-9959-d2965c934ec2" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="20b56719-dff7-4368-b16e-1d04fda1b83c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b862effd-e6d2-46be-9104-9a951ed4ee63" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="08942eef-7618-4557-b171-c4f5aec9458d" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="05839192-d0c7-4415-a373-3ee45ed7ea45" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>NF Discover Failures</body>
                            </command>
                            <nestedSteps>
                                <item guid="85d59c3d-8d05-44a9-a02b-16d6af1293af" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>key_tag = &quot;NF Discover Failures&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="137b171b-f4a0-488d-838d-83507874ff12" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>unit = &quot;&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="7d105186-db5e-4849-ae53-e2900a11c02f" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>expected = 0</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1da0597a-b9e3-489a-af7b-cce1aa5751ac" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>operation = &quot;=&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a719397d-d9c3-4990-a874-673e92c21620" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>actual = nf_discover_failures</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="533df77f-1dc8-4e55-839e-d616cb7f5d96" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>extracted_name = key_tag</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4911b908-799d-4734-ab44-6c790336e08a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_kpi = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1c457463-165e-4f15-8822-b79c4221d377" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4b1fe6ae-b43d-4430-ae91-3bf361c8cdb4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>validate = &quot;true&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="6fe42dc3-a6a8-490d-a099-592d300b36c7" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_and_add_to_KPI(kpi_name=key_tag, kpi_value=actual, kpi_expected=expected, add_to_kpi=add_to_kpi, kpi_response=response, kpi_unit=unit, operation=operation, add_to_extracted=add_to_extracted, validate=validate)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="2ffb2d0e-5682-4278-8e0d-09159cf7eded" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>CPU and Memory Utilization </body>
                            </command>
                            <nestedSteps>
                                <item guid="a2450d91-d0f7-47e6-95fc-0d40f02e479c" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>add_to_extracted = &quot;false&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="879eff83-7c8e-4290-898c-de7a287c6b09" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#validate_cpu_and_memory(is_b2b=is_b2b, kpi_response=response, add_to_extracted=add_to_extracted)</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>response</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="702ec694-0d53-4dac-acde-a68f6c196d73" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Show message if all criterias passed</body>
                            </command>
                            <nestedSteps>
                                <item guid="db6eda37-2570-420f-adb1-e64698bd3bc8" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>print(response)</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>result()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>value == &quot;PASS&quot;</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                    <message>All acceptance criteria PASSED</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTestIfPassing">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="cf056ea6-36e7-4213-86f6-b6300a503419" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Add Favorites to response</body>
                    </command>
                    <nestedSteps>
                        <item guid="ecc371f4-4bf1-4651-928c-22127a25ee07" action="add_favorites_to_KPIs" session="s1" useFieldsInCommand="false">
                            <command>
                                <body>(running_id=&apos;&apos;, favorites=measurement_favorites, response=response, skip_duplicate=&apos;false&apos;)</body>
                            </command>
                            <postProcessing>
                                <storeResponseAt>response</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="cccbadc8-44c6-4a30-9344-74628031b278" action="return">
                    <command>
                        <body>[response]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="measurement_favorites">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="running_id"/>
                <item name="measurement_info"/>
                <item name="is_b2b"/>
            </arguments>
        </item>
        <item name="extract_pcap" isPublic="true">
            <steps>
                <item guid="fb308003-1436-4125-ba59-edbcca2316da" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Valide Nodal pcaps</body>
                    </command>
                    <nestedSteps>
                        <item guid="c996a719-2930-4d2c-ba54-9e9594f50ae8" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>n1n2_phy = param(&apos;LS_Nodal_favorite_params/TS1/ts0/tc2/AmfNodeAddr/phy&apos;, &apos;eth2&apos;);print(n1n2_phy)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="636a860c-ec87-48ab-b2f7-7755fe89ce9d" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>n14_phy =param(&apos;LS_Nodal_favorite_params/TS1/ts0/tc2/AmfSbiNodeSrvAddr/phy&apos;, &apos;eth3&apos;); print(n14_phy)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5dc61880-a30e-4d4f-8914-35e43192d86d" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>amf_ip =param(&apos;LS_Nodal_favorite_params/TS1/ts0/tc2/AmfSbiNodeSrvAddr/ip&apos;, &apos;&apos;); print(amf_ip)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="0d3cc3d8-6bcf-4e36-a35f-4a592668d0c9" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>gnb_ip =param(&apos;LS_Nodal_favorite_params/TS1/ts0/tc1/MobGnbControlAddr/ip&apos;, &apos;&apos;); print(amf_ip)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f36b9a21-b792-4c18-b6f1-effe1d87f5fb" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>n1n2_pcap_exist = False</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="274452fc-e5e3-42fa-b85c-007657d83c35" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>n14_pcap_exist = False</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="49bda290-1692-462e-84f2-700fae612eec" action="for" useFieldsInCommand="false">
                            <command>
                                <body>i in range(0, len(nodal_pcaps)):</body>
                            </command>
                            <nestedSteps>
                                <item guid="49070aab-ad30-4446-adb6-6fbad3f5b38b" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>pcap_name = nodal_file_names[i]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d60ed79b-ead7-45ff-93ba-ad88d8b75864" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>pcap = nodal_pcaps[i]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="081b586b-efb6-4ed8-bb8b-c4a414d6535d" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>n14_phy in pcap_name:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="ebfc0cc7-a52f-4ac0-b5a8-1e04ddbd7dea" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>n14_pcap_exist = True</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="432af881-b2da-40ec-a4fb-72fced2201fc" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Validate Namf_Communication_CreateUEContext request message</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="eebce62a-8026-4fbc-9116-a9d7a0cdc303" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>tag_key = &quot;The Namf_Communication_CreateUEContext request message&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="a4856a9e-bbf2-48e6-9888-55c72fa0e2f5" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>print(pcap)</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>isEmpty</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="message">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                        <message>Analyzing data in pcap file: [pcap_name]</message>
                                                                        <tag sub="false" defaultValue=""/>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="840ddbe7-58bb-4600-82d2-a731f6776b5d" action="command" session="s4">
                                                    <command>
                                                        <body>query load &quot;[pcap]&quot;</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>responseLine()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &quot;done&quot;</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>Can&apos;t load [pcap]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="89a89fb3-c210-4ce5-8f2a-d3552aed276e" action="command" session="s4">
                                                    <command>
                                                        <body>query filter set &quot;http2 and http2.headers.method == \\&quot;PUT\\&quot; and http2.header.value matches \\&quot;/namf-comm/v1/ue-contexts/.*\\&quot; and ip.src == [amf_ip]&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="100aebf5-caa8-4585-b660-1d43fea178cb" action="command" session="s4">
                                                    <command>
                                                        <body>query packets</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>success()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &quot;true&quot;</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>&quot;[tag_key]&quot; does not exist in pcap file</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>rowCount()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>&quot;[tag_key]&quot; found &quot;{value}&quot; in pcap file. Expected: 1</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>messages/item/id</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>request_id</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <eventHandlers>
                                                        <item name="OnWiresharkCommandFailed">
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>id = &quot;&quot;</statement>
                                                                </actionProperties>
                                                            </item>
                                                        </item>
                                                    </eventHandlers>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="f5681907-363c-424e-8f1c-fa62b209561f" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>info(&apos;exists&apos;, &apos;local&apos;, &apos;request_id&apos;) and request_id:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="a94b0279-3990-4919-9fbc-c6012d17185f" action="command" session="s4">
                                                            <command>
                                                                <body>query details [request_id] pdml</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>success()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>value == &quot;true&quot;</expression>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>Cannot query packet [response_id]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>//field[@name=&apos;tcp.ack_raw&apos;]/@show</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>ack_request</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="76f3902b-9cbc-4906-a622-c45a46bdb22c" action="command" session="s4">
                                                            <command>
                                                                <body>query filter set &quot;tcp.ack_raw == [ack_request]&quot;</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="6bbb37fb-85a7-42f6-92f1-aa240a9c57d5" action="command" session="s4">
                                                            <command>
                                                                <body>query packets</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>rowCount()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>int(value) == 1</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>fraged = False</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>fraged = True</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <eventHandlers>
                                                                <item name="OnWiresharkCommandFailed">
                                                                    <item actionId="Eval">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                            <statement>id = &quot;&quot;</statement>
                                                                        </actionProperties>
                                                                    </item>
                                                                </item>
                                                            </eventHandlers>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="7d0499ce-c69f-49c2-8764-a87399240d3a" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>fraged:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="ffb49a75-63a7-445d-86e4-336f163ace32" action="command" session="s4">
                                                                    <command>
                                                                        <body>query filter set &quot;http2 and mime_multipart and json and tcp.ack_raw == [ack_request]&quot;</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="7aa75bd0-63b8-4aee-b69e-be2635f2ea66" action="command" session="s4">
                                                                    <command>
                                                                        <body>query packets</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>success()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == &quot;true&quot;</expression>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>&quot;[tag_key]&quot; does not exist in pcap file</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                            <item actionId="ExitProcedure">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="SkipRemainingRules">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>rowCount()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>int(value) == 1</expression>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>&quot;[tag_key]&quot; found &quot;{value}&quot; in pcap file. Expected: 1</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                            <item actionId="ExitProcedure">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>messages/item/id</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="store">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                        <storageLocation>request_id</storageLocation>
                                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <eventHandlers>
                                                                        <item name="OnWiresharkCommandFailed">
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>id = &quot;&quot;</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </item>
                                                                    </eventHandlers>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="2ca44535-d853-4d8f-bff9-a35b75ba67e8" action="command" session="s4">
                                                    <command>
                                                        <body>query details [request_id] pdml</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>success()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &quot;true&quot;</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                                    <message>1. Validate [tag_key]:</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>Cannot query packet [request_id]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>boolean(//field[@name=&apos;json.member&apos; and @show=&apos;ueSecurityCapability&apos;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &apos;true&apos;</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>    + The Target AMF under test receives the UE security capabilities used by the source AMF from the source AMF</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>    + The Target AMF under test NOT receives the UE security capabilities used by the source AMF from the source AMF</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>boolean(//field[@show=&apos;nasSecurityMode&apos;]//field[@show=&apos;integrityAlgorithm&apos;]/field[@name=&apos;json.value.string&apos;]/@show)</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value ==&apos;true&apos;</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>    + The Target AMF under test receives the NAS algorithms used by the source AMF</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>    + The Target AMF under test NOT receives the NAS algorithms used by the source AMF</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>//field[@show=&apos;nasSecurityMode&apos;]//field[@show=&apos;integrityAlgorithm&apos;]/field[@name=&apos;json.value.string&apos;]/@show</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>source_amf_integrity_algorithm</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="none">
                                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="message">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                        <message>    + The NAS algorithms used by the source AMF: &quot;[source_amf_integrity_algorithm]&quot;</message>
                                                                        <tag sub="false" defaultValue=""/>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="97b2310b-df32-41d2-9ff5-8a5be857f642" action="break" useFieldsInCommand="false">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="4f88961e-740b-40b1-be7a-010edca60dc1" action="for" useFieldsInCommand="false">
                            <command>
                                <body>i in range(0, len(nodal_pcaps)):</body>
                            </command>
                            <nestedSteps>
                                <item guid="11aff29d-19bf-4241-ab72-becf19885c15" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>pcap = nodal_pcaps[i]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="17ebe071-5329-4133-ae44-4b804fbb2bf0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>pcap_name = nodal_file_names[i]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="6e834cc0-a38e-4b1d-97be-db209887229d" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>n1n2_phy in pcap_name:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="e2f7ded1-d4ca-41e3-89ef-9d7fee78d912" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>n1n2_pcap_exist = True</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="2202d9a2-65a7-4be2-80ab-6ba3c411eb01" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Validate Handover Request message</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="0da8adb8-89fd-4c05-a8c9-2fe663d95cd5" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Add &quot;---&quot;</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="cfff7829-97d9-4214-9313-bee997e65fad" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string(length=&apos;55&apos;)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="75d7a238-5b6a-45ee-ad51-0728ac95811d" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>print(pcap)</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>isEmpty</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="message">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                        <message>Analyzing data in pcap file: [pcap_name]</message>
                                                                        <tag sub="false" defaultValue=""/>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="f2de16ef-7b84-4203-83d8-66f3eae52c14" action="command" session="s4">
                                                    <command>
                                                        <body>query load &quot;[pcap]&quot;</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>responseLine()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &quot;done&quot;</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>Can&apos;t load [pcap]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="ed6afaf3-4362-41bb-8255-c43bfc9b14ae" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Handover Request message</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="f76ef12b-5052-4dcf-8fc6-dd3d83e279c0" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>tag_key = &quot;Handover Request message&quot;</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="2f435461-ca22-4c79-bc29-b0ab23a285bd" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>emulated_ue_ip =param(&apos;LS_Nodal_favorite_params/TS1/ts0/tc0/MobGnbControlAddr/ip&apos;, &apos;&apos;)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="8ff8dc3e-59b2-4301-af31-3f1116d03cbf" action="command" session="s4">
                                                            <command>
                                                                <body>query filter set &quot;ngap.procedureCode == 13 and ip.dst == [gnb_ip]&quot;</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="40cb7e8a-aa65-455a-a0d1-b00cb7ac875a" action="command" session="s4">
                                                            <command>
                                                                <body>query packets</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>success()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>value == &quot;true&quot;</expression>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>&quot;[tag_key]&quot; does not exist in pcap file</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="SkipRemainingRules">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>messages/item/id</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>handover_request_id</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <eventHandlers>
                                                                <item name="OnWiresharkCommandFailed">
                                                                    <item actionId="Eval">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                            <statement>id = &quot;&quot;</statement>
                                                                        </actionProperties>
                                                                    </item>
                                                                </item>
                                                            </eventHandlers>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="4b24eefd-8ac5-495a-bf42-366c450394d6" action="command" session="s4">
                                                            <command>
                                                                <body>query details [handover_request_id] pdml</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>success()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>value == &quot;true&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                                            <message>2. Validate [tag_key]:</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>Cannot query packet [request_id]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="SkipRemainingRules">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>boolean(//field[contains(@show,&apos;id-NASC&apos;)]//field[@name=&apos;ngap.NAS_PDU&apos;]/field[@name=&apos;nas_5gs.mm.nas_sec_algo_ip&apos;]/@showname)</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>value == &quot;true&quot;</expression>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>Cannot find the target AMF Integrity Algorithm in [tag_key]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="SkipRemainingRules">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>//field[contains(@show,&apos;id-NASC&apos;)]//field[@name=&apos;ngap.NAS_PDU&apos;]/field[@name=&apos;nas_5gs.mm.nas_sec_algo_ip&apos;]/@showname</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>target_amf_integrity_algorithm</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>//field[contains(@show,&apos;id-NASC&apos;)]//field[@name=&apos;ngap.NAS_PDU&apos;]/field[@name=&apos;nas_5gs.mm.nas_sec_algo_ip&apos;]/@value</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>type_of_target_amf_integrity_algorithm</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>boolean(//field[contains(@show,&apos;id-UESecurityCapabilities&apos;)]//field[@name=&apos;ngap.nRintegrityProtectionAlgorithms&apos;]/field/@showname)</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>value == &quot;true&quot;</expression>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>Cannot find the Target UE Security Capabilities in [tag_key]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="SkipRemainingRules">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>//field[contains(@show,&apos;id-UESecurityCapabilities&apos;)]//field[@name=&apos;ngap.nRintegrityProtectionAlgorithms&apos;]/field/@showname</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>target_ue_security_capabilities</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="f032c9e4-b251-44f0-8e81-fe9b68b205ac" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Extract integrity protection algorithm name</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="f9c1aa8a-fa67-445b-abb5-4d1094dbeb7a" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>import re</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="0115d81c-e0a6-4ae6-8528-0865e8bed8fe" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>m = re.search(&quot;.*=\\\\sType of integrity protection algorithm:\\\\s(\\\\d*-?5G-IA\\\\d+)\\\\s.*&quot;, target_amf_integrity_algorithm)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="861d381a-bee8-4560-8e17-41cd6e49ba60" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>not m:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="ee920b61-1c9d-4775-bbe4-c7632bd4ac2e" action="message" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>Warning:     Type of integrity protection algorithm does not exist in NAS integrity algorithm</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <analysisRules>
                                                                                    <item>
                                                                                        <extractorInfo extractorType="none">
                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                        </extractorInfo>
                                                                                        <processorInfo ruleType="assert">
                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                <expression>True</expression>
                                                                                                <actionsWhenTrue>
                                                                                                    <item actionId="FailTest">
                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                    </item>
                                                                                                    <item actionId="ExitProcedure">
                                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                                    </item>
                                                                                                </actionsWhenTrue>
                                                                                            </ruleProperties>
                                                                                        </processorInfo>
                                                                                    </item>
                                                                                </analysisRules>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                <severity inherit="false">Warning</severity>
                                                                                <message inherit="false">     Type of integrity protection algorithm does not exist in NAS integrity algorithm</message>
                                                                            </applicationProperties>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="06873401-475b-4f4c-b1b8-358477de47e0" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>actual_ipa_name = m.group(1);print(actual_ipa_name)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="095b220c-2444-4c35-839f-06bb9da5237e" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Verify the Integrity Algorithm selected by the target AMF is different from the one used by source AMF</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="5a4b5357-f244-41c3-adc6-dd4c242cfdc3" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>actual_ipa_name:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="f012a236-d432-4999-af6f-32b45b52dc5e" action="comment" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>Validate</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <analysisRules>
                                                                                    <item>
                                                                                        <extractorInfo extractorType="none">
                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                        </extractorInfo>
                                                                                        <processorInfo ruleType="assert">
                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                <expression>not actual_ipa_name[-3:] in source_amf_integrity_algorithm</expression>
                                                                                                <actionsWhenTrue>
                                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                            <message>    + The Integrity Algorithm selected by the target AMF: [actual_ipa_name] is different from the one used by source AMF: [source_amf_integrity_algorithm]</message>
                                                                                                        </actionProperties>
                                                                                                    </item>
                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                    </item>
                                                                                                </actionsWhenTrue>
                                                                                                <actionsWhenFalse>
                                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Warning">
                                                                                                            <message>    + The Integrity Algorithm selected by the target AMF: [actual_ipa_name] is NOT different from the one used by source AMF: [source_amf_integrity_algorithm]</message>
                                                                                                        </actionProperties>
                                                                                                    </item>
                                                                                                    <item actionId="FailTest">
                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                    </item>
                                                                                                    <item actionId="ExitProcedure">
                                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                                    </item>
                                                                                                </actionsWhenFalse>
                                                                                            </ruleProperties>
                                                                                        </processorInfo>
                                                                                    </item>
                                                                                </analysisRules>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="b0e00f11-6e07-46fe-a13c-6bd82497afcf" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Check if the selected integrity algorithm has the highest priority according to the list of ordered NAS integrity algorithm</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="99070534-ee0e-4ab8-a471-50895c644adc" action="comment" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Some actual_ipa_name values: 5G-IA0, 128-5G-IA2</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="36ddb147-05ad-47c2-9391-9624a784d25b" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>nia_param_from_the_actual = param(&quot;{0}/NIA{1}&quot;.format(ipa_prefix_param_path, int(type_of_target_amf_integrity_algorithm)), 0);print(nia_param_from_the_actual)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="df424893-37e9-4240-9cb8-a1c1c87e058d" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>split_items = target_amf_integrity_algorithm.split(&quot;=&quot;)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="3dceafe7-97e4-44b6-af23-3ae03fb255e9" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>len(split_items) &gt; 1:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="d30a8d56-c0ff-4870-b117-1e33d0f4afa3" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>showname_ipa = split_items[1].strip()</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="39d16331-adce-4b5b-8365-71d526445329" action="else" useFieldsInCommand="false">
                                                                    <nestedSteps>
                                                                        <item guid="500540a9-f037-42c3-b25e-2bf34b3d87f8" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>showname_ipa = split_items[0].strip()</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="d29e6d0b-d054-4c93-9e24-c3f4e680c442" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>msg = &quot;&quot;</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="38a235c5-97ab-462e-b70d-513097389af3" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>actual_ipa = showname_ipa.split(&apos;:&apos;)[1] if len(showname_ipa.split(&apos;:&apos;))&gt;1 else showname_ipa.split(&apos;:&apos;)[0]</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="7047f8a7-b607-4374-9cd3-5e99dee0883c" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>is_b2b == &quot;true&quot;:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="51743493-33a2-42e5-a670-5e64b827a5bc" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>cfg_ipa = param(&quot;LS_Emulated_SUT_favorite_params/ts0/tc0/AmfNas5gMmIntegrityAlgorithm&quot;, 1)</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="d0780f7a-4cfa-4648-99db-7f45b5b4f069" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>msg = &quot;Actual: {0} ({1}), Expected: {2} (NIA{2})&quot;.format(type_of_target_amf_integrity_algorithm, actual_ipa_name, cfg_ipa)</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="f5f44f36-c3f0-403c-bca7-dfa89a2d6cd9" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>has_passed = int(cfg_ipa) == int(type_of_target_amf_integrity_algorithm)</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="c5b1de11-af1f-4ac1-b1cf-05e79871e69f" action="if" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>has_passed and (nia_param_from_the_actual == &quot;&quot; or int(nia_param_from_the_actual) == 0):</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="99558a3f-bd8d-4807-b579-a7898a905fb4" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>msg = f&quot;{showname_ipa} is NOT used/expected in Priority Order&quot;</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="0d823616-3f42-4b55-8510-7bfa8c80bd4c" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>has_passed = False</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="ec07ef8a-43f0-4b05-8b7a-4236531fede0" action="else" useFieldsInCommand="false">
                                                                    <nestedSteps>
                                                                        <item guid="48841f21-d0a6-4438-93d5-cda4f8c48d68" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>has_passed = nia_param_from_the_actual != &quot;&quot; and int(nia_param_from_the_actual) == 1</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="0d130bb0-1a68-4ea1-8d6e-d8826b79579c" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>msg = &quot;Actual: {0} ({1}), Expected: {2} ({3})&quot;.format(type_of_target_amf_integrity_algorithm, actual_ipa_name, highest_priority_nia[3:], highest_priority_nia)</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="c995e4cc-5d52-4515-b19c-18480868810e" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>has_passed:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="c27a65b0-aad4-4119-9a9d-4b22ec1d4630" action="message" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>OK:    + The selected integrity algorithm has the highest priority according to the list of ordered NAS integrity algorithm. [msg]</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                <severity inherit="false">OK</severity>
                                                                                <message inherit="false">    + The selected integrity algorithm has the highest priority according to the list of ordered NAS integrity algorithm. [msg]</message>
                                                                            </applicationProperties>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="49a29ce8-34d3-4e12-a9be-8f2a9b8ff745" action="else" useFieldsInCommand="false">
                                                                    <nestedSteps>
                                                                        <item guid="2ee1b53e-cd68-43c3-9bfe-cbabba8fd378" action="message" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>Warning:    + The selected integrity algorithm is NOT the highest priority according to the list of ordered NAS integrity algorithm. [msg]</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <analysisRules>
                                                                                    <item>
                                                                                        <extractorInfo extractorType="none">
                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                        </extractorInfo>
                                                                                        <processorInfo ruleType="assert">
                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                <expression>True</expression>
                                                                                                <actionsWhenTrue>
                                                                                                    <item actionId="FailTest">
                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                    </item>
                                                                                                    <item actionId="ExitProcedure">
                                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                                    </item>
                                                                                                </actionsWhenTrue>
                                                                                            </ruleProperties>
                                                                                        </processorInfo>
                                                                                    </item>
                                                                                </analysisRules>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                <severity inherit="false">Warning</severity>
                                                                                <message inherit="false">    + The selected integrity algorithm is NOT the highest priority according to the list of ordered NAS integrity algorithm. [msg]</message>
                                                                            </applicationProperties>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="398ec145-7d75-4743-864c-d5489a0d4940" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Print UE security capability from Handover Request message and Check contained</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="fb5e9d39-4b2c-4096-9aa4-6d427fec32de" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Information:    + UE security capabilities in [tag_key]:</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <message inherit="false">    + UE security capabilities in [tag_key]:</message>
                                                                    </applicationProperties>
                                                                </item>
                                                                <item guid="e98e939a-f21d-4095-9121-5a9a236056ad" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>contained_integrity_algorithm = False</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="da157181-0b02-48b6-8f22-6983e182e384" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>pattern = re.compile(&quot;.*=\\\\s(.*):\\\\s(Supported|Not supported)&quot;)</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="66c10f68-28d4-41f4-b8d2-ec1a929d4cfb" action="for" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>i in range(0, len(target_ue_security_capabilities)):</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="c2a9e9b9-d2b2-4fc7-ad5f-04132005a9b7" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>split_items = target_ue_security_capabilities[i].split(&quot;=&quot;)</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="35067ca8-7ae0-43be-a42b-50ee9273f6e0" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>showname = split_items[0] if len(split_items) == 1 else split_items[1]</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="b696ffc0-06e5-46ee-9dc9-b788dd257888" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>msg = &quot; &quot; * 8 + showname.strip()</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="c8ab9c67-8f77-4f0f-a2b4-2aa031da7c33" action="message" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>Information:[msg]</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                <message inherit="false">[msg]</message>
                                                                            </applicationProperties>
                                                                        </item>
                                                                        <item guid="ce4329c2-bfcc-42fe-90ad-8bb1f863e8b1" action="comment" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>Check if the selected integrity algorithm are also contained in the UE security capabilities</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="974190fc-0d2c-4c93-8a7c-70ed0087d429" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>actual_ipa_name:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="64ab6b3d-f84e-4343-866b-bf753fe0896d" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>m = pattern.match(target_ue_security_capabilities[i])</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                        <item guid="bf6b9d3f-3f67-4d4a-a78a-489af7fa0173" action="if" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>(&apos;IA0&apos; in actual_ipa_name and &apos;Reserved: 0x0000&apos; in target_ue_security_capabilities[i]) or (m and actual_ipa_name[-3:] == str(m.group(1))[-3:]):</body>
                                                                                            </command>
                                                                                            <nestedSteps>
                                                                                                <item guid="314142c9-cbbd-41f2-bdef-7511d2343b7a" action="eval" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>contained_integrity_algorithm = True</body>
                                                                                                    </command>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                            </nestedSteps>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="b9d290fd-d893-4bf8-9a7f-c57640c37f30" action="if" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>contained_integrity_algorithm:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="ff6cdf92-ce15-475a-9513-9ed173539ae7" action="message" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>OK:    + The integrity algorithm selected by the Target AMF: &quot;[actual_ipa_name]&quot; is contained in the UE security capabilities</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                <severity inherit="false">OK</severity>
                                                                                <message inherit="false">    + The integrity algorithm selected by the Target AMF: &quot;[actual_ipa_name]&quot; is contained in the UE security capabilities</message>
                                                                            </applicationProperties>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="de820003-f447-41be-a25b-6dd419668aab" action="else" useFieldsInCommand="false">
                                                                    <nestedSteps>
                                                                        <item guid="b9972803-2cdd-44d6-b7a8-6b8b58d48c91" action="message" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>Warning:    + The integrity algorithm selected by the Target AMF: &quot;[actual_ipa_name]&quot; is NOT contained in the UE security capabilities</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <analysisRules>
                                                                                    <item>
                                                                                        <extractorInfo extractorType="none">
                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                        </extractorInfo>
                                                                                        <processorInfo ruleType="assert">
                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                <expression>True</expression>
                                                                                                <actionsWhenTrue>
                                                                                                    <item actionId="FailTest">
                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                    </item>
                                                                                                </actionsWhenTrue>
                                                                                            </ruleProperties>
                                                                                        </processorInfo>
                                                                                    </item>
                                                                                </analysisRules>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                <severity inherit="false">Warning</severity>
                                                                                <message inherit="false">    + The integrity algorithm selected by the Target AMF: &quot;[actual_ipa_name]&quot; is NOT contained in the UE security capabilities</message>
                                                                            </applicationProperties>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="90fce35c-dd92-4b2b-bcb9-c9adadd007b1" action="break" useFieldsInCommand="false">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="42b64094-e8e3-488a-9f4c-e0659db6f704" action="if" useFieldsInCommand="false">
                            <command>
                                <body>not n1n2_pcap_exist:</body>
                            </command>
                            <nestedSteps>
                                <item guid="539148c9-c5ca-48f2-8645-26c3c2260482" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Error: Cannot find pcap file for [n1n2_phy]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="none">
                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>False</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <severity inherit="false">Error</severity>
                                        <message inherit="false"> Cannot find pcap file for [n1n2_phy]</message>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="cf06fc27-4708-4e8b-8c83-2a325bd637bf" action="if" useFieldsInCommand="false">
                            <command>
                                <body>not n14_pcap_exist:</body>
                            </command>
                            <nestedSteps>
                                <item guid="daae4616-46ee-40e1-b803-6f3743400355" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Error: Cannot find pcap file for [n14_phy]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="none">
                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>False</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <severity inherit="false">Error</severity>
                                        <message inherit="false"> Cannot find pcap file for [n14_phy]</message>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="nodal_pcaps">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="sut_pcaps"/>
                <item name="nodal_file_names">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="sut_file_names"/>
                <item name="standard_time"/>
                <item name="is_b2b"/>
                <item name="ipa_prefix_param_path"/>
                <item name="highest_priority_nia"/>
            </arguments>
            <response>{}</response>
        </item>
        <item name="validate_order_in_ipa_param" isPublic="true">
            <steps>
                <item guid="e34c4ef3-31f3-482e-90c4-0b35ca847f11" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>list_of_nia = {}</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="22d5c893-3143-4559-a224-ec08a314c27d" action="for" useFieldsInCommand="false">
                    <command>
                        <body>i in range(0, 4):</body>
                    </command>
                    <nestedSteps>
                        <item guid="8ef6d1cc-cd67-4cc7-96f3-6043d1153f9a" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>nia = param(f&quot;{prefix_path}/NIA{i}&quot;, 0)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6de63d33-ae97-4564-8b4b-bc6f095ddf23" action="if" useFieldsInCommand="false">
                            <command>
                                <body>nia and int(nia) &gt; 0:</body>
                            </command>
                            <nestedSteps>
                                <item guid="e158dd76-cdf0-478e-9864-e2c4579a1023" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>list_of_nia[f&quot;NIA{i}&quot;] = nia</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2d735eaa-0d36-4c26-b320-1712248b9a76" action="if" useFieldsInCommand="false">
                    <command>
                        <body>not list_of_nia:</body>
                    </command>
                    <nestedSteps>
                        <item guid="14fd1ad0-7178-44bb-b19a-034a925fba2c" action="message" useFieldsInCommand="false">
                            <command>
                                <body>Error:Priority order of the integrity protection algorithms is NOT found</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="none">
                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>False</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="ExitExecution">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                <severity inherit="false">Error</severity>
                                <message inherit="false">Priority order of the integrity protection algorithms is NOT found</message>
                            </applicationProperties>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="0c331e13-b433-46c8-aaa7-216abbc2ed57" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Determine if the input param is strictly increasing</body>
                    </command>
                    <nestedSteps>
                        <item guid="da2139cf-35c1-4fc7-a9a5-25428a55b6c7" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>order = 1</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ed24b5f0-7cb0-4b06-a92f-a6204012b87d" action="for" useFieldsInCommand="false">
                            <command>
                                <body>i in range(0, len(list_of_nia)):</body>
                            </command>
                            <nestedSteps>
                                <item guid="4dbf34fc-1955-463e-bbc3-bc5f5e667f29" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>order not in list_of_nia.values():</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="d5a964cf-622b-4c5f-a11b-3314ca17a27a" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Error:Priority order of the integrity protection algorithms must be numbered sequentially</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="none">
                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>False</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitExecution">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <severity inherit="false">Error</severity>
                                                <message inherit="false">Priority order of the integrity protection algorithms must be numbered sequentially</message>
                                            </applicationProperties>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="dc842ce0-de56-4918-a1a1-2b31ccb663f2" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>order += 1</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d24fef93-2ac8-4862-8727-a79a36744adc" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>highest_priority_nia = [key for key, value in list_of_nia.items() if value == 1][0]</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="057fea6b-cbe1-49c1-8dcc-3e0493f5b14e" action="return">
                    <command>
                        <body>[highest_priority_nia]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="prefix_path"/>
            </arguments>
        </item>
    </procedures>
</testCase>
