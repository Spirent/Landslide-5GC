<?xml version="1.0"?>
<testCase version="8.4.0.202011220004" entryPoint="extract_kpis">
    <general>
        <isProcedureLibrary>true</isProcedureLibrary>
        <language>Python</language>
    </general>
    <procedures>
        <item name="extract_kpis" isPublic="true">
            <steps>
                <item guid="1ebbb9e7-b0ee-4b59-81a6-3486575b2ee3" action="open" session="s4">
                    <command>
                        <body>application:com.fnfr.svt.applications.wireshark</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.OpenStepPropertyGroup">
                        <stepProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        <sessionProperties type="com.fnfr.svt.applications.wireshark.WiresharkSessionProperties">
                            <advancedDisplayOptions inherit="false">-o nas-5gs.null_decipher:TRUE</advancedDisplayOptions>
                            <sessionbuilderInitializeAction type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </sessionProperties>
                        <sessionClass type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        <sessionVersion type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                    </applicationProperties>
                </item>
                <item guid="20d01de5-8374-4830-b720-42680db235df" action="if" useFieldsInCommand="false">
                    <command>
                        <body>len(path_to_pcap) &lt; 2:</body>
                    </command>
                    <nestedSteps>
                        <item guid="51297ba6-d47b-424a-a58f-a48c84584027" action="call" useFieldsInCommand="false">
                            <command>
                                <body>execute_fail_message -message &quot;Lack of pcap required files&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="480d61a2-500e-4f5f-a0bc-7dea94d60996" action="return">
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="abada854-29e5-4811-b846-5b7fabc14a72" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Find appropriate pcap file for each interface</body>
                    </command>
                    <nestedSteps>
                        <item guid="6c8397d1-e2b8-46cd-9ce8-3a3373fbc76c" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>found_ngap = False</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c75e43fe-bf90-4aac-b1eb-ac802e75587c" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>found_http2 = False</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ab9e5328-8b28-46c7-bb12-57f77bee4db9" action="for" useFieldsInCommand="false">
                            <command>
                                <body>i in range(0, len(path_to_pcap)):</body>
                            </command>
                            <nestedSteps>
                                <item guid="c4218257-8bbc-416d-a520-e382cc2069dd" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>pcap = path_to_pcap[i]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4ab190b1-a51d-409f-9455-6a5061a70221" action="command" session="s4">
                                    <command>
                                        <body>query load &quot;[pcap]&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="51319a75-8fc0-458b-a0ce-aac13962c8a0" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not found_ngap:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="1cf68527-7023-4ec6-8423-3428cdedd748" action="command" session="s4">
                                            <command>
                                                <body>query filter set ngap</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="3473cbef-120a-4c96-a1e0-3fa8778c9695" action="command" session="s4">
                                            <command>
                                                <body>query packets</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>Invalid row value</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="Eval">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                            <statement>count = 0</statement>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>rowCount()</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>count</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <eventHandlers>
                                                <item name="OnWiresharkCommandFailed"/>
                                            </eventHandlers>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="9130e866-1ddd-4a3a-8064-c4553637b5a8" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>int(count) &gt; 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="d9890160-4aec-4c3c-b2b5-fd906d4e26c9" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>n1_n2_pcap = pcap</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="528ad56a-32fc-4246-8fd5-1ee6f6c80a21" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>found_ngap = True</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="568ca232-6f75-4048-bf2b-c1d82f93645a" action="continue" useFieldsInCommand="false">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d2a0c2e9-c035-49d5-9219-9cbc492853fc" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not found_http2:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="4e3e718a-a5a5-4880-bdfb-67e49468edce" action="command" session="s4">
                                            <command>
                                                <body>query filter set http2</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b56d10b8-4594-4d0c-861b-e130d1ced74e" action="command" session="s4">
                                            <command>
                                                <body>query packets</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>Invalid row value</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="Eval">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                            <statement>count = 0</statement>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>rowCount()</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>count</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <eventHandlers>
                                                <item name="OnWiresharkCommandFailed"/>
                                            </eventHandlers>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ac061bc5-2478-4d89-8273-96249e537524" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>int(count) &gt; 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="8ae4e94f-bab0-4b19-8579-96aca3290a82" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>nausf_nudm_pcap = pcap</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="94423289-31aa-4a06-9dcd-89a19185228f" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>found_http2 = True</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="6e9949fb-df01-4f19-ba87-e0283bf20e1b" action="continue" useFieldsInCommand="false">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="d9adab40-266d-47dc-83db-aa6e91399f77" action="if" useFieldsInCommand="false">
                            <command>
                                <body>not found_ngap:</body>
                            </command>
                            <nestedSteps>
                                <item guid="765e835e-17d9-486f-9c22-16a0b3d38cb0" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Error:Not found pcap file for N1/N2 Interface</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <severity inherit="false">Error</severity>
                                        <message inherit="false">Not found pcap file for N1/N2 Interface</message>
                                    </applicationProperties>
                                </item>
                                <item guid="d7b2c2be-502b-475d-a0ff-e2c77f25dc6e" action="return">
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="87ca2223-bbbd-4c9d-b957-706429e82288" action="if" useFieldsInCommand="false">
                            <command>
                                <body>not found_http2:</body>
                            </command>
                            <nestedSteps>
                                <item guid="191d9ddb-8fc2-4aa5-87b9-6c3cb4690507" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Error:Not found pcap file for NAUSF/NUDM Interface</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <severity inherit="false">Error</severity>
                                        <message inherit="false">Not found pcap file for NAUSF/NUDM Interface</message>
                                    </applicationProperties>
                                </item>
                                <item guid="382c7726-f6a1-4e25-a39b-7c0cdcedee1e" action="return">
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="28a6b4c3-4723-4005-808b-a6ccd79901f5" action="call" useFieldsInCommand="false">
                    <command>
                        <body>verify_n1_n2_interface -n1_n2_pcap [n1_n2_pcap]</body>
                    </command>
                    <postProcessing>
                        <storeResponseAt>response</storeResponseAt>
                        <storeResponseText>true</storeResponseText>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="9c222e0f-adcc-4723-ac7d-27d59b6fbf28" action="if" useFieldsInCommand="false">
                    <command>
                        <body>response == &quot;true&quot;:</body>
                    </command>
                    <nestedSteps>
                        <item guid="a6fa9498-62f6-46a6-bd20-f6348c9f274b" action="call" useFieldsInCommand="false">
                            <command>
                                <body>verify_nausf_nudm_interface -pcap_file [nausf_nudm_pcap]</body>
                            </command>
                            <postProcessing>
                                <storeResponseAt>response</storeResponseAt>
                                <storeResponseText>true</storeResponseText>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="cdbb0db0-3306-4c42-a0a6-7c9f4fbca1b5" action="if" useFieldsInCommand="false">
                            <command>
                                <body>response == &quot;true&quot;:</body>
                            </command>
                            <nestedSteps>
                                <item guid="5bb632ca-08b1-4f9c-8927-9de022847190" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Validate message counters in KPIs</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="185ec355-4c4c-4684-af96-c79fe5e7e659" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 135</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="5db8737c-819e-43c3-b1c2-0c4d14b9f57b" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:Validate message counters in KPIs</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">Validate message counters in KPIs</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="5aeaec4c-686a-473c-a48a-9a5cfecf120f" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>print(measurements)</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/NGAP/Initial_Context_Setup_Requests</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    initial Context Setup Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    initial Context Setup Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/MM/Authentication_Requests</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    Authentication Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    Authentication Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/MM/Security_Mode_Commands</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    Security Mode Commands: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    Security Mode Commands: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/MM/Registration_Accepts</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    Registration Accepts: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    Registration Accepts: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/AUSF_Producer/Create_UE_Authentication_Context_Requests</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    Create UE Authentication Context Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    Create UE Authentication Context Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/AUSF_Producer/x5G_Aka_Confirm</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    5G Aka Confirm: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    5G Aka Confirm: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/UDM_Producer/AMF_Registration_for_3GPP_Access_Requests</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    AMF Registration for 3GPP Access Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    AMF Registration for 3GPP Access Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/UDM_Producer/Multi-Data_Sets_Retrieval_Requests</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    Multi-Data Sets Retrieval Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    Multi-Data Sets Retrieval Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>mapped/Json/tabs/UDM_Producer/SDM_Subscribe_Requests</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    SDM Subscribe Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>    SDM Subscribe Requests: Expected 1, Actual [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5c72513f-0eb0-444d-acd9-d5ca9b23c693" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 135</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="50218149-7371-4c35-9123-c3d17e449bad" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:KPIs and Extracted Data:</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">KPIs and Extracted Data:</message>
                                    </applicationProperties>
                                </item>
                                <item guid="78ef20b8-ba7b-42ca-a3ad-121b1a6bc98c" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>extract_from_mesurements -measurements [measurements]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="13585fdd-09ae-4ecc-8777-c5e7bfd08d89" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Extract Average Registration Time</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="15cfddf2-5e9f-4258-bdc0-ba4790bf5519" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>average_registration_time = float(gget(&apos;average_registration_time&apos;, 0.0))</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ce2d573b-e266-4ba4-866d-890c23d7903c" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>default_time = 500</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="d6ee8d07-5603-451b-90b8-d9fef785d0db" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>average_registration_time &lt;= default_time:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="a7a49b30-e6c3-404b-a38b-81d05ef129c7" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>print(round(average_registration_time, 5))</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>group1()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="message">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                        <message>    Average Session Register Time: Expected &lt;= [default_time] ms, Actual {value} ms</message>
                                                                        <extractData>true</extractData>
                                                                        <tag sub="false">Average_Session_Register_Time</tag>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="f9e87d33-10c6-4786-9a86-f29476cc28df" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="628f2c20-7b76-42d7-85b7-d1a0057e5249" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>print(round(average_registration_time, 5))</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>group1()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="message">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup">
                                                                        <message>    Average Session Register Time: Expected &lt;= [default_time] ms, Actual {value} ms</message>
                                                                        <extractData>true</extractData>
                                                                        <tag sub="false">Average_Session_Register_Time</tag>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="none">
                                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>False</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="1c01be1b-a580-44f1-b56c-25db45090ce0" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>CPU and Memory Utilization </body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="26c124cf-768a-47c7-82f5-aca6dc496211" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>project://ai_LS_5G/utility_library/utils.fftc#get_SUT_cpu_memory_utilization(is_b2b=is_b2b)</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(mapped/Json/item)</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 0</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>Cannot get SUT CPU and Memory Utilization.</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="Eval">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                            <statement>sut_exists = True</statement>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(mapped/Json/item)</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>sut_count</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                                <storeResponseAt>sut_xml</storeResponseAt>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="14b478c3-d1f0-4faa-bd3b-392862652011" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>sut_i in range(1, int(sut_count) + 1):</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="4653d607-456a-4a20-b30b-38b51e75cf30" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>query_path = &apos;mapped/Json/item[{0}]/name&apos;.format(sut_i)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="d36da6ff-afba-4870-902e-ed15fca14c9c" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>sut_name = query(&apos;sut_xml&apos;,query_path);print(sut_name)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="1be513e6-8488-4f0b-8ec7-4a042e5f2e90" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>sut_name:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="b2325422-9d5c-4093-bf92-ccf7bc47586b" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>query_path = &apos;mapped/Json/item[{0}]/cpu_utilization&apos;.format(sut_i)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="8a48615d-b5a7-4414-8ae6-79c7132754c1" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>cpu_utilization = query(&apos;sut_xml&apos;,query_path);print(cpu_utilization)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="4cf2fdbc-7a1e-4a72-9361-4dac357f17ea" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>query_path = &apos;mapped/Json/item[{0}]/memory_utilization&apos;.format(sut_i)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="c39f4441-d8ce-4cf2-8ada-2e69081a3b0b" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>memory_utilization = query(&apos;sut_xml&apos;,query_path);print(memory_utilization)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="4124074e-030c-4951-9bec-1c3c4ffa9c8a" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>not cpu_utilization and not memory_utilization:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="80bd6842-df43-46c6-8452-2f7953e00bd2" action="continue" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Insert steps here for when expression is true</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="055c6968-959e-4064-a378-94d0d1b1643d" action="message" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Information:[sut_name]:</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                <message inherit="false">[sut_name]:</message>
                                                            </applicationProperties>
                                                        </item>
                                                        <item guid="ffc750f4-2d35-4d50-8c23-d08cd8819e96" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>not cpu_utilization or float(cpu_utilization) &gt;= 45:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="ef6af5b0-cd0a-40d4-8549-e1d857472afc" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Error:   + CPU utilization: Expected less than 45%, actual [cpu_utilization]%</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>isEmpty()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == &quot;true&quot;</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <severity inherit="false">Error</severity>
                                                                        <message inherit="false">   + CPU utilization: Expected less than 45%, actual [cpu_utilization]%</message>
                                                                    </applicationProperties>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="c3093c4b-6701-4c55-afd2-1775fc2085f1" action="else" useFieldsInCommand="false">
                                                            <nestedSteps>
                                                                <item guid="c21f2bc0-34ae-43bb-80f5-e9d487fbb7d3" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Information:   + CPU utilization: Expected less than 45%, actual [cpu_utilization]%</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <severity inherit="false" defaultValue=""/>
                                                                        <message inherit="false">   + CPU utilization: Expected less than 45%, actual [cpu_utilization]%</message>
                                                                    </applicationProperties>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="2509b63e-8d79-47b5-8b53-0a4792332bbc" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>not memory_utilization or float(memory_utilization) &gt;= 20:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="87187967-d009-4939-8ff8-dba9df0aac88" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Error:   + Memory Utilization: Expected less than 20%, actual [memory_utilization]%</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>isEmpty()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == &quot;true&quot;</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <severity inherit="false">Error</severity>
                                                                        <message inherit="false">   + Memory Utilization: Expected less than 20%, actual [memory_utilization]%</message>
                                                                    </applicationProperties>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="35e6efbd-bcb4-4e61-bb37-b3627e2b3b6e" action="else" useFieldsInCommand="false">
                                                            <nestedSteps>
                                                                <item guid="d72d6bff-dc03-440c-921c-c1f65f60fe80" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Information:   + Memory Utilization: Expected less than 20%, actual [memory_utilization]%</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <severity inherit="false" defaultValue=""/>
                                                                        <message inherit="false">   + Memory Utilization: Expected less than 20%, actual [memory_utilization]%</message>
                                                                    </applicationProperties>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="7b495a1c-7adb-464b-b6a8-7bd3d414d2d9" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>query_path = &apos;mapped/Json/item[{0}]/make&apos;.format(sut_i)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="3b59e349-40bb-441a-a392-9dcdfaa0c478" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>make = query(&apos;sut_xml&apos;,query_path);print(make)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="a162146f-daca-492e-9055-30637e433325" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>query_path = &apos;mapped/Json/item[{0}]/model&apos;.format(sut_i)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="45eb878d-989d-471b-9f87-972ea4b09459" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>model = query(&apos;sut_xml&apos;,query_path);print(model)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="7406b52b-9749-4206-92f8-9e4131aa46d6" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>model:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="ef1661d3-86be-4407-8ec0-638d19d68cd2" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>print(model)</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>responseLine()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="message">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                                        <message>[sut_name].Model: [model]</message>
                                                                                        <extractData>true</extractData>
                                                                                        <tag>[sut_name].Model</tag>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="e764d5ae-041d-4196-a1b6-b3e02eccda06" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>make:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="46504e59-d562-4de2-9e6f-cab2da1612f8" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>print(make)</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>responseLine()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="message">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                                                                        <message>[sut_name].Make: [make]</message>
                                                                                        <extractData>true</extractData>
                                                                                        <tag>[sut_name].Make</tag>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="0f34ad9c-ec5c-4e6b-b8dc-8ec3d9b7f605" action="close" session="s4">
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="measurements">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="is_b2b">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="path_to_pcap">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="standard_time"/>
            </arguments>
        </item>
        <item name="verify_n1_n2_interface" isPublic="true">
            <steps>
                <item guid="4af5fd9b-65e5-4c00-b97a-446bde7fef99" action="command" session="s4">
                    <command>
                        <body>query load &quot;[n1_n2_pcap]&quot;</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="721d4ee4-be34-4559-8e90-04af7c3613e1" action="message" useFieldsInCommand="false">
                    <command>
                        <body>Information:Validate N1/N2 Interface by message sequence</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                        <message inherit="false">Validate N1/N2 Interface by message sequence</message>
                    </applicationProperties>
                </item>
                <item guid="2757716f-5546-4c32-9b6c-e475e6b9cf9d" action="call" useFieldsInCommand="false">
                    <command>
                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 135</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="663b2b4f-f43b-4919-913a-eb14335bf358" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Some hard-code values</body>
                    </command>
                    <nestedSteps>
                        <item guid="7d4149f1-ac27-4c53-8c66-cc97b90b144e" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Initial_UE_Message_Proc_Code = 15</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f5b1c70a-d293-4fbd-b6e3-b58f24790c4e" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Registration_Request_Msg_Type = 65</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="1ec5abe9-35a4-4e26-b116-85ca1954feaa" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>DL_NAS_Transport_Proc_Code = 4</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6488543d-8dc0-4bb7-a2f8-35388efaaffa" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Authentication_Request_Msg_Type = 86</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="398e0186-55b5-4428-9c13-636bbdcf92b3" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>UL_NAS_Transport_Proc_Code = 46</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e81ca623-3e3a-4b23-9179-8fd04da9f7b0" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Authentication_Response_Msg_Type = 87</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="655a8fc8-9c67-4c81-803f-16348f712850" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Security_Mode_Command_Msg_Type = 93</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f6e131d4-0c94-43a7-92b1-921424bea03a" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Security_Mode_Complete_Msg_Type = 94</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6a9a7b8a-fc86-446d-b76d-bbf417e8e3fd" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Initial_Context_Setup_Proc_Code = 14</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="16e0edab-b911-408b-b0e0-4d2c59d58210" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Registration_Accept_Msg_Type = 66</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="acf30c95-b027-4505-a3b3-4f52712323d0" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>UE_Radio_Capability_Indication_Proc_Code = 44</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ccc92aef-2a0a-4f22-bfb0-f932089c97e9" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Registration_Complete_Msg_Type = 67</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="63fc0219-eb76-469c-9825-ac17a6625eab" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>failed_msg = &quot;&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2ecfa125-587a-48ad-8868-3ba66b83e9e0" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Validate N1/N2 message flow</body>
                    </command>
                    <nestedSteps>
                        <item guid="db618ae3-0aa7-4726-99b9-d56e235bdc72" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>1. Initial UE Message, Registration Request</body>
                            </command>
                            <nestedSteps>
                                <item guid="fed05947-feb2-4070-8875-8a91cfe7324a" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Find message based on its procedureCode and message_type</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="087f80b4-1d1c-4dca-9092-eb81ec9f409a" action="command" session="s4">
                                    <command>
                                        <body>query filter set &quot;ngap.procedureCode == [Initial_UE_Message_Proc_Code]&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0e89736b-1fc2-4bd4-90bf-81385bc2c752" action="command" session="s4">
                                    <command>
                                        <body>query packets</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>rowCount()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == 1</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>failed_msg = &quot;{0} Initial UE Message, Registration Request sent, expected: 1&quot;.format(value)</statement>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>No/Multiple Initial UE Message, Registration Request sent</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                                <skip>true</skip>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>messages/item[1]/id</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>initial_ue_message_id_no</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <eventHandlers>
                                        <item name="OnWiresharkCommandFailed">
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>No Initial UE Message, Registration Request found</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="ExitProcedure">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                            </item>
                                            <item actionId="SkipRemainingRules">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                        </item>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="647b0a0a-944d-4693-afae-995ed09fec65" action="command" session="s4">
                                    <command>
                                        <body>query details [initial_ue_message_id_no]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;nas_5gs.mm.message_type&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == int(Registration_Request_Msg_Type)</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>The Initial UE Message is not Registration Request</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;frame.time_epoch&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>registration_request_time</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3563f599-85ba-45fc-932a-91041dfb6141" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:1. Initial UE Message, Registration Request</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">1. Initial UE Message, Registration Request</message>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="6ce860b6-8baa-4f63-bb7b-c53b381105e8" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>2. DL NAS Transport / Authentication Request</body>
                            </command>
                            <nestedSteps>
                                <item guid="eb2af7e6-95ea-4643-b766-cbd348581f41" action="command" session="s4">
                                    <command>
                                        <body>query filter set ngap</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="7ed67861-381b-4b68-bbf9-936207b1ef2d" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = int(initial_ue_message_id_no)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="d15dca34-9b97-422f-8a5e-e63efc3f0bac" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>verify_ngap_message -proc_code [DL_NAS_Transport_Proc_Code] -msg_type [Authentication_Request_Msg_Type] -failed_message &quot;DL NAS Transport / Authentication Request is required in message sequence, but another mesage is found&quot; -number_id [number_id]</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>ret</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cf3ea6f8-0de0-4c12-8e97-45b838bbfe53" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not ret[0]:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="f276224c-3fc4-4f93-8356-5609491c3f2d" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f0ae1d9d-772d-4592-b1fb-a57ddd898873" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = int(ret[1])</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="04315a74-92d4-4e39-86e6-7bfeb8809342" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:2. DL NAS Transport / Authentication Request</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">2. DL NAS Transport / Authentication Request</message>
                                    </applicationProperties>
                                </item>
                                <item guid="01393d9d-dc20-428f-9dea-8278100fcd37" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check if mandatory IEs present</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="3b44bb7f-63be-45cb-90fe-63a2eb56c25b" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>check_if_DL_NAS_transport_IEs_present -number_id [number_id] -procedure_code &quot;procedureCode: id-DownlinkNASTransport&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="a2b27298-6cec-4de9-bcde-db6e16427cf4" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Check Authentication Request&apos;s IEs</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="323d8823-bf4e-4a46-823e-a011a9c416b1" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:    Authentication Request IE Validation:</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">    Authentication Request IE Validation:</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="fc89868a-7f60-4f73-b58b-2d9649d66dd8" action="command" session="s4">
                                                    <command>
                                                        <body>query details [number_id]</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>Extended protocol discriminator:</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Extended protocol discriminator is present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Extended protocol discriminator is NOT present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>nas_5gs.security_header_type</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Security header type is present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Security header type is NOT present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>nas_5gs.mm.message_type</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Authentication request message identity is present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Authentication request message identity is NOT present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>nas_5gs.mm.nas_key_set_id</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE ngKSI is present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE ngKSI is NOT present in Authentication Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;nas_5gs.spare_half_octet&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) &gt;= 2</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Spare half octet: Expected greater than or equal 2, Actual [value]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Spare half octet: Expected greater than or equal 2, Actual [value]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="28825c79-95b0-4085-89c9-caa633ce242d" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>3. UL NAS Transport / Authentication Response</body>
                            </command>
                            <nestedSteps>
                                <item guid="f7e9cbef-7285-431c-b74b-1971f84faaed" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>verify_ngap_message -proc_code [UL_NAS_Transport_Proc_Code] -msg_type [Authentication_Response_Msg_Type] -number_id [number_id] -failed_message &quot;UL NAS Transport / Authentication Response is required in message sequence, but another mesage is found&quot;</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>ret</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5e336731-f908-4ec9-b70e-0a86a2f3a015" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not ret[0]:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="eca410a5-9e70-4767-95b4-aca092dba91f" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="daa8d5f9-f7a4-408c-8e51-5174e6505c38" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:3. UL NAS Transport / Authentication Response</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">3. UL NAS Transport / Authentication Response</message>
                                    </applicationProperties>
                                </item>
                                <item guid="b6ac2de5-452c-433b-9050-eb25d5323c4f" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = ret[1]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="b7ac9272-59f5-44e8-8d78-20e18fdc26df" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>4. DL NAS Transport / Security Mode Command</body>
                            </command>
                            <nestedSteps>
                                <item guid="1f88b3c2-21be-43fe-b045-94de54d0c1ba" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>verify_ngap_message -proc_code [DL_NAS_Transport_Proc_Code] -msg_type [Security_Mode_Command_Msg_Type] -number_id [number_id] -failed_message &quot;DL NAS Transport / Security Mode Command is required in message sequence, but another mesage is found&quot;</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>ret</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="272e1037-1fed-409a-99f8-25ebfe5fad81" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not ret[0]:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="591dc290-6010-4f55-bb7a-4f631fad2df4" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0cb7f942-0522-489b-9f79-fefc77cb22cb" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = int(ret[1])</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="23919019-7fc0-4c25-9ba7-eb21e978e113" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:4. DL NAS Transport / Security Mode Command</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">4. DL NAS Transport / Security Mode Command</message>
                                    </applicationProperties>
                                </item>
                                <item guid="e72287aa-61bb-4688-8a3c-f183b51dca1b" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check if mandatory IEs present</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="71526b7d-332c-4d6e-be32-6b8e1089b402" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>check_if_DL_NAS_transport_IEs_present -number_id [number_id] -procedure_code &quot;procedureCode: id-DownlinkNASTransport&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="5750eae9-8e4d-4f52-afef-838fb0189450" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Check Security Mode Command&apos;s IEs</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="4912a3c7-f608-4919-bf2a-990c30b934d5" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:    Security Mode Command IE Validation:</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">    Security Mode Command IE Validation:</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="5205aaa4-d623-498f-9c94-1ea43d027d4e" action="command" session="s4">
                                                    <command>
                                                        <body>query details [number_id]</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>Extended protocol discriminator:</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Extended protocol discriminator is present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Extended protocol discriminator is NOT present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>nas_5gs.security_header_type</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Security header type is present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Security header type is NOT present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>nas_5gs.mm.message_type</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Authentication request message identity is present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Authentication request message identity is NOT present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>nas_5gs.mm.nas_key_set_id</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE ngKSI is present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE ngKSI is NOT present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;nas_5gs.spare_half_octet&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) &gt;= 2</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Spare half octet: Expected greater than or equal 2, Actual [value]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Spare half octet: Expected greater than or equal 2, Actual [value]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>UE security capability - Replayed UE security capabilities</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Replayed UE security capabilities is present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Replayed UE security capabilities is NOT present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>NAS security algorithms</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Selected NAS security algorithms is present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Selected NAS security algorithms is NOT present in Security Mode Command</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="2a9cd24b-82d2-4892-84ee-ae6b208286ae" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>5. UL NAS Transport /Security Mode Complete</body>
                            </command>
                            <nestedSteps>
                                <item guid="d96bd783-9bf4-49a9-b5bb-efe1aceacaa5" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>verify_ngap_message -proc_code [UL_NAS_Transport_Proc_Code] -msg_type [Security_Mode_Complete_Msg_Type] -number_id [number_id] -failed_message &quot;UL NAS Transport /Security Mode Complete is required in message sequence, but another mesage is found&quot;</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>ret</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="65ab733d-c6c4-4d79-9546-5c2c47f6bdeb" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not ret[0]:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="a8bd2f53-d093-46f4-96cd-8dd2b0b53982" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cc149413-4df3-4dd4-9955-834ca2729495" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = int(ret[1])</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e0e46505-152f-4445-973c-28f6ba2be152" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:5. UL NAS Transport /Security Mode Complete</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">5. UL NAS Transport /Security Mode Complete</message>
                                    </applicationProperties>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="749191a8-2e9b-4440-a545-fe2df056c23f" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>6. Initial Context Setup Request</body>
                            </command>
                            <nestedSteps>
                                <item guid="3116e478-bd1f-4843-b64e-828d26c42e0a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>should_continue = True</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="33a703f5-3fe1-42a4-a469-72905b581587" action="while" useFieldsInCommand="false">
                                    <command>
                                        <body>should_continue:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="cc5b9176-9717-4f1c-bf1b-5385ba92b632" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id += 1</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="94b94d9e-d763-4478-9d6e-1f3d244c9659" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item)</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 0</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="Continue">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query sub="true">count(details/item\\[field = &quot;ngap.procedureCode&quot; and value = [Initial_Context_Setup_Proc_Code]])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>No Initial Context Setup Request received</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;ngap.InitialContextSetupRequest_element&quot;]/description</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == &quot;InitialContextSetupRequest&quot;</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>Initial Context Setup Request is required in message sequence, but another mesage is found</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="2b6bc4de-deed-4773-a266-9254ec9efaf2" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:6. Initial Context Setup Request</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">6. Initial Context Setup Request</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="06686191-4b45-44b4-93da-59396d075389" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Check IEs</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="9aa5ffd0-547a-4fb5-9769-684615427908" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>has_ie_failed = False</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="f3ff1a1a-c6b3-4647-a077-91e3ebbc5ff9" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:    Mandatory IE Validation:</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">    Mandatory IE Validation:</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="2b9c609d-abc4-47dc-9e11-aa8fadc094ba" action="command" session="s4">
                                                    <command>
                                                        <body>query details [number_id]</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.InitialContextSetupRequest_element&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Message Type is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Message Type is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.AMF_UE_NGAP_ID&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE AMF UE NGAP ID is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE AMF UE NGAP ID is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.RAN_UE_NGAP_ID&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE RAN UE NGAP ID is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE RAN UE NGAP ID is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.GUAMI_element&quot; and description = &quot;GUAMI&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE GUAMI is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE GUAMI is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.AllowedNSSAI&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Allowed NSSAI is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Allowed NSSAI is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.SecurityKey&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE Security Key is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE Security Key is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.UESecurityCapabilities_element&quot;])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        IE UE Security Capabilities is present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        IE UE Security Capabilities is NOT present in Initial Context Setup Request</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>has_ie_failed = True</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.procedureCode&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>proc_code_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.AMF_UE_NGAP_ID&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>amf_ue_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.RAN_UE_NGAP_ID&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>ran_ue_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[description = &quot;GUAMI&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>guami_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.AllowedNSSAI&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>allowed_nssai_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[description = &quot;UESecurityCapabilities&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>ue_sec_capability_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item[field = &quot;ngap.SecurityKey&quot;]/preceding-sibling::*) + 1</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>security_key_index</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="46553564-7ccf-4c4b-b1ff-85e74da0c212" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Check assigned criticality</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="bb62c8ce-ff0e-4178-b5b0-4e81719e07f3" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>has_ie_failed:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="05f59b54-7513-4c85-971c-9b09be2ccc38" action="break" useFieldsInCommand="false">
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="dfccd023-c50b-4af9-817c-199665d1cd47" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>proc_code_criticality_index = int(proc_code_index) + 2</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="f8e68712-3c5d-46d0-a2a2-ec4042c38292" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>amf_ue_criticality_index = int(amf_ue_index) - 3</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="72049741-8d6d-40e7-8b6d-a40a21ad1a60" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>ran_ue_criticality_index = int(ran_ue_index) - 3</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="344858ff-86fa-4821-9c26-6e5b67125b2b" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>guami_criticality_index = int(guami_index) - 3</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="42374d0d-0930-41df-927d-b033eb14a139" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>allowed_nssai_criticality_index = int(allowed_nssai_index) - 4</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="4842684d-25ec-41c1-84ad-473dbc40c063" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>ue_sec_cap_criticality_index = int(ue_sec_capability_index) - 3</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="882c9ef9-58ab-4421-b42d-b01ed2a6e56f" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>security_key_criticality_index = int(security_key_index) - 3</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="21da50f9-8f65-4037-8977-712f5a24f2de" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Reject_Criticality = 0</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="9c62c1bc-d0a3-4855-b621-1e73dec4435d" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Ignore_Criticality = 1</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="a64c6962-b17b-4ec0-aed3-cf8aa9099ca1" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>criticality_map = { Ignore_Criticality: &quot;ignore&quot;, Reject_Criticality: &quot;reject&quot; }</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="ca3fc88d-a801-46be-8e7c-f0e4d0954213" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>actual_value = &quot;&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="43b6c464-d6c5-49c8-b748-f214705e0dbd" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:    Assigned Criticality Validation:</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">    Assigned Criticality Validation:</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="a2fca8fb-ce8a-4d39-9772-e28dd28496d1" action="command" session="s4">
                                                    <command>
                                                        <body>query details [number_id]</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[proc_code_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        ProcedureCode: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        ProcedureCode: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[amf_ue_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        AMF UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        AMF UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[ran_ue_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        RAN UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        RAN UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[guami_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        GUAMI: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        GUAMI: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[allowed_nssai_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        Allowed NSSAI: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        Allowed NSSAI: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[ue_sec_cap_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        UE Security Capabilities: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        UE Security Capabilities: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">details/item\\[[security_key_criticality_index]]/value</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>        Security Key: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>        Security Key: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="a9663091-fa07-48ab-990f-ad394b2c6923" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>should_continue = False</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e4f61a70-c580-44c6-bc32-8cf7b2df078a" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Verify message #7 &amp; #8 since they can be reversed</body>
                            </command>
                            <nestedSteps>
                                <item guid="38e6665a-b903-4219-b002-1bb9a175d9f1" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>next_number_id = number_id + 1</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="67383550-4ad8-4c43-ae7f-e60679f8e92b" action="command" session="s4">
                                    <command>
                                        <body>query details [next_number_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;ngap.procedureCode&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == int(Initial_Context_Setup_Proc_Code)</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>are_packages_reversed = True</statement>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>are_packages_reversed = False</statement>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4434da75-8859-447f-a890-8633cf30d800" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>not are_packages_reversed:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="3ae99efb-31a9-4ed4-9f81-621c34e1b9ea" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>7. DL NAS Transport /Registration Accept</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="e85899d4-1686-4484-bdc3-4999a7931f27" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>verify_ngap_message -proc_code [DL_NAS_Transport_Proc_Code] -msg_type [Registration_Accept_Msg_Type] -number_id [number_id] -failed_message &quot;DL NAS Transport /Registration Accept is required in message sequence, but another mesage is found&quot;</body>
                                                    </command>
                                                    <postProcessing>
                                                        <storeResponseAt>ret</storeResponseAt>
                                                        <storeResponseText>true</storeResponseText>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="dcce0148-c81b-4c34-8da7-3205c2a44274" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>not ret[0]:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="5b05769d-f29f-49bb-a7f5-280cf58eb636" action="return">
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="756574f1-eb11-4412-987d-33ff7ef54e07" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>number_id = int(ret[1])</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="1c089165-477e-439d-af24-9ba074ed1d58" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:7. DL NAS Transport /Registration Accept</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">7. DL NAS Transport /Registration Accept</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="07d45246-2376-4224-a0c8-565e79532bce" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Check if mandatory IEs present</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="0e8d8e1b-06cb-441e-a436-a974aadc2ece" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>check_if_DL_NAS_transport_IEs_present -number_id [number_id] -procedure_code &quot;procedureCode: id-DownlinkNASTransport&quot;</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="d744791c-9ba7-4cec-8ef3-be01d3438e2c" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Check Registration Accept&apos;s IEs</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="8ef0daf4-92a4-4d8d-a262-07ffdfe6e2bf" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Information:    Registration Accept IE Validation:</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <message inherit="false">    Registration Accept IE Validation:</message>
                                                                    </applicationProperties>
                                                                </item>
                                                                <item guid="d905277d-0ab2-4930-a1d4-16cd9d3be409" action="command" session="s4">
                                                                    <command>
                                                                        <body>query details [number_id]</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>Extended protocol discriminator:</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Extended protocol discriminator is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Extended protocol discriminator is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>nas_5gs.security_header_type</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Security header type is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Security header type is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>nas_5gs.mm.message_type</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Authentication request message identity is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Authentication request message identity is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>count(details/item[field = &quot;nas_5gs.spare_half_octet&quot;])</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>int(value) &gt;= 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Spare half octet is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Spare half octet is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>5GS registration result</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE 5GS registration result is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE 5GS registration result is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b34fdf2a-f449-4dc1-bf2c-7848e5880849" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>ini_ctxt_setup_res_order = 8</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="86e59df0-b701-4d8b-9abb-92b1b6e2c8ca" action="else" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="ef8e5ca7-6e97-4d96-a721-f680eceb3e65" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>ini_ctxt_setup_res_order = 7</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="765ee2cb-819c-471f-a7ec-92bb254b7145" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>8. Initial Context Setup Response</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="5c0103da-2010-4e69-85af-87fcc2d3b240" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>should_continue = True</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="6c18b95c-732d-4597-857d-254a189441c1" action="while" useFieldsInCommand="false">
                                            <command>
                                                <body>should_continue:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="170875fe-7ca2-43ae-8987-43babad98aca" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>number_id += 1</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="640ea8ea-2252-4501-8903-69465c253167" action="command" session="s4">
                                                    <command>
                                                        <body>query details [number_id]</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>count(details/item)</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 0</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="Continue">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">count(details/item\\[field = &quot;ngap.procedureCode&quot; and value = [Initial_Context_Setup_Proc_Code]])</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>No Initial Context Setup Request received</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>details/item[field = &quot;ngap.InitialContextSetupResponse_element&quot;]/description</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &quot;InitialContextSetupResponse&quot;</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>Initial Context Setup Response is required in message sequence, but another mesage is found</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="b705175f-40c6-4fc3-8a80-1e49bb253354" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:[ini_ctxt_setup_res_order]. Initial Context Setup Response</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">[ini_ctxt_setup_res_order]. Initial Context Setup Response</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="d18a457e-2d86-4b01-8bf6-b03c6feb9f82" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>should_continue = False</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="67156261-b6f3-4a8f-866b-179df3c0c739" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>are_packages_reversed:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="6d5c10be-97dd-41fb-bf08-a810806be818" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>7. DL NAS Transport /Registration Accept</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="cde63573-85fb-4506-9ca2-a5a0ef313d1a" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>verify_ngap_message -proc_code [DL_NAS_Transport_Proc_Code] -msg_type [Registration_Accept_Msg_Type] -number_id [number_id] -failed_message &quot;DL NAS Transport /Registration Accept is required in message sequence, but another mesage is found&quot;</body>
                                                    </command>
                                                    <postProcessing>
                                                        <storeResponseAt>ret</storeResponseAt>
                                                        <storeResponseText>true</storeResponseText>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="410b3c70-923f-40bc-bb82-c9e06227d815" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>not ret[0]:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="b495a702-f04f-48f8-9e4a-2c020b303f72" action="return">
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="15744e7a-2f5f-424f-ae13-cba113ca7040" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>number_id = int(ret[1])</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="9692c3b4-5a93-49ef-aae9-5b389a2fecef" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Information:8. DL NAS Transport /Registration Accept</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <message inherit="false">8. DL NAS Transport /Registration Accept</message>
                                                    </applicationProperties>
                                                </item>
                                                <item guid="c343212c-3591-4eaf-9508-03d5841315c8" action="comment" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Check if mandatory IEs present</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="314e5fb4-bbc9-426a-b798-9519085b66b0" action="call" useFieldsInCommand="false">
                                                            <command>
                                                                <body>check_if_DL_NAS_transport_IEs_present -number_id [number_id] -procedure_code &quot;procedureCode: id-DownlinkNASTransport&quot;</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="1098bea3-8281-4456-a10b-6d982be37777" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Check Registration Accept&apos;s IEs</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="881b43f2-9245-4d48-b94e-a9d4c970fcb6" action="message" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>Information:    Registration Accept IE Validation:</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                        <message inherit="false">    Registration Accept IE Validation:</message>
                                                                    </applicationProperties>
                                                                </item>
                                                                <item guid="ad3e6a4c-277a-4b45-9790-2d1923d5fb25" action="command" session="s4">
                                                                    <command>
                                                                        <body>query details [number_id]</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>Extended protocol discriminator:</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Extended protocol discriminator is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Extended protocol discriminator is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>nas_5gs.security_header_type</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Security header type is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Security header type is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>nas_5gs.mm.message_type</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Authentication request message identity is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Authentication request message identity is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>count(details/item[field = &quot;nas_5gs.spare_half_octet&quot;])</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>int(value) &gt;= 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE Spare half octet is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE Spare half octet is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="contains">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                                        <searchString>5GS registration result</searchString>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == 1</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                                    <message>        IE 5GS registration result is present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>        IE 5GS registration result is NOT present in Registration Accept</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="52190e00-e608-4c0e-b508-ec699386de96" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>9. UE Radio Capability Indication</body>
                            </command>
                            <nestedSteps>
                                <item guid="785dc114-474b-4135-a490-923b56451ab3" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>should_continue = True</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="2b6e40af-6639-412d-8ac7-cc2040e27bd5" action="while" useFieldsInCommand="false">
                                    <command>
                                        <body>should_continue:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="a24b95b8-256c-49ab-b61c-6d041d815a45" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id += 1</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="9c346d58-8ed6-4833-8b2f-02ca6d472716" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query sub="true">count(details/item\\[field = &quot;ngap.procedureCode&quot; and value = [UE_Radio_Capability_Indication_Proc_Code]])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>UE Radio Capability Indication is required in message sequence, but another mesage is found</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="fbabb11b-9dd6-45c4-a31c-f997241e1f8f" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:9. UE Radio Capability Indication</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">9. UE Radio Capability Indication</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="698c7bbf-958e-4ec5-bc0b-42c4324829c8" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>should_continue = False</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f3cae716-86b1-4851-8112-400bd19ece1b" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>10. UL NAS Transport / Registration Complete</body>
                            </command>
                            <nestedSteps>
                                <item guid="eeb23f3e-996a-46bb-ac42-e95913483203" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>verify_ngap_message -number_id [number_id] -proc_code [UL_NAS_Transport_Proc_Code] -msg_type [Registration_Complete_Msg_Type] -failed_message &quot;No UL NAS Transport / Registration Complete sent&quot;</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>ret</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="cc5b40ba-9de7-4be3-9fd9-4e02ebb2d296" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>ret[0]:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="c16e751f-691d-45e0-97bf-2d1753ac511a" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id = ret[1]</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="763d0820-667d-4d1f-8d03-d7c03f8b6b15" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:10. UL NAS Transport / Registration Complete</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">10. UL NAS Transport / Registration Complete</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="20362c68-736b-48ec-a838-b7ff9d37ff58" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;frame.time_epoch&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>registration_complete_time</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="42633795-4457-44b4-914c-e9df6b412b42" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Extract Average Registration Time</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="a59cceb7-807d-4fbd-b4f3-8537767e353c" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>average_registration_time = (float(registration_complete_time) - float(registration_request_time)) * 1000</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="fb0eafa8-211c-4e7b-9454-df137e4a61a8" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>gset(&apos;average_registration_time&apos;, average_registration_time)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5e4acda3-5d6d-4e82-bba6-4a2fd68e15da" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Validate NGAP &amp; MM message counters in pcap</body>
                            </command>
                            <nestedSteps>
                                <item guid="b8e1f79d-328e-4555-926c-43e0cb50375b" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 50</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="117bf88f-066a-4b94-bbae-9c58cd5a0c05" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:Validate NGAP &amp; MM message counters in pcap</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">Validate NGAP &amp; MM message counters in pcap</message>
                                    </applicationProperties>
                                </item>
                                <item guid="0fab5782-44ac-4c67-ac75-bb006f637130" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Validate initial Context Setup Requests counter in pcap file. It should equal to 1</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="17f464f1-455c-45db-933d-0fa697d367c9" action="command" session="s4">
                                            <command>
                                                <body>query filter set &quot;ngap &amp;&amp; ngap.procedureCode == [Initial_Context_Setup_Proc_Code]&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="13976689-b4c1-4928-98d0-310465934150" action="command" session="s4">
                                            <command>
                                                <body>query packets</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(messages/item)</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>count</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="de179a6e-ec98-4ef0-8095-97ab199d71b2" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>counter = 0</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="1a653500-1c29-4833-bc42-349f707847ed" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>i in range(1, int(count) + 1):</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="e35f1392-6a1e-482f-bb59-c534c12a9d5f" action="command" session="s4">
                                                    <command>
                                                        <body>query packets</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">messages/item\\[[i]]/id</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>id</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="06514199-e134-442a-a37d-eb7db756cfef" action="command" session="s4">
                                                    <command>
                                                        <body>query details [id]</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="contains">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                        <searchString>ngap.InitialContextSetupRequest</searchString>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == 1</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="Continue">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="SkipRemainingRules">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="1607803f-8baf-4ae1-8693-0ad897104693" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>counter += 1</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="cc450291-7465-4e2f-8990-219157bd4116" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>msg = &quot;    initial Context Setup Requests: Expected 1, Actual &quot; + str(counter)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="3b480d3a-0636-498a-bfee-cd7538cb3647" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>counter != 1:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="5016e71d-fdb6-40dc-879a-caa118109bb0" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [msg]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="f974c6dd-8e4f-494a-8487-d327995e964c" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="8b1b38e6-b409-41cc-bc8e-1ec9c2ca8f3d" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:[msg]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">[msg]</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c17b3190-9ae6-4638-9f8a-76cbde723b4b" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Validate Authentication Requests, Security Mode Commands, Registration Accepts counter in pcap file. Each should equal to 1</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="5711b370-9177-49e3-9c59-d80f22e185c0" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>filters = &quot;ngap &amp;&amp; ngap.procedureCode == {0} &amp;&amp; nas_5gs.mm.message_type == {1}&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b308c2b0-608e-45ed-9b3a-ae76d56f9786" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>authentication_request_filter = filters.format(DL_NAS_Transport_Proc_Code, Authentication_Request_Msg_Type)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ec110f95-38eb-48ac-a5b3-701f49105d78" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>security_mode_command_filter = filters.format(DL_NAS_Transport_Proc_Code, Security_Mode_Command_Msg_Type)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="6956ae74-dae1-4de1-8094-a7f5c450176d" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>registration_accept_filter = filters.format(DL_NAS_Transport_Proc_Code, Registration_Accept_Msg_Type)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="aff03484-43e9-40b3-910f-4c33cfc3ef15" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>filter_map = { authentication_request_filter: &quot;    Authentication Requests: Expected 1, Actual {0}&quot;, security_mode_command_filter: &quot;    Security Mode Commands: Expected 1, Actual {0}&quot;, registration_accept_filter: &quot;    Registration Accepts: Expected 1, Actual {0}&quot;}</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="50de00e2-c759-491f-99c8-48ba8cdce95e" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>filter, message in filter_map.items():</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="4dd4e922-76ad-41af-bf4b-c93fda057c1b" action="command" session="s4">
                                                    <command>
                                                        <body>query filter set [filter]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="03c5e0d4-93fd-4e86-9d81-b9e8ec5e6777" action="command" session="s4">
                                                    <command>
                                                        <body>query packets</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>rowCount()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenTrue>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>message = message.format(value)</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                    <message>[message]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenTrue>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>message = message.format(value)</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>[message]</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="ca47b47c-1df9-4282-8832-48f02f19c201" action="return">
                    <command>
                        <body>true</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="n1_n2_pcap">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="verify_nausf_nudm_interface" isPublic="true">
            <steps>
                <item guid="a7c51083-452f-4748-94bd-f86a666a100f" action="command" session="s4">
                    <command>
                        <body>query load &quot;[pcap_file]&quot;</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="625ed423-67d8-4571-8237-16489bf6efc8" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Some hard-code values</body>
                    </command>
                    <nestedSteps>
                        <item guid="313bc151-9558-4d8d-b344-8221527837f6" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>Headers_Type_Value = 1</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5273dce7-8a1d-420f-bf81-ebb70972c332" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>confirm_data_path = &quot;5g-aka-confirmation&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="3af9d936-2a37-4b80-8891-6eb4fb851083" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>confirm_data_method = &quot;PUT&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="dd26df54-d369-4428-aa99-54e7a57db704" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>amf_path = &quot;/{0}/registrations/amf-3gpp-access&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7449da42-ee13-4e4c-90ca-e3309fcd5b3d" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>amf_method = &quot;PUT&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="6af42194-4a2e-47d5-a1de-77e0828e376b" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>verify NAUSF interface message flow</body>
                    </command>
                    <nestedSteps>
                        <item guid="db4c79a1-e289-4fb8-8700-6b86784b439f" action="call" useFieldsInCommand="false">
                            <command>
                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 135</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="fc7cfec2-1d35-43b1-aacf-29ad088d52b0" action="message" useFieldsInCommand="false">
                            <command>
                                <body>Information:Validate Nausf Interface</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                <message inherit="false">Validate Nausf Interface</message>
                            </applicationProperties>
                        </item>
                        <item guid="1e014de6-37b6-4410-ae02-0ae10f4d50d1" action="call" useFieldsInCommand="false">
                            <command>
                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 50</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="5e272fdd-ebd2-4f8c-bded-5f53d473187b" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Find and verify AuthenticationInfo</body>
                            </command>
                            <nestedSteps>
                                <item guid="b3c62c0e-9a6b-4a2e-8159-f3393f88b901" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>auth_info_path = &quot;ue-authentications&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="99cf9c93-a8af-4ed8-a719-c2e8c4fd6ce8" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>auth_info_method = &quot;POST&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="39e2ab62-d782-4560-8036-b55b64e2a836" action="call" useFieldsInCommand="false">
                                    <command>
                                        <body>verify_http2_message -path [auth_info_path] -method [auth_info_method] -failed_message &quot;UE Authentication Context Request is required in message sequence, but another mesage is found&quot;</body>
                                    </command>
                                    <postProcessing>
                                        <storeResponseAt>number_id</storeResponseAt>
                                        <storeResponseText>true</storeResponseText>
                                    </postProcessing>
                                    <eventHandlers>
                                        <item name="OnWiresharkCommandFailed"/>
                                    </eventHandlers>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="33693bb5-bdc7-4970-aeec-462901d1963b" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check AuthenticationInfo and its IEs</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="4d64ec55-7a2f-493e-8a45-0461f9af1a25" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>int(number_id) == -1:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="7e3ffdae-6b79-4600-b6b4-2b7edc1f5a8d" action="return">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="bb6b76fa-92fc-45f0-b15a-7539567b408c" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:1. UE Authentication Context Requests</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">1. UE Authentication Context Requests</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="28f55e4b-b70e-42cc-b91f-64559ac6ef84" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:    Mandatory IE Validation:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">    Mandatory IE Validation:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="abd3f4b9-48b1-4659-aecd-68aee8d32d46" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;supiOrSuci&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE supiOrSuci: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE supiOrSuci: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;servingNetworkName&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE servingNetworkName: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE servingNetworkName: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;tcp.ack&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>tcp_ack</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="afd33e7f-afd0-4715-b3af-ed584b97dbee" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>get_supi_value -number_id [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <storeResponseAt>supi_value</storeResponseAt>
                                                <storeResponseText>true</storeResponseText>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="3e8099c9-3c9c-400a-bd06-927777e418f0" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Save a list of index of http2 messages with type = HEADERS</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="e855da6e-c4e7-4cf9-b6f0-a74077ef3868" action="command" session="s4">
                                            <command>
                                                <body>query filter set &quot;http2.type == [Headers_Type_Value]&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="15683828-6a08-478e-97ba-b4f07d295ac9" action="command" session="s4">
                                            <command>
                                                <body>query packets</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query sub="true">count(messages/item\\[id = [number_id]]/preceding-sibling::*) + 1</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>auth_info_index</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>rowCount()</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>num_of_http2_headers</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="e8f5c580-1ca9-4ebb-a429-5df6980e435a" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>headers_http2_index_lst = []</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="38c85de3-7f84-4c59-aa6a-4d18833995d8" action="for" useFieldsInCommand="false">
                                            <command>
                                                <body>i in range(int(auth_info_index) + 1, int(num_of_http2_headers) + 1):</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="d78ddec0-ec3d-43b1-b157-a3e51b63c9f7" action="command" session="s4">
                                                    <command>
                                                        <body>query packets</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query sub="true">messages/item\\[[i]]/id</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>idx</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="915f750e-f21a-4b96-b6be-4372c1e91403" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>headers_http2_index_lst.append(idx)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="72550935-15c2-418d-9beb-62e9a142ed65" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check response for AuthenticationInfo Request</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="1c9a8e1c-269c-484b-a07e-0144248b2ee9" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="61d971dc-2b20-4ad8-8e26-0903477c40bf" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message &quot;Nausf UE Authentication Context Request received no responses&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="44c5dd52-31a2-418c-8869-4ae73887e871" action="return">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="a9a4dfe4-ce06-4bcf-8199-ebcc553a2a34" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id = int(headers_http2_index_lst.pop(0))</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="7f99c392-aa56-4629-9257-9cd7c27afbf3" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;tcp.seq&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == int(tcp_ack)</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>Nausf UE Authentication Context Request received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>http2.headers.status</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>Nausf UE Authentication Context Request received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;http2.headers.status&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>status</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="1aa488e9-3ece-4af7-872f-a5956ee2915f" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:2. UE Authentication Context&apos;s Response:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">2. UE Authentication Context&apos;s Response:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="8cb4dee1-3e7a-46bc-a3a7-608bba6645fc" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;201&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="56d0af04-c601-4d0d-afd2-780f43f99e20" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:    201 Created</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">    201 Created</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b92e9fe4-2baa-42b5-a376-3cc81a0490c2" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="3388539f-40d8-4b4d-8f71-96df74d831ed" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    Status Code: {0}&quot;.format(status)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="7c33744c-1ad8-4e83-8670-562978282fbe" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7fb39afb-f7fe-4727-9ae2-776d3f4e199b" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Find and verify ConfirmationData</body>
                            </command>
                            <nestedSteps>
                                <item guid="84086ca6-924d-4796-adbb-43c069b69911" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="379e19a3-555d-4b71-9be1-179679a174c1" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;No 5G AKA Confirmation message sent&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="fb97c7d4-39bd-4179-bd72-1bf6f332076c" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="ba38fdc5-2f13-483a-8fb1-d440cd5346d6" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = int(headers_http2_index_lst.pop(0))</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b90a0509-6fd2-4eb0-aa67-f140ea6fa0e1" action="command" session="s4">
                                    <command>
                                        <body>query details [number_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="contains">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                        <searchString>http2.headers.path</searchString>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>value == 1</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>No 5G AKA Confirmation sent</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;tcp.ack&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>tcp_ack</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.path&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_path</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.method&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_method</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="22003a47-02d9-400b-9c63-ad8d5539eb9e" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>confirm_data_path in header_path and confirm_data_method == header_method:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="624a029b-ca34-438b-9688-8348976dc142" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:3. 5G AKA Confirmation</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">3. 5G AKA Confirmation</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="21b6a128-bfb9-42ef-a3f9-6c0df8acfab6" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:    Mandatory IE Validation:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">    Mandatory IE Validation:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="20064a0a-44b5-47c4-b2ab-60bb0e909934" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;resStar&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE resStar: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE resStar: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="a0f163d9-5f02-4175-bdd9-5ed64c5f9d90" action="else" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="bc02d052-a4fc-4d81-8f93-0a62991a03fa" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;5G AKA Confirmation is required in message sequence, but another mesage is found&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="d744c19a-a8b3-47a1-844a-d45822002af9" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f065415c-adfb-49eb-8089-cabeb17e5575" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check response for ConfirmationData</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="abb599be-4207-4ea3-b0dc-e1139eb50a99" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="a9a286b7-d58f-407a-9aa6-fb8782bf403c" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message &quot;5G AKA Confirmation received no response&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="1ba1b8d1-c0e5-477e-9860-5756b2066437" action="return">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="f71e0a9f-33d4-4111-a8fa-409581aa2f55" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id = headers_http2_index_lst.pop(0)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="0fa85216-bfa0-46d1-afa1-c8a1bb14df7d" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;tcp.seq&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == int(tcp_ack)</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>5G AKA Confirmation received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>http2.headers.status</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>5G AKA Confirmation received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;http2.headers.status&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>status</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="3765e57c-50a3-400e-b3ef-abe0a7f84bdb" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:4. 5G AKA Confirmation&apos;s Response:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">4. 5G AKA Confirmation&apos;s Response:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="78cbea98-7b64-46c7-87f3-5c90f4a710b4" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;200&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="58803974-1827-4877-88fa-9a3486a6c302" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:    200 OK</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">    200 OK</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="8e335618-ca1e-4882-93cd-9a097bef5f33" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="58b4a7f3-8592-4450-ba49-9ff74f88ee31" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    Status Code: {0}&quot;.format(status)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="0bae342d-d7e9-4bdf-a7cf-6d1e12baf4ad" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="4ff4f26a-e18b-47d4-8256-a662d1aaa0ee" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>verify NUDM interface</body>
                    </command>
                    <nestedSteps>
                        <item guid="f5e44d03-b1f8-4deb-a85a-a71bce6f4c3d" action="call" useFieldsInCommand="false">
                            <command>
                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 135</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="bbf0eea8-2829-4e7d-aade-556febbc2397" action="message" useFieldsInCommand="false">
                            <command>
                                <body>Information:Validate Nudm Interface</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                <message inherit="false">Validate Nudm Interface</message>
                            </applicationProperties>
                        </item>
                        <item guid="8c6bd712-3d96-43de-ab96-313c0388e14f" action="call" useFieldsInCommand="false">
                            <command>
                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 50</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="79f7bd03-3703-461f-b335-a2616f429e19" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Find and verify Amf3GppAccessRegistration</body>
                            </command>
                            <nestedSteps>
                                <item guid="2c4a4f7b-6b29-4004-a065-220af8832d41" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="707aac35-e78a-4428-9640-f6a82372cda0" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;No AMF Registration for 3GPP Access Requests sent&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="d48cf678-c401-4d47-87ff-1466bf686474" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="f70ba97e-012e-4537-b742-44ebb0558b9e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = headers_http2_index_lst.pop(0)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="de6cddc3-6571-4190-8582-4ade9c3ca8a4" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>amf_path = amf_path.format(supi_value)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4e330e9b-5724-4c21-a042-c9f37d7615fd" action="command" session="s4">
                                    <command>
                                        <body>query details [number_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;tcp.ack&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>tcp_ack</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>count(details/item[field = &quot;http2.headers.path&quot;])</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == 0</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>No AMF Registration for 3GPP Access Requests sent</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.path&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_path</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.method&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_method</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="064660aa-e963-46fe-91c2-cab5a8fb2461" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:AMF Registration for 3GPP Access Request</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">AMF Registration for 3GPP Access Request</message>
                                    </applicationProperties>
                                </item>
                                <item guid="ad768430-9243-47c1-abc8-3beef8a13d65" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>amf_path in header_path and header_method == amf_method:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="cca0b40c-a34b-415e-818a-b57d102ce367" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:    Mandatory IE Validation:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">    Mandatory IE Validation:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="917c3eaf-dc42-4789-ace3-b44c49247d8f" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;amfInstanceId&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE amfInstanceId: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE amfInstanceId: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;deregCallbackUri&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE deregCallbackUri: Expected Cardinality: 1, Actual Cardinality: [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE deregCallbackUri: Expected Cardinality: 1, Actual Cardinality: [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;guami&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE guami: Expected Cardinality: 1, Actual Cardinality: [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE guami: Expected Cardinality: 1, Actual Cardinality: [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;ratType&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE ratType: Expected Cardinality: 1, Actual Cardinality: [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE ratType: Expected Cardinality: 1, Actual Cardinality: [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="27d69fd3-4c78-455a-a77b-6df133c08ee3" action="else" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="7ccb8c41-5210-487f-8b09-c95189a1ae3a" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;AMF Registration for 3GPP Access Requests is required in message sequence, but another mesage is found&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="19bff38a-9797-4840-a698-d4ab6a2280ec" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="be8ffdff-eb2e-4567-afa8-ee4a853b8cf6" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check response for Amf3GppAccessRegistration</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="179fe7b8-c148-41dd-a9da-f4b5af9bb86d" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="ebd002cf-53dd-4e27-89bf-5a5a1f02ea40" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message &quot;No AMF Registration for 3GPP Access responded&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="874bb30c-63da-4f55-a570-47a8c55206bd" action="return">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="2b5b74b5-f5b6-4ecd-ab92-7240e1624b77" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id = headers_http2_index_lst.pop(0)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="66e5732d-6aac-4bd4-88e0-d03caddfc132" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;tcp.seq&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == int(tcp_ack)</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>5G AKA Confirmation received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>http2.headers.status</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>No responses for AMF Registration for 3GPP Access</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;http2.headers.status&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>status</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="887b7ece-2d29-4443-be35-936ff6c04b2f" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:AMF Registration for 3GPP Access&apos;s Response:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">AMF Registration for 3GPP Access&apos;s Response:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="b0c2d44e-d655-4e18-b277-e52d8d4192cd" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;200&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="b201e19e-a2ca-49bc-adf0-a850736b4d9b" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:    200 OK</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">    200 OK</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="5f06d8c3-8b34-4ae2-b97a-33af9d44e2bd" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;201&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="195fe4ee-1083-4a98-96f1-c591c86dcf01" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:    201 Created</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">    201 Created</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="c0315054-0f4c-4ef3-8b39-ef9980454303" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;204&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="1e273027-464f-4762-ab72-86a78825b80a" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Warning:    204 No Content</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">Warning</severity>
                                                        <message inherit="false">    204 No Content</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="1624a365-7b2c-4119-9acf-40aa57914d65" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;403&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="a275dd7e-9a50-4941-bc93-e357becfd369" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    403 Forbidden&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="91d36840-ab6a-4854-a4bd-045800ad1e41" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="95693672-673f-4903-9d71-a8f295815740" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="3fa5b77e-4f04-4db9-bde4-21a4c90ddd21" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    Status Code: {0}&quot;.format(status)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="f129ee82-7f61-463c-937c-1e41bbf369b8" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="05fc63a8-88a8-449d-98da-dbc884dabda7" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Verify procedure: Retrieve Multiple Data Sets</body>
                            </command>
                            <nestedSteps>
                                <item guid="843b7f8a-e0d7-488f-9f51-13f9b7521e7c" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="db370a37-d7d1-49dc-b73b-0f2578b19fd3" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;No Multi-Data Sets Retrieval Requests sent&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="493acbd1-8c71-4396-9915-0ed1bfbb77bb" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="0123f17f-7d2e-4f76-8da6-646f9e1ac235" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = headers_http2_index_lst.pop(0)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="b9c4d139-5809-4053-91b6-05a9199f253a" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>am_subscription_data_path = &quot;/{0}?dataset-names=AM,SMF_SEL&quot;.format(supi_value)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4bc144b3-5000-4fbb-a76a-e45f3091e9e3" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>am_subscription_data_method = &quot;GET&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4c318b62-3824-4da0-a459-8ffc5d453459" action="command" session="s4">
                                    <command>
                                        <body>query details [number_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;tcp.ack&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>tcp_ack</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>count(details/item[field = &quot;http2.headers.path&quot;])</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == 0</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>No Multi-Data Sets Retrieval Requests sent</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                        </actionsWhenTrue>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.path&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_path</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.method&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_method</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c1aacae4-2a2b-4402-8bcb-f7a8434cb3b2" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:Multi-Data Sets Retrieval Request</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">Multi-Data Sets Retrieval Request</message>
                                    </applicationProperties>
                                </item>
                                <item guid="36b81914-6e10-4f08-b276-16dd1674f2fb" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>am_subscription_data_path in header_path and am_subscription_data_method == header_method:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="706fedf2-8713-40f3-8482-2e0458ad2483" action="message" skip="true" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="39c18054-af7e-493a-9967-8de7af81471b" action="else" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="d5bf2258-6388-43b3-9313-638e01524d2f" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;Multi-Data Sets Retrieval Requests is required in message sequence, but another mesage is found&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="172307a0-7248-4763-a083-66bf49d5c142" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="4179511c-434d-4ab1-918a-5f2e463e3f14" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check response for Multi-Data Sets Retrieval Requests</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="0cb3c912-c4c7-49af-9d18-a8418399ecba" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="7e2bc352-d9ac-4dc0-b2eb-adfd7c64022a" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message &quot;No response for Multi-Data Sets Retrieval Requests&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="50b31874-4562-4908-ad96-64a923f12b30" action="return">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b5d90d86-8675-4ced-a8c5-57dfdf6aea3b" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id = headers_http2_index_lst.pop(0)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ec02e653-e3fe-488f-b8a9-f04509c971da" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;tcp.seq&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == int(tcp_ack)</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>5G AKA Confirmation received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>http2.headers.status</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>Multi-Data Sets Retrieval Requests received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;http2.headers.status&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>status</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;tcp.ack&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>tcp_ack</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="daafa11a-93ca-4aee-8518-34f8b4b11167" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:Multi-Data Sets Retrieval&apos;s Response:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <severity inherit="false" defaultValue=""/>
                                                <message inherit="false">Multi-Data Sets Retrieval&apos;s Response:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="07aa3138-a860-40ba-9346-9056941e8b88" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;200&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="e235ec3e-f1cc-4905-903f-6e576d05d034" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:    200 OK</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">    200 OK</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="98a8b9bd-67b3-4424-9f68-faf8848149e9" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="65207e33-ca26-4a45-8bcc-06473e9ef64a" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    Status Code: {0}&quot;.format(status)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="e9f8ddee-61e1-4814-b44e-3f81b4542192" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="c44295e6-42c6-4d07-a094-edc6e37a558d" action="comment" useFieldsInCommand="false">
                            <command>
                                <body>Find and verify SdmSubscription</body>
                            </command>
                            <nestedSteps>
                                <item guid="4c5802f9-254d-4ac9-a3b6-a656ebfc7e2a" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="563daef9-32c0-4822-86d5-3e9a8ec1ce8c" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;No SDM Subscribe Requests sent&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="77713c2a-d256-4be7-9067-426585162903" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="7ba77cd5-57a1-43fe-8063-7686d6596bdb" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>number_id = headers_http2_index_lst.pop(0)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="c36fd4d1-1653-4550-b18e-d15ffbc6fd21" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>sdm_sub_path = &quot;/{0}/sdm-subscriptions&quot;.format(supi_value)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="5553cf52-8dfd-41fe-8e0e-a81eb44b2deb" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>sdm_sub_method = &quot;POST&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="6f30ee9f-2b1c-49fc-8282-84d455c5e031" action="command" session="s4">
                                    <command>
                                        <body>query details [number_id]</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;tcp.seq&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == int(tcp_ack)</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>5G AKA Confirmation received no responses</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="contains">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                        <searchString>http2.headers.path</searchString>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>value == 1</expression>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>No SDM Subscribe Requests sent</message>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="ExitProcedure">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                            </item>
                                                            <item actionId="SkipRemainingRules">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.path&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_path</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>details/item[field = &quot;http2.headers.method&quot;]/value</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="store">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                        <storageLocation>header_method</storageLocation>
                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="bd381b99-8f40-4f2b-89aa-ff8380703f89" action="message" useFieldsInCommand="false">
                                    <command>
                                        <body>Information:SDM Subscribe Request</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                        <message inherit="false">SDM Subscribe Request</message>
                                    </applicationProperties>
                                </item>
                                <item guid="0ac5cdad-447f-493c-92dc-be95b52b568f" action="if" useFieldsInCommand="false">
                                    <command>
                                        <body>sdm_sub_path in header_path and sdm_sub_method == header_method:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="729bf326-8893-4911-84f3-9082c9f050e2" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:    Mandatory IE Validation:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <severity inherit="false" defaultValue=""/>
                                                <message inherit="false">    Mandatory IE Validation:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="793f78e8-e16f-47fb-ad6f-75bf89daffe5" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;nfInstanceId&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) == 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE nfInstanceId: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE nfInstanceId: Expected Cardinality 1, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;callbackReference&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) &gt;= 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE callbackReference: Expected Cardinality 1..N, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE callbackReference: Expected Cardinality 1..N, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>count(details/item[value = &quot;monitoredResourceUris&quot;])</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>int(value) &gt;= 1</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>        IE monitoredResourceUris Expected Cardinality 1..N, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>        IE monitoredResourceUris Expected Cardinality 1..N, Actual Cardinality [value]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="9f64aa28-dc2d-484b-be6b-059e93a8f93a" action="else" useFieldsInCommand="false">
                                    <nestedSteps>
                                        <item guid="91855085-cf58-423a-9129-fc2391be34f5" action="call" useFieldsInCommand="false">
                                            <command>
                                                <body>execute_fail_message -message &quot;SDM Subscribe Requests is required in message sequence, but another mesage is found&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="55789843-9a0a-4c1c-bf22-6b0da84d2a4a" action="return">
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="369cb48c-0d1e-4335-9555-045916758ec1" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Check response for SdmSubscription</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="e2378be9-e976-4ab4-9e5a-2e38f9b230c2" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>len(headers_http2_index_lst) &lt;= 0:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="83362403-e1d1-4711-9508-384b39a7c98a" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message &quot;No SDM Subscribe Requests sent&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="9733963d-61e2-42fe-b9c2-cdc3d521f5e6" action="return">
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="a677aa27-f850-412c-964b-7fbdcc727209" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>number_id = headers_http2_index_lst.pop(0)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="f6f5fc02-0917-4556-adb6-e83abbcde43e" action="command" session="s4">
                                            <command>
                                                <body>query details [number_id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="contains">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                                                <searchString>http2.headers.status</searchString>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == 1</expression>
                                                                <actionsWhenFalse>
                                                                    <item actionId="FailTest">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>SDM Subscribe Requests received no responses</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="SkipRemainingRules">
                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>details/item[field = &quot;http2.headers.status&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>status</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="60e154af-fcca-491d-b9e6-fb5bae3c8be9" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:SDM Subscribe&apos;s Response:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <severity inherit="false" defaultValue=""/>
                                                <message inherit="false">SDM Subscribe&apos;s Response:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="9cb4dc64-7c6c-4eef-8ee9-52abf3a275df" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;201&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="47b126d5-8766-4925-b29c-1e64e5242be7" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>OK:    201 Created</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">OK</severity>
                                                        <message inherit="false">    201 Created</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="747bdf7a-8fdf-432c-a526-d025ca07e2a0" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;204&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="17e7821b-f2f2-4c05-b99e-9cb6de107406" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    404: Not Found&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="7f1a1e1d-1072-41ba-99c6-0a1439b8c12f" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="7b417122-3603-410b-8941-558f0c922f4f" action="elif" useFieldsInCommand="false">
                                            <command>
                                                <body>status == &quot;501&quot;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="14d5fc05-30b5-4a92-9126-e37d296df2df" action="message" useFieldsInCommand="false">
                                                    <command>
                                                        <body>Warning:    501 Not Implemented</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                        <severity inherit="false">Warning</severity>
                                                        <message inherit="false">    501 Not Implemented</message>
                                                    </applicationProperties>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="4e85a06d-6e71-44ce-b6aa-6962d1dbddfd" action="else" useFieldsInCommand="false">
                                            <nestedSteps>
                                                <item guid="40a69d3b-ef4c-4df2-9a9b-67c301be254e" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>failed_message = &quot;    Status Code: {0}&quot;.format(status)</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="1072652b-fd0c-4e83-bc08-53bcf3d4ee10" action="call" useFieldsInCommand="false">
                                                    <command>
                                                        <body>execute_fail_message -message [failed_message]</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="896e3db6-9422-4e82-b7eb-c2898e607b9a" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Validate messages counter in pcap</body>
                    </command>
                    <nestedSteps>
                        <item guid="9bdb119a-3238-45e2-b429-01a07f7f05f8" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>filters = &apos;http2.headers.path contains \\\\&quot;{0}\\\\&quot; &amp;&amp; http2.headers.method == {1}&apos;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="70dccae5-78e7-4509-a0ec-a4ee925b1fd3" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>ue_authentication_info_filter = filters.format(auth_info_path, auth_info_method)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="171fae77-007b-4fce-b249-9e724d5c84db" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>x5g_aka_confirm_filter = filters.format(confirm_data_path, confirm_data_method)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e88c2e36-b795-41f0-be00-fbe9d3c6191d" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>amf_3gpp_access_filter = filters.format(amf_path, amf_method)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e1e7ce0c-7a4b-485c-b59f-0f99395df467" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>multi_data_set_retrieval_filter = filters.format(am_subscription_data_path, am_subscription_data_method)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="39739610-0bc3-445b-ba9a-2371858dfbe7" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>sdm_sub_filter = filters.format(sdm_sub_path, sdm_sub_method)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="3d66b21d-257e-4f3c-85cc-7d3045389626" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>filter_map = { ue_authentication_info_filter: &quot;    Create UE Authentication Context Requests: Expected 1, Actual {0}&quot;, x5g_aka_confirm_filter: &quot;    5G Aka Confirms: Expected 1, Actual {0}&quot;, amf_3gpp_access_filter: &quot;    AMF Registration for 3GPP Access Requests: Expected 1, Actual {0}&quot;, multi_data_set_retrieval_filter: &quot;    Multi-Data Sets Retrieval Requests: Expected 1, Actual {0}&quot;, sdm_sub_filter: &quot;    SDM Subscribe Requests: Expected 1, Actual {0}&quot; }</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="e5344f6a-bbaf-40d8-9bb9-4badbd514b23" action="call" useFieldsInCommand="false">
                            <command>
                                <body>project://ai_LS_5G/utility_library/utils.fftc#insert_devider_string -length 50</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="028b2e2f-4bb3-4efc-8b83-290d12d163e5" action="message" useFieldsInCommand="false">
                            <command>
                                <body>Information:Validate AUSF Producer &amp; UDM Producer message counters in pcap</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                <message inherit="false">Validate AUSF Producer &amp; UDM Producer message counters in pcap</message>
                            </applicationProperties>
                        </item>
                        <item guid="7a97952f-5573-428a-8a38-1b3f2f70ff90" action="for" useFieldsInCommand="false">
                            <command>
                                <body>filter, message in filter_map.items():</body>
                            </command>
                            <nestedSteps>
                                <item guid="5dbc088a-5046-46aa-958c-24d4c46b8a93" action="command" session="s4">
                                    <command>
                                        <body>query filter set &quot;[filter]&quot;</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="083b9207-e924-4ca7-9e18-33d53cd4b2ed" action="command" session="s4">
                                    <command>
                                        <body>query packets</body>
                                    </command>
                                    <postProcessing>
                                        <analysisRules>
                                            <item>
                                                <extractorInfo extractorType="query">
                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                        <query>rowCount()</query>
                                                    </extractorProperties>
                                                </extractorInfo>
                                                <processorInfo ruleType="assert">
                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                        <expression>int(value) == 1</expression>
                                                        <actionsWhenTrue>
                                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>message = message.format(value)</statement>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                    <message>[message]</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenTrue>
                                                        <actionsWhenFalse>
                                                            <item actionId="FailTest">
                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                            </item>
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>message =message.format(value)</statement>
                                                                </actionProperties>
                                                            </item>
                                                            <item actionId="DeclareExecutionIssue">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                    <message>[message]</message>
                                                                </actionProperties>
                                                            </item>
                                                        </actionsWhenFalse>
                                                    </ruleProperties>
                                                </processorInfo>
                                            </item>
                                        </analysisRules>
                                    </postProcessing>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2405f034-bc5d-4f79-b77a-542b7116dfdd" action="return">
                    <command>
                        <body>true</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="pcap_file">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="verify_ngap_message" isPublic="true">
            <steps>
                <item guid="4f8986d3-7abb-4767-b322-c5a9bc1bf35a" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>should_continue = True</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="bb05d101-a9ff-4daf-95bd-35cfb0637873" action="while" useFieldsInCommand="false">
                    <command>
                        <body>should_continue:</body>
                    </command>
                    <nestedSteps>
                        <item guid="94f5ca3b-1a43-4ee3-a8fc-92f0f8662622" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>number_id += 1</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="9bad4e37-3a6f-4d70-9432-eac196fd8ce3" action="command" session="s4">
                            <command>
                                <body>query details [number_id]</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(details/item)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>count</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>count(details/item)</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == 0</expression>
                                                <actionsWhenTrue>
                                                    <item actionId="Continue">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenTrue>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>details/item[field = &quot;ngap.procedureCode&quot;]/value</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == int(proc_code)</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>[failed_message]</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="Break">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="SkipRemainingRules">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query sub="true">count(details/item\\[field = &quot;nas_5gs.mm.message_type&quot; and value = [msg_type]])</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>int(value) == 1</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>[failed_message]</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="Break">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="7d11cd10-8f92-4756-91e8-59c29d8369ff" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>should_continue = False</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="1511d397-3a79-4c9e-9964-104889914570" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Return a list of: is_success, next_number_id</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="e7562f07-1c5a-42b3-a860-5e381efd0aa6" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>returned_lst = [not should_continue, number_id]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="5902294a-acb7-47a8-a2de-1e9cc278a950" action="return">
                    <command>
                        <body>[returned_lst]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="number_id">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="proc_code">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="msg_type">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="failed_message"/>
            </arguments>
        </item>
        <item name="verify_http2_message" isPublic="true">
            <steps>
                <item guid="437323c6-320b-462e-ae52-7f0c6c4454ee" action="command" session="s4">
                    <command>
                        <body>query filter set &quot;http2.headers.path contains \\&quot;[path]\\&quot; &amp;&amp; http2.headers.method == [method]&quot;</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="be6ab625-be1f-4991-b6d1-aa10c62317d7" action="command" session="s4">
                    <command>
                        <body>query packets</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(messages/item)</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>count</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(messages/item)</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>int(value) != 1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="SkipRemainingRules">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                        </actionsWhenTrue>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>messages/item/id</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>number_id</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="87e2e234-ac06-4041-ab3b-28e873ef8633" action="if" useFieldsInCommand="false">
                    <command>
                        <body>int(count) != 1:</body>
                    </command>
                    <nestedSteps>
                        <item guid="c184b0fc-3f0d-4ad6-a482-43bddec3d993" action="call" useFieldsInCommand="false">
                            <command>
                                <body>execute_fail_message -message [failed_message] -should_exit &quot;false&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ea7e92c8-f246-4654-b728-6b2fc4229090" action="return">
                            <command>
                                <body>-1</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="805bd6cb-d4a7-420b-83d7-5653a503bd0a" action="return">
                    <command>
                        <body>[number_id]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="path">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="method">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="failed_message">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="check_if_DL_NAS_transport_IEs_present" isPublic="true">
            <steps>
                <item guid="b35ee194-dc3a-4785-99e6-aa2373c122fe" action="message" useFieldsInCommand="false">
                    <command>
                        <body>Information:    Downlink NAS Transport IE Validation:</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                        <message inherit="false">    Downlink NAS Transport IE Validation:</message>
                    </applicationProperties>
                </item>
                <item guid="06252a67-e445-4f41-9229-2f9878dcfe4a" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>has_ie_failed = False</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="dcb74cdc-7243-45b4-a554-cb3d06c164ad" action="command" session="s4">
                    <command>
                        <body>query details [number_id]</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="contains">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                        <searchString>[procedure_code]</searchString>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>value == 1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        IE Message Type is present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        IE Message Type is NOT present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>has_ie_failed = True</statement>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="contains">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                        <searchString>ngap.AMF_UE_NGAP_ID</searchString>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>value == 1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        IE AMF UE NGAP ID is present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        IE AMF UE NGAP ID is NOT present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>has_ie_failed = True</statement>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="contains">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                        <searchString>ngap.RAN_UE_NGAP_ID</searchString>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>value == 1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        IE RAN_UE_NGAP_ID is present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        IE RAN_UE_NGAP_ID is NOT present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>has_ie_failed = True</statement>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="contains">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.ExtractorContainsPropertyGroup">
                                        <searchString>ngap.NAS_PDU</searchString>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>value == 1</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        IE NAS-PDU is present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        IE NAS-PDU is NOT present in DL NAS Transport</message>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>has_ie_failed = True</statement>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(details/item[field = &quot;ngap.procedureCode&quot;]/preceding-sibling::*) + 1</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>proc_code_index</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(details/item[field = &quot;ngap.AMF_UE_NGAP_ID&quot;]/preceding-sibling::*) + 1</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>amf_ue_index</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(details/item[field = &quot;ngap.RAN_UE_NGAP_ID&quot;]/preceding-sibling::*) + 1</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>ran_ue_index</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(details/item[field = &quot;ngap.NAS_PDU&quot;]/preceding-sibling::*) + 1</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>nas_pdu_index</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="a66e8abe-336f-4d1b-8076-8db5a74fbecb" action="if" useFieldsInCommand="false">
                    <command>
                        <body>has_ie_failed:</body>
                    </command>
                    <nestedSteps>
                        <item guid="6917178d-eb9d-4bbb-a973-74d16b35e499" action="return">
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="b695c9cb-e3ed-444f-9c3c-b82fe3ac1505" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>Reject_Criticality = 0</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="90aebc8e-aaa2-4adc-9d84-c57690f0b8cc" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>Ignore_Criticality = 1</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="32946874-ac97-4117-b722-3ca350360d04" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>criticality_map = { Reject_Criticality: &quot;reject&quot;, Ignore_Criticality: &quot;ignore&quot; }</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="e01a4352-b438-426b-8b99-c1697f3adf0c" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>proc_code_assigned_criticality_index = int(proc_code_index) + 2</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="2a85c0b0-20a4-4a1b-b15a-31f138e0b2e2" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>amf_ue_assigned_criticality_index = int(amf_ue_index) - 3</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="3f0c8bd5-06cb-4190-ba18-5afb89a05f0c" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>ran_ue_assigned_criticality_index = int(ran_ue_index) - 3</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="81283f1d-7eca-42d7-b5cd-4e12ff1e7c57" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>nas_pdu_assigned_criticality_index = int(nas_pdu_index) - 4</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="eb4f6542-df1c-442d-aced-91a0b0849947" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>actual_value = &quot;&quot;</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="8f6941a1-cd30-4c0b-ae8a-ec655dd998d1" action="message" useFieldsInCommand="false">
                    <command>
                        <body>Information:    Assigned Criticality Validation:</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                        <message inherit="false">    Assigned Criticality Validation:</message>
                    </applicationProperties>
                </item>
                <item guid="57bfa776-be4e-41d7-9824-ab3753cff417" action="command" session="s4">
                    <command>
                        <body>query details [number_id]</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query sub="true">details/item\\[[proc_code_assigned_criticality_index]]/value</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>int(value) == int(Ignore_Criticality)</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Ignore_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        ProcedureCode: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Ignore_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        ProcedureCode: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query sub="true">details/item\\[[amf_ue_assigned_criticality_index]]/value</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        AMF UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        AMF UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query sub="true">details/item\\[[ran_ue_assigned_criticality_index]]/value</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        RAN UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        RAN UE NGAP ID: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query sub="true">details/item\\[[nas_pdu_assigned_criticality_index]]/value</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>int(value) == int(Reject_Criticality)</expression>
                                        <actionsWhenTrue>
                                            <item actionId="PassTestIfNotAlreadyFailed">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                    <message>        NAS-PDU: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>actual_value = criticality_map[int(value)]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="Eval">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                    <statement>expected_value = criticality_map[Reject_Criticality]</statement>
                                                </actionProperties>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>        NAS-PDU: Expected &quot;[expected_value]&quot;, Actual &quot;[actual_value]&quot;</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="number_id">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="procedure_code">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="execute_fail_message" isPublic="true">
            <steps>
                <item guid="514ecca4-3fb3-4a21-846c-3f987bccf4d0" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>print(message)</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>isEmpty()</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="assert">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                        <expression>value == &quot;true&quot;</expression>
                                        <actionsWhenTrue>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>[message]</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenTrue>
                                        <actionsWhenFalse>
                                            <item actionId="FailTest">
                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                            </item>
                                            <item actionId="DeclareExecutionIssue">
                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                    <message>[message]</message>
                                                </actionProperties>
                                            </item>
                                        </actionsWhenFalse>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="message">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
            <response>{}</response>
        </item>
        <item name="get_supi_value" isPublic="true">
            <steps>
                <item guid="cf7abcd8-cc5b-429e-8106-39219a2aeca7" action="command" session="s4">
                    <command>
                        <body>query details [number_id]</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(details/item[value = &quot;supiOrSuci&quot;]/preceding-sibling::*) + 1</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>key_index</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>count(details/item[field = &quot;json.value.string&quot;])</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>count</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="1e948644-7a20-437b-b57b-b3480b4e7ade" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>key_index = int(key_index)</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="49d1aea9-268c-4f19-b19a-fe2b397c5940" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>index = 0</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="a40efff5-e977-4a6e-9dcd-604f564e9762" action="for" useFieldsInCommand="false">
                    <command>
                        <body>i in range(1, int(count) + 1):</body>
                    </command>
                    <nestedSteps>
                        <item guid="f2350854-6afb-4807-8e43-b2a1f00670fa" action="command" session="s4">
                            <command>
                                <body>query details [number_id]</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query sub="true">count(details/item\\[field = &apos;json.value.string&apos;]\\[[i]]/preceding-sibling::*) + 1</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>value_index</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="8c5cad7d-13be-45ca-a11c-9bf5cdfdf2cf" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>value_index = int(value_index)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="ea01e925-c378-4a31-ae0c-5b38b4c19ad5" action="if" useFieldsInCommand="false">
                            <command>
                                <body>value_index &lt; key_index and value_index &gt; index:</body>
                            </command>
                            <nestedSteps>
                                <item guid="d7e7a79d-2fcd-468b-a8ce-6b029f323a45" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>index = value_index</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="899e2063-3219-45fa-8f5c-fc4024cee66b" action="command" session="s4">
                    <command>
                        <body>query details [number_id]</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query sub="true">details/item\\[[index]]/value</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="store">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                        <storageLocation>value</storageLocation>
                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="aa151de9-b46f-4ae3-8fe4-52866cc4a5c9" action="return">
                    <command>
                        <body>[value]</body>
                    </command>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="number_id">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
        <item name="extract_from_mesurements" isPublic="true">
            <steps>
                <item guid="f3da3b5f-76b7-4be7-ab87-4991bdb851d4" action="eval" useFieldsInCommand="false">
                    <command>
                        <body>print(measurements)</body>
                    </command>
                    <postProcessing>
                        <analysisRules>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/NGAP/Initial_Context_Setup_Requests</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    initial Context Setup Requests: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">Initial_Context_Setup_Requests</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/MM/Authentication_Requests</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    Authentication Requests: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">Authentication_Requests</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/MM/Security_Mode_Commands</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    Security Mode Commands: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">Security_Mode_Commands</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/MM/Registration_Accepts</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    Registration Accepts: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">Registration_Accepts</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/AUSF_Producer/Create_UE_Authentication_Context_Requests</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    Create UE Authentication Context Requests: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">Create_UE_Authentication_Context_Requests</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/AUSF_Producer/x5G_Aka_Confirm</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    5G Aka Confirm: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">5G_Aka_Confirm</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/UDM_Producer/AMF_Registration_for_3GPP_Access_Requests</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    AMF Registration for 3GPP Access Requests: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">AMF_Registration_for_3GPP_Access_Requests</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/UDM_Producer/Multi-Data_Sets_Retrieval_Requests</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    Multi-Data Sets Retrieval Requests: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">Multi-Data_Sets_Retrieval_Requests</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                            <item>
                                <extractorInfo extractorType="query">
                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                        <query>mapped/Json/tabs/UDM_Producer/SDM_Subscribe_Requests</query>
                                    </extractorProperties>
                                </extractorInfo>
                                <processorInfo ruleType="message">
                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.MessageProcessorPropertyGroup" severity="Information">
                                        <message>    SDM Subscribe Requests: Expected 1, Actual {value}</message>
                                        <extractData>true</extractData>
                                        <tag sub="false">SDM_Subscribe_Requests</tag>
                                    </ruleProperties>
                                </processorInfo>
                            </item>
                        </analysisRules>
                    </postProcessing>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="measurements">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
        </item>
    </procedures>
</testCase>
