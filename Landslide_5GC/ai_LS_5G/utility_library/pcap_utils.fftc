<?xml version="1.0"?>
<testCase version="8.5.0.202104211757" entryPoint="query_request_response">
    <general>
        <isProcedureLibrary>true</isProcedureLibrary>
        <language>Python</language>
    </general>
    <procedures>
        <item name="query_request_response" isPublic="true" defaultSessionProfile="application:com.fnfr.svt.applications.wireshark">
            <steps>
                <item guid="700db741-82f4-49fd-940d-bde9f23c0a6b" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Parse response status</body>
                    </command>
                    <nestedSteps>
                        <item guid="e51d9dec-8cd3-4697-826a-9a7ffa7373e7" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>status_list = response_status.split(&quot;;&quot;)</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="dd031a0b-7d61-4d4b-8e44-24e9a8e6f6a8" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>response_status_list = {}</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="03f82f23-a8c4-444d-90a0-43383e13b298" action="for" useFieldsInCommand="false">
                            <command>
                                <body>res_status in status_list:</body>
                            </command>
                            <nestedSteps>
                                <item guid="aee3c4bb-4182-49e8-a05b-1ca2e34f5db0" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>parts = res_status.split(&quot;:&quot;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="fc1c9708-5dd2-4072-a94c-1ba3e81df103" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>response_status_list[parts[0]] = parts[1] </body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="338ece4c-72e1-48e5-a27d-cb838c3f71d6" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>Parse ies</body>
                    </command>
                    <nestedSteps>
                        <item guid="b76a1ed0-9967-4220-a0ee-74841a5e0dc0" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>request_ie_list = {}</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="f6dcd822-137e-4198-94b4-7134319a650f" action="if" useFieldsInCommand="false">
                            <command>
                                <body>info(&apos;exists&apos;, &apos;local&apos;, &apos;request_ies&apos;) and request_ies:</body>
                            </command>
                            <nestedSteps>
                                <item guid="1f350f57-5269-4ae5-8714-48163b12c904" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>ie_array = request_ies.split(&quot;;&quot;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="96c92b2e-661f-4c5d-95d8-f7213bace390" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>ie in ie_array:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="29facc4b-8bca-4f6d-a255-2cb4f08fbfbc" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>parts = ie.split(&quot;:&quot;)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="3499d0a7-92b1-427f-9fd5-730edc86c7a2" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>request_ie_list[parts[0]] = parts[1] </body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="52d437ad-add5-4d40-aaa2-2e57683e406c" action="eval" useFieldsInCommand="false">
                            <command>
                                <body>response_ie_list = {}</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="39b8f5af-99de-42be-87aa-f4a60199190a" action="if" useFieldsInCommand="false">
                            <command>
                                <body>info(&apos;exists&apos;, &apos;local&apos;, &apos;response_ies&apos;) and response_ies:</body>
                            </command>
                            <nestedSteps>
                                <item guid="2f510029-cb5a-4d1c-b8c4-04277704af63" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>ie_array = response_ies.split(&quot;;&quot;)</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                                <item guid="e7a8858c-d1d6-465a-bd78-5f1140f0bb3f" action="for" useFieldsInCommand="false">
                                    <command>
                                        <body>ie in ie_array:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="13ea52b9-fd44-493d-89ad-1bdfd19010d0" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>parts = ie.split(&quot;:&quot;)</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="b94edcef-46ca-4d1b-8a95-09f3a2b05f19" action="eval" useFieldsInCommand="false">
                                            <command>
                                                <body>response_ie_list[parts[0]] = parts[1] </body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
                <item guid="931017e9-62b4-44f7-b02d-b0b8348ccc22" action="comment" useFieldsInCommand="false">
                    <command>
                        <body>The Requests and Responses</body>
                    </command>
                    <nestedSteps>
                        <item guid="aba2e415-814b-4ecf-95a3-31252d20186f" action="command" session="[session]">
                            <command>
                                <body>query filter set &quot;[filter]&quot;</body>
                            </command>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="8741da99-8664-449f-83dd-e50fcdfc1966" action="command" session="[session]">
                            <command>
                                <body>query packets</body>
                            </command>
                            <postProcessing>
                                <analysisRules>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>success()</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="assert">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                <expression>value == &quot;true&quot;</expression>
                                                <actionsWhenFalse>
                                                    <item actionId="FailTest">
                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                    </item>
                                                    <item actionId="DeclareExecutionIssue">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                            <message>&quot;[tag_key]&quot; does not exist in pcap file</message>
                                                        </actionProperties>
                                                    </item>
                                                    <item actionId="ExitProcedure">
                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                    </item>
                                                </actionsWhenFalse>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                    <item>
                                        <extractorInfo extractorType="query">
                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                <query>messages/item/id</query>
                                            </extractorProperties>
                                        </extractorInfo>
                                        <processorInfo ruleType="store">
                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                <storageLocation>ids</storageLocation>
                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                            </ruleProperties>
                                        </processorInfo>
                                    </item>
                                </analysisRules>
                            </postProcessing>
                            <eventHandlers>
                                <item name="OnWiresharkCommandFailed">
                                    <item actionId="Eval">
                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                            <statement>id = &quot;&quot;</statement>
                                        </actionProperties>
                                    </item>
                                </item>
                            </eventHandlers>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="34e76dc5-1ecb-4278-b43f-7c6c9aca4e0c" action="if" useFieldsInCommand="false">
                            <command>
                                <body>not isinstance(ids, (list, tuple)):</body>
                            </command>
                            <nestedSteps>
                                <item guid="7e018ee3-04ed-4434-bc9c-bdf3b3dd1157" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>id_list = [ids]</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="1f223926-61cc-4926-96c0-5918a0e6941f" action="else" useFieldsInCommand="false">
                            <nestedSteps>
                                <item guid="dc1333b4-4b3e-413e-bd72-b7c6e8ff436e" action="eval" useFieldsInCommand="false">
                                    <command>
                                        <body>id_list = ids</body>
                                    </command>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                        <item guid="0ab8deab-603f-40be-b3b9-bdaea5954b9d" action="for" useFieldsInCommand="false">
                            <command>
                                <body>idx, id in enumerate(id_list):</body>
                            </command>
                            <nestedSteps>
                                <item guid="acf55f64-1757-4f3b-89c5-41652856c98b" action="comment" useFieldsInCommand="false">
                                    <command>
                                        <body>Validate Request and Response:</body>
                                    </command>
                                    <nestedSteps>
                                        <item guid="31e6fa73-c4e5-4a39-a100-9dafa9716475" action="message" useFieldsInCommand="false">
                                            <command>
                                                <body>Information:   Validate &quot;[tag_name]&quot; Request and Response&quot;:</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                <message inherit="false">   Validate &quot;[tag_name]&quot; Request and Response&quot;:</message>
                                            </applicationProperties>
                                        </item>
                                        <item guid="7fae4d95-669c-4248-af86-cd6e587bbb06" action="command" session="[session]">
                                            <command>
                                                <body>query filter set &quot;[filter]&quot;</body>
                                            </command>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="8bfdcbd0-2764-461d-a8e5-a6f35c0b445d" action="command" session="[session]">
                                            <command>
                                                <body>query details [id]</body>
                                            </command>
                                            <postProcessing>
                                                <analysisRules>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                <query>success()</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>value == &quot;true&quot;</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="Eval">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                            <statement>request_path = request_method = &quot;&quot;</statement>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                            <message>Cannot query packet [id]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                    <item actionId="ExitProcedure">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                <query>details/item[field = &quot;http2.headers.path&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>request_path</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                <query>details/item[field = &quot;http2.headers.method&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>request_method</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="none">
                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="assert">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                <expression>request_path != &quot;&quot; and request_method != &quot;&quot;</expression>
                                                                <actionsWhenTrue>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>    ----&gt; [id]. [request_method] [request_path]</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenTrue>
                                                                <actionsWhenFalse>
                                                                    <item actionId="DeclareExecutionIssue">
                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                            <message>      Message &quot;[tag_name]&quot; found in packet &quot;[id]&quot;</message>
                                                                        </actionProperties>
                                                                    </item>
                                                                </actionsWhenFalse>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                <query>details/item[field = &quot;tcp.ack_raw&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>request_ack_raw</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                    <item>
                                                        <extractorInfo extractorType="query">
                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                <query>details/item[field = &quot;tcp.nxtseq&quot;]/value</query>
                                                            </extractorProperties>
                                                        </extractorInfo>
                                                        <processorInfo ruleType="store">
                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                <storageLocation>request_nxtseq</storageLocation>
                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                            </ruleProperties>
                                                        </processorInfo>
                                                    </item>
                                                </analysisRules>
                                            </postProcessing>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="489a483f-95fe-4494-a205-85c55e0f1e13" action="if" useFieldsInCommand="false">
                                            <command>
                                                <body>request_nxtseq and validate_flow == &apos;true&apos;:</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="fbcf1f8f-6b20-45bd-989f-d9f7da2e60e5" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>tag_key = &quot;Response&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="94c4386f-6f3f-4231-a522-cdb67f0803bb" action="command" session="[session]">
                                                    <command>
                                                        <body>query filter set &quot;http2 &amp;&amp; tcp.seq_raw == [request_ack_raw]&quot;</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="d168563d-aa26-4b3f-923a-570672f0632a" action="command" session="[session]">
                                                    <command>
                                                        <body>query packets</body>
                                                    </command>
                                                    <postProcessing>
                                                        <analysisRules>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>success()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>value == &quot;true&quot;</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>&quot;[tag_key]&quot; does not exist in pcap file</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>rowCount()</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) == 1</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>&quot;[tag_key]&quot; found &quot;{value}&quot; in pcap file. Expected: 1</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>messages/item/id</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="assert">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                        <expression>int(value) &gt; int(id)</expression>
                                                                        <actionsWhenFalse>
                                                                            <item actionId="FailTest">
                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                            </item>
                                                                            <item actionId="DeclareExecutionIssue">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                    <message>&quot;[tag_key]&quot; message has wrong order. Message number: {value}</message>
                                                                                </actionProperties>
                                                                            </item>
                                                                            <item actionId="ExitProcedure">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                            </item>
                                                                        </actionsWhenFalse>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                            <item>
                                                                <extractorInfo extractorType="query">
                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                        <query>messages/item/id</query>
                                                                    </extractorProperties>
                                                                </extractorInfo>
                                                                <processorInfo ruleType="store">
                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                        <storageLocation>response_id</storageLocation>
                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                    </ruleProperties>
                                                                </processorInfo>
                                                            </item>
                                                        </analysisRules>
                                                    </postProcessing>
                                                    <eventHandlers>
                                                        <item name="OnWiresharkCommandFailed">
                                                            <item actionId="Eval">
                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                    <statement>id = &quot;&quot;</statement>
                                                                </actionProperties>
                                                            </item>
                                                        </item>
                                                    </eventHandlers>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="57f614d7-3f21-4e36-9414-05f67d60b7a0" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>info(&apos;exists&apos;, &apos;local&apos;, &apos;response_id&apos;) and response_id:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="98303cf8-d4dc-4db9-9e96-724e7bce7495" action="command" session="[session]">
                                                            <command>
                                                                <body>query details [response_id]</body>
                                                            </command>
                                                            <postProcessing>
                                                                <analysisRules>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                <query>success()</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>value == &quot;true&quot;</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>response_ack_raw = &quot;&quot;</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>Cannot query packet [id_1]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                                <query>details/item[field = &quot;http2.headers.status&quot;]/value</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>status</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="none">
                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>int(status) &gt;= 200 and int(status) &lt;= 210</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>ok_status = True</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>status_message = response_status_list[status]</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>ok_status = False</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="Eval">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                            <statement>status_message = response_status_list[status]</statement>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="none">
                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="assert">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                <expression>ok_status</expression>
                                                                                <actionsWhenTrue>
                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="OK">
                                                                                            <message>    &lt;---- [response_id]. [status] [status_message]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                </actionsWhenTrue>
                                                                                <actionsWhenFalse>
                                                                                    <item actionId="DeclareExecutionIssue">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                            <message>    &lt;---- [response_id]. [status] [status_message]</message>
                                                                                        </actionProperties>
                                                                                    </item>
                                                                                    <item actionId="FailTest">
                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                    </item>
                                                                                    <item actionId="ExitProcedure">
                                                                                        <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                    </item>
                                                                                </actionsWhenFalse>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                                <query>details/item[field = &quot;tcp.ack_raw&quot;]/value</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>response_ack_raw</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                    <item>
                                                                        <extractorInfo extractorType="query">
                                                                            <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup" declareNoMatchIssue="false">
                                                                                <query>details/item[field = &quot;tcp.nxtseq&quot;]/value</query>
                                                                            </extractorProperties>
                                                                        </extractorInfo>
                                                                        <processorInfo ruleType="store">
                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                <storageLocation>response_nxtseq</storageLocation>
                                                                                <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                            </ruleProperties>
                                                                        </processorInfo>
                                                                    </item>
                                                                </analysisRules>
                                                            </postProcessing>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                        <item guid="ab37b964-63a2-41c6-8a2d-4250fab8ed7f" action="comment" useFieldsInCommand="false">
                                            <command>
                                                <body>Validate IE</body>
                                            </command>
                                            <nestedSteps>
                                                <item guid="ce2431ce-c28e-474f-9777-e0847a7f6df1" action="eval" useFieldsInCommand="false">
                                                    <command>
                                                        <body>array_number = []</body>
                                                    </command>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="5ed65b7f-448b-43c2-8bbd-237c18bd2dac" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>len(request_ie_list) &gt; 0:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="6006972c-4cb2-47b6-aabd-ff73abdff430" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>array_number.append(1)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="78305613-b244-4dcd-bdd4-a0ec2fa20a71" action="if" useFieldsInCommand="false">
                                                    <command>
                                                        <body>len(response_ie_list) &gt; 0:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="b7cbade3-37de-4920-bbbd-641e660d23e9" action="eval" useFieldsInCommand="false">
                                                            <command>
                                                                <body>array_number.append(2)</body>
                                                            </command>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                                <item guid="0ce7f879-5233-41ec-a834-9bc3f2a9321f" action="for" useFieldsInCommand="false">
                                                    <command>
                                                        <body>i in array_number:</body>
                                                    </command>
                                                    <nestedSteps>
                                                        <item guid="67eb8ea1-1b40-4015-804f-512f622e57ac" action="if" useFieldsInCommand="false">
                                                            <command>
                                                                <body>i == 1:</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="6be162af-af64-4f27-9877-32492ed97673" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>ack_raw_number = request_ack_raw</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="f181f45a-b01c-40a4-ada8-d6c615b9b960" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>ie_list = request_ie_list</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="77b212b7-a353-4db5-a249-11c7db182ae8" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>object_name = request_object_name</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="d1e6b84c-2533-426a-8e39-38dad5f5dca9" action="else" useFieldsInCommand="false">
                                                            <nestedSteps>
                                                                <item guid="2c4887dd-9e73-441d-abd3-bc55de2408ae" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>ack_raw_number = response_ack_raw</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="c662c55a-c93a-4b30-8ee5-af04e8ec9e44" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>ie_list = response_ie_list</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="1fe54ef4-37e4-42f7-9b3e-d99053fd341e" action="eval" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>object_name = response_object_name</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                        <item guid="61a3cad0-11e9-4ab7-8304-daf5220521a1" action="comment" useFieldsInCommand="false">
                                                            <command>
                                                                <body>Validate IE in Packet</body>
                                                            </command>
                                                            <nestedSteps>
                                                                <item guid="f53eccc6-ebe3-40b2-9a72-e0468c51f15a" action="command" session="[session]">
                                                                    <command>
                                                                        <body>query filter set &quot;json &amp;&amp; tcp.ack_raw == [ack_raw_number]&quot;</body>
                                                                    </command>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="3ac30539-2630-4686-a930-9aa99ab067f8" action="command" session="[session]">
                                                                    <command>
                                                                        <body>query packets</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>success()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == &quot;true&quot;</expression>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="FailTest">
                                                                                                <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                            </item>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>&quot;[object_name]&quot; does not exist in pcap file</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                            <item actionId="ExitProcedure">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>messages/item/id</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="store">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.StoreProcessorPropertyGroup">
                                                                                        <storageLocation>request_ids</storageLocation>
                                                                                        <responseValue type="com.fnfr.documents.PropertyBoolean">false</responseValue>
                                                                                        <variable type="com.fnfr.documents.PropertyBoolean">true</variable>
                                                                                        <secret type="com.fnfr.documents.PropertyBoolean">false</secret>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="none">
                                                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>isinstance(request_ids, (list, tuple))</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="Eval">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                                    <statement>profile_id = id</statement>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="Eval">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                                    <statement>profile_id = request_ids</statement>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="none">
                                                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>[info(&apos;exists&apos;, &apos;local&apos;, &apos;object_name&apos;)] and object_name != &quot;&quot;</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="Eval">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                                    <statement>message = &apos;      Validate &quot;{0}&quot; in packet &quot;{1}&quot;:&apos;.format(object_name, profile_id)</statement>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="Eval">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                                    <statement>message = &apos;      Validate IE in packet &quot;{0}&quot;:&apos;.format(profile_id)</statement>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                            <item>
                                                                                <extractorInfo extractorType="none">
                                                                                    <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>len(ie_list) &gt; 0</expression>
                                                                                        <actionsWhenTrue>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup" severity="Information">
                                                                                                    <message>[message]</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                        </actionsWhenTrue>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                    </postProcessing>
                                                                    <eventHandlers>
                                                                        <item name="OnWiresharkCommandFailed">
                                                                            <item actionId="Eval">
                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.EvalActionPropertyGroup">
                                                                                    <statement>id = &quot;&quot;</statement>
                                                                                </actionProperties>
                                                                            </item>
                                                                        </item>
                                                                    </eventHandlers>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="f254beb1-172e-4a6f-8e32-8b783a8ef9a8" action="command" session="[session]">
                                                                    <command>
                                                                        <body>query details [profile_id] pdml</body>
                                                                    </command>
                                                                    <postProcessing>
                                                                        <analysisRules>
                                                                            <item>
                                                                                <extractorInfo extractorType="query">
                                                                                    <extractorProperties type="com.fnfr.svt.mapping.execution.extractors.QueryDataExtractorPropertyGroup">
                                                                                        <query>success()</query>
                                                                                    </extractorProperties>
                                                                                </extractorInfo>
                                                                                <processorInfo ruleType="assert">
                                                                                    <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                        <expression>value == &quot;true&quot;</expression>
                                                                                        <actionsWhenFalse>
                                                                                            <item actionId="DeclareExecutionIssue">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExecutionIssuePropertyGroup">
                                                                                                    <message>Cannot query packet [id_1]</message>
                                                                                                </actionProperties>
                                                                                            </item>
                                                                                            <item actionId="ExitProcedure">
                                                                                                <actionProperties type="com.fnfr.svt.execution.builtin.actions.ExitProcedurePropertyGroup"/>
                                                                                            </item>
                                                                                        </actionsWhenFalse>
                                                                                    </ruleProperties>
                                                                                </processorInfo>
                                                                            </item>
                                                                        </analysisRules>
                                                                        <storeResponseAt>response_pdml_xml</storeResponseAt>
                                                                    </postProcessing>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                                <item guid="1116f7a2-7079-40be-9737-b99679c8d2a2" action="for" useFieldsInCommand="false">
                                                                    <command>
                                                                        <body>ie_key in ie_list:</body>
                                                                    </command>
                                                                    <nestedSteps>
                                                                        <item guid="a07dbf02-3afc-436b-bc56-455029868616" action="if" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>&apos;.&apos; in ie_key:</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="6f34cac4-4ebe-45b5-9056-c9c4e007dad7" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>parts = ie_key.split(&apos;.&apos;)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="c348f28f-089c-40e8-b1d6-99ab7b1d8584" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>ie_parent = parts[0]</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="e48e0309-2ca6-4dee-a1f6-6ba1a811c9a3" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>ie_children = parts[1]</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="419f831b-d134-475f-9402-48b605e9fdba" action="eval" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>value = ie_list[ie_key]</body>
                                                                            </command>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="451cec43-8174-4414-8360-3c6aa00f3798" action="call" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>utils.fftc#is_number(input_str=value)</body>
                                                                            </command>
                                                                            <postProcessing>
                                                                                <storeResponseAt>is_number</storeResponseAt>
                                                                                <storeResponseText>true</storeResponseText>
                                                                            </postProcessing>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="81b529b8-5295-4c96-a2f7-547034aa2638" action="if" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>is_number or value.startswith(&apos;&quot;&apos;):</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="cb2fc6af-ea2e-41c9-b4ff-bb222f3d8ae4" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>value = value.replace(&apos;&quot;&apos;, &apos;&apos;)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="ad9f41d8-5f00-4fbb-8573-905655ebece8" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>&apos;.&apos; in ie_key:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="aeef8366-e13e-4460-a410-87e85299698d" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;]/..//field[@name=&quot;json.key&quot;][@show=&quot;{1}&quot;]/../field[@name=&quot;json.value.string&quot;]/@show&apos;.format(ie_parent, ie_children)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="ce4c887b-5049-402a-b465-a2c381045a7b" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="7d4f246c-ff8e-42e1-aa2b-eef08eedaa11" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;]/../field[@name=&quot;json.value.string&quot;]/@show&apos;.format(ie_key)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="8c87dc55-ff12-454d-ab7c-916d7a1fffd9" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>ie_value = query(&apos;response_pdml_xml&apos;,query_path);print(ie_value)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="deedc3ad-e0c5-4ee5-a5c6-20f40252f6cd" action="call" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>utils.fftc#is_number(input_str=ie_value)</body>
                                                                                    </command>
                                                                                    <postProcessing>
                                                                                        <storeResponseAt>is_ie_value_number</storeResponseAt>
                                                                                        <storeResponseText>true</storeResponseText>
                                                                                    </postProcessing>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="2385a345-6750-40d4-a85f-523622b7d1fb" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>(is_number and is_ie_value_number and ie_value and  int(value) == int(ie_value)) or ie_value == value:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="cfccba74-d1a3-49af-a35d-81957f3e907d" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>OK:          IE &quot;[ie_key]&quot; is present. Expected &quot;[value]&quot;, actual: &quot;[ie_value]&quot;</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">OK</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present. Expected &quot;[value]&quot;, actual: &quot;[ie_value]&quot;</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="5d4d8cf6-02b4-4723-bfe2-ea8f3d7bb27b" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="1fd433a1-8803-48f5-b261-b55fb00f572f" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>Error:          IE &quot;[ie_key]&quot; is NOT present. Expected &quot;[value]&quot;, actual: &quot;[ie_value]&quot;</body>
                                                                                            </command>
                                                                                            <postProcessing>
                                                                                                <analysisRules>
                                                                                                    <item>
                                                                                                        <extractorInfo extractorType="none">
                                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                                        </extractorInfo>
                                                                                                        <processorInfo ruleType="assert">
                                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                                <expression>False</expression>
                                                                                                                <actionsWhenTrue>
                                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenTrue>
                                                                                                                <actionsWhenFalse>
                                                                                                                    <item actionId="FailTest">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenFalse>
                                                                                                            </ruleProperties>
                                                                                                        </processorInfo>
                                                                                                    </item>
                                                                                                </analysisRules>
                                                                                            </postProcessing>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">Error</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is NOT present. Expected &quot;[value]&quot;, actual: &quot;[ie_value]&quot;</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                        <item guid="a61141e5-4b30-44ff-85fa-005c83832620" action="exit" useFieldsInCommand="false">
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="defd973a-0e57-4b43-8b2c-cecdd7e050d8" action="elif" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>value == &apos;true&apos; or value == &apos;false&apos;:</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="b9352d43-fb74-4962-83e3-8d4ed9ddf87a" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>&apos;.&apos; in ie_key:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="6eaefcb9-f42f-4f06-9ce1-0747450eda7f" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;boolean(//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;]/..//field[@show=&quot;{1}&quot;])&apos;.format(ie_parent, ie_children)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="ca18b489-7331-4748-8407-4dfdea58bc20" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="ba54b924-952d-40cd-9347-935192abbe29" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;boolean(//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;])&apos;.format(ie_key)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="af1b0115-dbca-404f-91ed-95ad7f27999f" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>current_value = query(&apos;response_pdml_xml&apos;,query_path);print(current_value)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="380e295c-6a4d-4288-9cb5-b8e8160bc1d0" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>value == current_value:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="111aa0f6-1148-4399-a960-e44f3643c607" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>OK:          IE &quot;[ie_key]&quot; is present</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">OK</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="1b58f5f7-e93d-47d4-a78b-d6e49754fd7e" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="424162af-2bc0-4846-9166-42a699825321" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>Error:          IE &quot;[ie_key]&quot; is NOT present</body>
                                                                                            </command>
                                                                                            <postProcessing>
                                                                                                <analysisRules>
                                                                                                    <item>
                                                                                                        <extractorInfo extractorType="none">
                                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                                        </extractorInfo>
                                                                                                        <processorInfo ruleType="assert">
                                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                                <expression>False</expression>
                                                                                                                <actionsWhenTrue>
                                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenTrue>
                                                                                                                <actionsWhenFalse>
                                                                                                                    <item actionId="FailTest">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenFalse>
                                                                                                            </ruleProperties>
                                                                                                        </processorInfo>
                                                                                                    </item>
                                                                                                </analysisRules>
                                                                                            </postProcessing>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">Error</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is NOT present</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                        <item guid="6ea05507-ed90-4cc2-9242-5979538de0e6" action="exit" useFieldsInCommand="false">
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="3c4919e9-0228-4b9f-b26d-6c9bbc035f7f" action="elif" useFieldsInCommand="false">
                                                                            <command>
                                                                                <body>value.startswith(&quot;[&quot;) or value.startswith(&quot;(&quot;):</body>
                                                                            </command>
                                                                            <nestedSteps>
                                                                                <item guid="799bb515-576d-4926-b5b8-454f53ae4262" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>&apos;.&apos; in ie_key:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="cf173036-567c-43d8-bbce-c5bc24a33149" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;boolean(//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;])&apos;.format(ie_parent)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="55ad4139-dcbf-4998-840a-5190a90615ad" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="7243d26f-0752-4f53-823c-491c83861cf1" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;boolean(//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;])&apos;.format(ie_key)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="e28b1a9d-8aac-4643-b1bf-ae8adf199789" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>current_value = query(&apos;response_pdml_xml&apos;,query_path);print(current_value)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="c8169b4d-0e88-45ea-9b4d-8eb241650311" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>current_value == &quot;true&quot;:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="c31c1a43-ed9d-4fe3-8d70-4f74bdf4c344" action="if" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>&apos;.&apos; in ie_key:</body>
                                                                                            </command>
                                                                                            <nestedSteps>
                                                                                                <item guid="ccd880cc-dfdf-4024-9256-08e43e073393" action="eval" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>query_path = &apos;//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;]/..//field[@name=&quot;json.key&quot;][@show=&quot;{1}&quot;]/../field[@name=&quot;json.value.string&quot;]/@show&apos;.format(ie_parent, ie_children)</body>
                                                                                                    </command>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                            </nestedSteps>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                        <item guid="7a4955ab-9b2a-4d04-9755-554ce9cfa12d" action="else" useFieldsInCommand="false">
                                                                                            <nestedSteps>
                                                                                                <item guid="a079d926-3283-4794-8e27-c663d8f9d7d3" action="eval" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>query_path = &apos;//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;]/../field[@name=&quot;json.value.string&quot;]/@show&apos;.format(ie_key)</body>
                                                                                                    </command>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                            </nestedSteps>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                        <item guid="c2ff2fd9-be1c-423b-b137-93fbfff5125d" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>ie_value = query(&apos;response_pdml_xml&apos;,query_path);print(ie_value)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                        <item guid="4d0bd0a7-3546-4711-9a08-8f1631887b20" action="if" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>value.startswith(&quot;[&quot;):</body>
                                                                                            </command>
                                                                                            <nestedSteps>
                                                                                                <item guid="f7f334ce-f928-4414-9508-1363b6561bad" action="if" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>ie_value in value:</body>
                                                                                                    </command>
                                                                                                    <nestedSteps>
                                                                                                        <item guid="3cccc247-91b8-4136-88e5-605e9eef02b9" action="message" useFieldsInCommand="false">
                                                                                                            <command>
                                                                                                                <body>OK:          IE &quot;[ie_key]&quot; is present. Expected value in: [value], actual: &quot;[ie_value]&quot;</body>
                                                                                                            </command>
                                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                                <severity inherit="false">OK</severity>
                                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present. Expected value in: [value], actual: &quot;[ie_value]&quot;</message>
                                                                                                            </applicationProperties>
                                                                                                        </item>
                                                                                                    </nestedSteps>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                                <item guid="c8fe1e95-5df8-4261-9922-b7bb48994576" action="else" useFieldsInCommand="false">
                                                                                                    <nestedSteps>
                                                                                                        <item guid="0183e5bc-46c0-47be-938d-1c43bb0ca93a" action="message" useFieldsInCommand="false">
                                                                                                            <command>
                                                                                                                <body>Error:          IE &quot;[ie_key]&quot; is present. Expected value in&quot; [value], actual: &quot;[ie_value]&quot;</body>
                                                                                                            </command>
                                                                                                            <postProcessing>
                                                                                                                <analysisRules>
                                                                                                                    <item>
                                                                                                                        <extractorInfo extractorType="none">
                                                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                                                        </extractorInfo>
                                                                                                                        <processorInfo ruleType="assert">
                                                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                                                <expression>False</expression>
                                                                                                                                <actionsWhenTrue>
                                                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                                    </item>
                                                                                                                                </actionsWhenTrue>
                                                                                                                                <actionsWhenFalse>
                                                                                                                                    <item actionId="FailTest">
                                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                                    </item>
                                                                                                                                </actionsWhenFalse>
                                                                                                                            </ruleProperties>
                                                                                                                        </processorInfo>
                                                                                                                    </item>
                                                                                                                </analysisRules>
                                                                                                            </postProcessing>
                                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                                <severity inherit="false">Error</severity>
                                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present. Expected value in&quot; [value], actual: &quot;[ie_value]&quot;</message>
                                                                                                            </applicationProperties>
                                                                                                        </item>
                                                                                                        <item guid="3497c10e-3d2c-4184-83d4-1f86288d163d" action="exit" useFieldsInCommand="false">
                                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                        </item>
                                                                                                    </nestedSteps>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                            </nestedSteps>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                        <item guid="ffa60ab0-421b-4477-811a-f44b5e9bb541" action="else" useFieldsInCommand="false">
                                                                                            <nestedSteps>
                                                                                                <item guid="d9253377-55ac-42e6-92ca-5806aff77c49" action="eval" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>ranges = value.replace(&quot;(&quot;,&quot;&quot;).replace(&quot;)&quot;,&quot;&quot;).split(&quot;-&quot;)</body>
                                                                                                    </command>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                                <item guid="acc10a93-d34f-4527-a97f-e6c2c2e7f4bb" action="eval" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>min = int(ranges[0]);print(min)</body>
                                                                                                    </command>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                                <item guid="63d2d873-1a94-4d6b-ad6f-c6f727b6b80b" action="eval" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>max = int(ranges[1])  + 1;print(max)</body>
                                                                                                    </command>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                                <item guid="1d611266-ceac-47f1-9503-602c5fd9de1f" action="call" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>utils.fftc#is_number(input_str=ie_value)</body>
                                                                                                    </command>
                                                                                                    <postProcessing>
                                                                                                        <storeResponseAt>is_number</storeResponseAt>
                                                                                                        <storeResponseText>true</storeResponseText>
                                                                                                    </postProcessing>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                                <item guid="1aec2911-7d50-484d-8de6-72b0bb88d137" action="if" useFieldsInCommand="false">
                                                                                                    <command>
                                                                                                        <body>is_number and int(ie_value) in range(min, max):</body>
                                                                                                    </command>
                                                                                                    <nestedSteps>
                                                                                                        <item guid="96c9c9c9-5e02-446a-aa2d-f0458d5573b9" action="message" useFieldsInCommand="false">
                                                                                                            <command>
                                                                                                                <body>OK:          IE &quot;[ie_key]&quot; is present. Expected in range [value], actual: &quot;[ie_value]&quot;</body>
                                                                                                            </command>
                                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                                <severity inherit="false">OK</severity>
                                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present. Expected in range [value], actual: &quot;[ie_value]&quot;</message>
                                                                                                            </applicationProperties>
                                                                                                        </item>
                                                                                                    </nestedSteps>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                                <item guid="4fcf5182-bb3e-43e8-8b4a-cdc350a72e6e" action="else" useFieldsInCommand="false">
                                                                                                    <nestedSteps>
                                                                                                        <item guid="db1cb359-2032-423f-b98b-f4c56fa6df03" action="message" useFieldsInCommand="false">
                                                                                                            <command>
                                                                                                                <body>Error:          IE &quot;[ie_key]&quot; is present. Expected in range [value], actual: &quot;[ie_value]&quot;</body>
                                                                                                            </command>
                                                                                                            <postProcessing>
                                                                                                                <analysisRules>
                                                                                                                    <item>
                                                                                                                        <extractorInfo extractorType="none">
                                                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                                                        </extractorInfo>
                                                                                                                        <processorInfo ruleType="assert">
                                                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                                                <expression>False</expression>
                                                                                                                                <actionsWhenTrue>
                                                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                                    </item>
                                                                                                                                </actionsWhenTrue>
                                                                                                                                <actionsWhenFalse>
                                                                                                                                    <item actionId="FailTest">
                                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                                    </item>
                                                                                                                                </actionsWhenFalse>
                                                                                                                            </ruleProperties>
                                                                                                                        </processorInfo>
                                                                                                                    </item>
                                                                                                                </analysisRules>
                                                                                                            </postProcessing>
                                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                                <severity inherit="false">Error</severity>
                                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present. Expected in range [value], actual: &quot;[ie_value]&quot;</message>
                                                                                                            </applicationProperties>
                                                                                                        </item>
                                                                                                        <item guid="a66414c4-e4c0-49f9-b5c8-208789a3871c" action="exit" useFieldsInCommand="false">
                                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                        </item>
                                                                                                    </nestedSteps>
                                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                </item>
                                                                                            </nestedSteps>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="d020f059-ef17-4fe5-b10f-ce7be6fada9a" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="edd2dc65-8209-47b7-aed8-a72c0fd8c3fa" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>Error:          IE &quot;[ie_key]&quot; is NOT present</body>
                                                                                            </command>
                                                                                            <postProcessing>
                                                                                                <analysisRules>
                                                                                                    <item>
                                                                                                        <extractorInfo extractorType="none">
                                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                                        </extractorInfo>
                                                                                                        <processorInfo ruleType="assert">
                                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                                <expression>False</expression>
                                                                                                                <actionsWhenTrue>
                                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenTrue>
                                                                                                                <actionsWhenFalse>
                                                                                                                    <item actionId="FailTest">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenFalse>
                                                                                                            </ruleProperties>
                                                                                                        </processorInfo>
                                                                                                    </item>
                                                                                                </analysisRules>
                                                                                            </postProcessing>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">Error</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is NOT present</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                        <item guid="ebf08a79-ed08-4efd-857b-e3400ca57245" action="exit" useFieldsInCommand="false">
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                        <item guid="4c01bf87-9f72-40c9-9982-67faf3bd6aa1" action="else" useFieldsInCommand="false">
                                                                            <nestedSteps>
                                                                                <item guid="a10482b2-036a-4884-9fa1-005cb286c855" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>ranges = value.split(&quot;-&quot;)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="61cd777e-0661-40bc-a531-be5a748e3d84" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>min = int(ranges[0])</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="6137d287-8ab9-4589-bb12-eafe949578f5" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>ranges[1].lower() == &apos;n&apos;:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="c7ec0b2b-a9d6-4d84-a566-645cffa3d49f" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>max = 9223372036854775807</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="c0564b8f-baac-44b4-8928-bbdb22e328dc" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="6a987f0a-3b27-4ec1-b080-195ea66f4e3c" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>max = int(ranges[1]) +1</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="6dfcc2b8-bf51-4d03-85a4-ce5c72c47486" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>&apos;.&apos; in ie_key:</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="916cd709-434c-42c5-a190-4c249c29aaf3" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;count(//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;]/..//field[@show=&quot;{1}&quot;])&apos;.format(ie_parent, ie_children)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="2d3aba3c-77d6-43ae-8278-1cd0e1b451ba" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="92e2331a-2f5c-43c1-8e36-472622cdfe1b" action="eval" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>query_path = &apos;count(//proto[@name=&quot;json&quot;]//field[@name=&quot;json.key&quot;][@show=&quot;{0}&quot;])&apos;.format(ie_key)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="b36d0397-348d-422d-ae19-0341f01c2373" action="eval" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>current_value = query(&apos;response_pdml_xml&apos;,query_path);print(current_value)</body>
                                                                                    </command>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="8178b4ff-7cc0-4d69-b62c-6b8c46991836" action="if" useFieldsInCommand="false">
                                                                                    <command>
                                                                                        <body>int(current_value) in range(min, max):</body>
                                                                                    </command>
                                                                                    <nestedSteps>
                                                                                        <item guid="71b7f3c5-6d9a-4f54-aeaa-29f311f9f474" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>OK:          IE &quot;[ie_key]&quot; is present [current_value] time(s)</body>
                                                                                            </command>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">OK</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present [current_value] time(s)</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                                <item guid="3e2baa65-053d-41b1-9920-dae918ba6dbc" action="else" useFieldsInCommand="false">
                                                                                    <nestedSteps>
                                                                                        <item guid="aff3b4e9-5fef-46e2-ae6c-97e75b5a6e47" action="message" useFieldsInCommand="false">
                                                                                            <command>
                                                                                                <body>Error:          IE &quot;[ie_key]&quot; is present [current_value] time(s)</body>
                                                                                            </command>
                                                                                            <postProcessing>
                                                                                                <analysisRules>
                                                                                                    <item>
                                                                                                        <extractorInfo extractorType="none">
                                                                                                            <extractorProperties type="com.fnfr.svt.documents.EmptyExtractorPropertyGroup"/>
                                                                                                        </extractorInfo>
                                                                                                        <processorInfo ruleType="assert">
                                                                                                            <ruleProperties type="com.fnfr.svt.execution.builtin.processors.AssertionPropertyGroup">
                                                                                                                <expression>False</expression>
                                                                                                                <actionsWhenTrue>
                                                                                                                    <item actionId="PassTestIfNotAlreadyFailed">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenTrue>
                                                                                                                <actionsWhenFalse>
                                                                                                                    <item actionId="FailTest">
                                                                                                                        <actionProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                                                    </item>
                                                                                                                </actionsWhenFalse>
                                                                                                            </ruleProperties>
                                                                                                        </processorInfo>
                                                                                                    </item>
                                                                                                </analysisRules>
                                                                                            </postProcessing>
                                                                                            <applicationProperties type="com.fnfr.svt.execution.builtin.exec.MessagePropertyGroup">
                                                                                                <severity inherit="false">Error</severity>
                                                                                                <message inherit="false">          IE &quot;[ie_key]&quot; is present [current_value] time(s)</message>
                                                                                            </applicationProperties>
                                                                                        </item>
                                                                                        <item guid="6f5615e7-a363-458c-b62d-074079188fa0" action="exit" useFieldsInCommand="false">
                                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                        </item>
                                                                                    </nestedSteps>
                                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                                </item>
                                                                            </nestedSteps>
                                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                        </item>
                                                                    </nestedSteps>
                                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                                </item>
                                                            </nestedSteps>
                                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                        </item>
                                                    </nestedSteps>
                                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                                </item>
                                            </nestedSteps>
                                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                        </item>
                                    </nestedSteps>
                                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                                </item>
                            </nestedSteps>
                            <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                        </item>
                    </nestedSteps>
                    <applicationProperties type="com.fnfr.svt.documents.EmptyPropertyGroup"/>
                </item>
            </steps>
            <arguments>
                <item name="session">
                    <defaultValue>s4</defaultValue>
                    <isMandatory>true</isMandatory>
                </item>
                <item name="validate_flow">
                    <defaultValue>true</defaultValue>
                    <isMandatory>true</isMandatory>
                </item>
                <item name="filter">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="request_object_name"/>
                <item name="response_object_name"/>
                <item name="request_ies"/>
                <item name="response_ies"/>
                <item name="tag_name">
                    <isMandatory>true</isMandatory>
                </item>
                <item name="response_status">
                    <isMandatory>true</isMandatory>
                </item>
            </arguments>
            <response>{}</response>
        </item>
    </procedures>
</testCase>
